<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© - Ana Jay</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <!-- Bootstrap 5 RTL -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.rtl.min.css" rel="stylesheet">
  <!-- Bootstrap Icons -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <!-- SheetJS (xlsx) -->
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
  <style>
    :root {
      --purple-dark: #4a148c;
      --purple-medium: #7b1fa2;
      --purple-light: #9c27b0;
      --purple-lighter: #ba68c8;
      --purple-lightest: #e1bee7;
      --purple-accent: #aa00ff;
      --purple-gradient-start: #8e24aa;
      --purple-gradient-end: #5e35b1;
    }
    
    body { 
      background: #f8f5fd; 
      font-size: 14px;
      overflow-y: auto !important;
      height: auto !important;
    }
    
    html {
      overflow-y: auto !important;
      height: auto !important;
    }
    
    /* Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø¬Ù„Ø³Ø© Ø§Ù„Ù…Ø¯Ù…Ø¬ */
    .session-timer {
      display: flex;
      align-items: center;
      gap: 10px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 8px 12px;
      border-radius: 10px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
      min-width: 250px;
      transition: all 0.3s ease;
    }
    
    .session-timer.warning {
      background: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%);
      animation: pulse 1s infinite;
    }
    
    .session-timer.danger {
      background: linear-gradient(135deg, #ff3838 0%, #c44569 100%);
      animation: shake 0.5s infinite;
    }
    
    .timer-display {
      text-align: center;
      flex: 1;
    }
    
    .timer-time {
      font-size: 18px;
      font-weight: bold;
      font-family: 'Courier New', monospace;
      margin: 0;
      line-height: 1;
    }
    
    .timer-status {
      font-size: 10px;
      opacity: 0.9;
      margin: 0;
      line-height: 1;
    }
    
    .timer-progress {
      width: 60px;
      height: 3px;
      background: rgba(255, 255, 255, 0.3);
      border-radius: 2px;
      overflow: hidden;
    }
    
    .timer-progress-bar {
      height: 100%;
      background: linear-gradient(90deg, #00ff88, #00d4aa);
      border-radius: 2px;
      transition: width 1s linear;
    }
    
    .timer-progress-bar.warning {
      background: linear-gradient(90deg, #ffa726, #ff7043);
    }
    
    .timer-progress-bar.danger {
      background: linear-gradient(90deg, #ff5252, #d32f2f);
    }
    
    .timer-actions {
      display: flex;
      gap: 4px;
    }
    
    .timer-actions .btn {
      padding: 4px 6px;
      font-size: 12px;
      border-radius: 6px;
    }
    
    /* ØªØ­Ø³ÙŠÙ†Ø§Øª Ù„Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„ØµØºÙŠØ±Ø© */
    @media (max-width: 768px) {
      .session-timer {
        min-width: 200px;
        padding: 6px 8px;
      }
      
      .timer-time {
        font-size: 14px;
      }
      
      .timer-status {
        font-size: 9px;
      }
      
      .timer-progress {
        width: 40px;
      }
      
      .timer-actions .btn {
        padding: 3px 5px;
        font-size: 11px;
      }
    }
    
    .admin-timer-container.warning {
      background: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%);
      animation: pulse 1s infinite;
    }
    
    .admin-timer-container.danger {
      background: linear-gradient(135deg, #ff3838 0%, #c44569 100%);
      animation: shake 0.5s infinite;
    }
    
    @keyframes pulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.05); }
      100% { transform: scale(1); }
    }
    
    @keyframes shake {
      0%, 100% { transform: translateX(0); }
      25% { transform: translateX(-5px); }
      75% { transform: translateX(5px); }
    }
    
    @keyframes slideIn {
      from { transform: translateX(100%); opacity: 0; }
      to { transform: translateX(0); opacity: 1; }
    }
    
    @keyframes slideOut {
      from { transform: translateX(0); opacity: 1; }
      to { transform: translateX(100%); opacity: 0; }
    }
    
    .admin-timer-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 10px;
    }
    
    .admin-timer-title {
      font-size: 14px;
      font-weight: 600;
      margin: 0;
    }
    
    .admin-timer-close {
      background: none;
      border: none;
      color: white;
      font-size: 18px;
      cursor: pointer;
      padding: 0;
      width: 20px;
      height: 20px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 50%;
      transition: background 0.2s;
    }
    
    .admin-timer-close:hover {
      background: rgba(255, 255, 255, 0.2);
    }
    
    .admin-timer-content {
      text-align: center;
    }
    
    .admin-timer-time {
      font-size: 28px;
      font-weight: bold;
      margin: 5px 0;
      font-family: 'Courier New', monospace;
      text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.3);
    }
    
    .admin-timer-status {
      font-size: 12px;
      opacity: 0.9;
      margin: 0;
    }
    
    .admin-timer-progress {
      width: 100%;
      height: 4px;
      background: rgba(255, 255, 255, 0.3);
      border-radius: 2px;
      margin-top: 10px;
      overflow: hidden;
    }
    
    .admin-timer-progress-bar {
      height: 100%;
      background: linear-gradient(90deg, #00ff88, #00d4aa);
      border-radius: 2px;
      transition: width 1s linear;
    }
    
    .admin-timer-progress-bar.warning {
      background: linear-gradient(90deg, #ffa726, #ff7043);
    }
    
    .admin-timer-progress-bar.danger {
      background: linear-gradient(90deg, #ff5252, #d32f2f);
    }
    
    .admin-timer-actions {
      display: flex;
      gap: 8px;
      margin-top: 10px;
    }
    
    .admin-timer-btn {
      flex: 1;
      padding: 6px 12px;
      border: none;
      border-radius: 6px;
      font-size: 11px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
    }
    
    .admin-timer-btn.extend {
      background: rgba(255, 255, 255, 0.2);
      color: white;
    }
    
    .admin-timer-btn.extend:hover {
      background: rgba(255, 255, 255, 0.3);
    }
    
    .admin-timer-btn.logout {
      background: rgba(255, 255, 255, 0.1);
      color: white;
      border: 1px solid rgba(255, 255, 255, 0.3);
    }
    
    .admin-timer-btn.logout:hover {
      background: rgba(255, 255, 255, 0.2);
    }
    
    /* ØªØ­Ø³ÙŠÙ†Ø§Øª Ù„Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„ØµØºÙŠØ±Ø© */
    @media (max-width: 768px) {
      .admin-timer-container {
        top: 10px;
        left: 10px;
        right: 10px;
        min-width: auto;
        padding: 12px 15px;
      }
      
      .admin-timer-time {
        font-size: 22px;
      }
      
      .admin-timer-actions {
        flex-direction: column;
      }
      
      .admin-timer-title {
        font-size: 12px;
      }
      
      .admin-timer-status {
        font-size: 11px;
      }
    }
    
    /* Ø¶Ø¨Ø· Ø§Ù„Ù†Ù…Ø· Ù„Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„Ù…Ø®ØªÙ„ÙØ© */
    @media (max-width: 768px) {
      body {
        font-size: 12px;
      }
      .sidebar {
        width: 60px;
        overflow: hidden;
        transition: width 0.3s;
      }
      .sidebar .nav-link span {
        display: none;
      }
      .sidebar:hover, .sidebar.expanded {
        width: 200px;
      }
      .sidebar:hover .nav-link span, .sidebar.expanded .nav-link span {
        display: inline;
      }
      .main-content {
        margin-right: 60px;
      }
      .table-responsive {
        font-size: 11px;
      }
      .stat-card {
        margin-bottom: 10px;
      }
    }
    
    .sidebar { 
      min-height: 100vh; 
      background: linear-gradient(to bottom, var(--purple-gradient-start), var(--purple-gradient-end)); 
      color: #fff; 
      position: fixed;
      top: 0;
      right: 0;
      z-index: 1000;
      width: 200px;
      transition: width 0.3s ease;
      box-shadow: 0 0 15px rgba(0, 0, 0, 0.1);
    }
    .sidebar .nav-link, .sidebar .navbar-brand { color: #fff; }
    .sidebar .nav-link:hover { background: rgba(255, 255, 255, 0.1); }
    .sidebar .nav-link.active { background: var(--purple-accent); color: #fff; }
    
    .main-content {
      margin-right: 200px;
      transition: margin 0.3s ease;
      padding: 15px;
      max-width: calc(100% - 200px);
    }
    
    /* ØªØ­Ø³ÙŠÙ†Ø§Øª Ù„Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠØ© ÙˆØ§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ */
    .sidebar .navbar-brand {
      font-size: 1.4rem;
      padding: 0.75rem 1rem;
      text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.2);
    }
    
    .sidebar .nav-link {
      padding: 0.6rem 1rem;
      font-size: 0.9rem;
      transition: all 0.2s ease;
      border-radius: 4px;
      margin: 2px 5px;
    }
    
    .dashboard-header {
      padding: 0.75rem 1rem !important;
      margin-bottom: 15px !important;
      background: linear-gradient(to right, #fff, #f8f5fd);
      border-left: 3px solid var(--purple-medium);
    }
    
    /* Ø¨Ø§Ù‚ÙŠ Ø§Ù„Ø£Ù†Ù…Ø§Ø· */
    .stat-card { 
      border-radius: 12px; 
      margin-bottom: 15px;
      border-top: 3px solid var(--purple-lighter);
      transition: transform 0.2s ease, box-shadow 0.2s ease;
    }
    .stat-card:hover {
      transform: translateY(-3px);
      box-shadow: 0 5px 15px rgba(156, 39, 176, 0.1) !important;
    }
    .stat-icon { font-size: 1.5rem; }
    .table thead { background: var(--purple-lightest); }
    .user-avatar { 
      width: 36px; 
      height: 36px; 
      border-radius: 50%; 
      object-fit: cover; 
      border: 2px solid var(--purple-lightest);
    }
    footer { background: none; }
    
    /* ØªØ­Ø³ÙŠÙ†Ø§Øª Ù„Ù„Ø¹Ø±Ø¶ Ø¹Ù„Ù‰ Ø§Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„ØµØºÙŠØ±Ø© */
    @media (max-width: 576px) {
      .sidebar {
        width: 0;
        overflow: hidden;
      }
      .sidebar.show {
        width: 200px;
      }
      .main-content {
        margin-right: 0;
        padding: 10px;
        max-width: 100%;
      }
      .dashboard-header {
        padding: 10px;
        margin-bottom: 15px;
      }
      .mobile-toggle-sidebar {
        display: block;
        position: fixed;
        top: 10px;
        right: 10px;
        z-index: 1001;
        background: var(--purple-dark);
        color: white;
        border: none;
        padding: 5px 10px;
        border-radius: 5px;
      }
      .btn {
        padding: 0.25rem 0.5rem;
        font-size: 0.875rem;
      }
      .card-body {
        padding: 0.75rem;
      }
      .list-group-item {
        padding: 0.5rem 0.75rem;
      }
    }
    
    /* ØªØ¹Ø±ÙŠÙ Ø£Ø²Ø±Ø§Ø± ØµØºÙŠØ±Ø© Ø¬Ø¯Ù‹Ø§ */
    .btn-xs {
      padding: 0.1rem 0.25rem;
      font-size: 0.75rem;
      line-height: 1.2;
      border-radius: 0.2rem;
    }
    
    /* ØªØ®ØµÙŠØµ Ø§Ù„Ø£Ù„ÙˆØ§Ù† Ù„Ù„Ø¹Ù†Ø§ØµØ± */
    .text-primary {
      color: var(--purple-medium) !important;
    }
    
    .text-success {
      color: var(--purple-light) !important;
    }
    
    .text-warning {
      color: var(--purple-accent) !important;
    }
    
    .text-danger {
      color: var(--purple-dark) !important;
    }
    
    .btn-primary {
      background-color: var(--purple-medium);
      border-color: var(--purple-medium);
    }
    
    .btn-primary:hover {
      background-color: var(--purple-dark);
      border-color: var(--purple-dark);
    }
    
    .btn-outline-primary {
      color: var(--purple-medium);
      border-color: var(--purple-medium);
    }
    
    .btn-outline-primary:hover {
      background-color: var(--purple-medium);
      border-color: var(--purple-medium);
    }
    
    .btn-danger {
      background-color: var(--purple-dark);
      border-color: var(--purple-dark);
    }
    
    .btn-danger:hover {
      background-color: #3a1078;
      border-color: #3a1078;
    }
    
    .btn-secondary {
      background-color: #9e9e9e;
      border-color: #9e9e9e;
    }
    
    .alert-info {
      background-color: var(--purple-lightest);
      border-color: var(--purple-lighter);
      color: var(--purple-dark);
    }
    
    .badge.bg-primary {
      background-color: var(--purple-medium) !important;
    }
    
    /* ØªØ­Ø³ÙŠÙ†Ø§Øª ÙÙ†ÙŠØ© Ø¥Ø¶Ø§ÙÙŠØ© */
    .list-group-item {
      border-left: 3px solid transparent;
      transition: all 0.2s ease;
    }
    
    .list-group-item:hover {
      border-left-color: var(--purple-lighter);
      background-color: rgba(225, 190, 231, 0.1);
    }
    
    input.form-control:focus, select.form-select:focus, textarea.form-control:focus {
      border-color: var(--purple-lighter);
      box-shadow: 0 0 0 0.25rem rgba(156, 39, 176, 0.25);
    }
    
    /* ØªØ­Ø³ÙŠÙ†Ø§Øª Ù„Ù„Ø±Ø³Ù… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠ */
    .chart-container {
      position: relative;
      margin: auto;
      height: 300px;
    }
    
    .chart-options {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 15px;
    }
    
    .chart-type-selector {
      display: flex;
      gap: 10px;
    }
    
    .chart-type-btn {
      padding: 5px 10px;
      border-radius: 20px;
      font-size: 0.8rem;
      background-color: #f0f0f0;
      border: 1px solid #ddd;
      color: #666;
      cursor: pointer;
      transition: all 0.2s ease;
    }
    
    .chart-type-btn.active {
      background-color: var(--purple-medium);
      color: white;
      border-color: var(--purple-medium);
    }
    
    .chart-period-selector {
      display: flex;
      gap: 10px;
    }
    
    .chart-legend {
      display: flex;
      justify-content: center;
      gap: 15px;
      margin-top: 10px;
      flex-wrap: wrap;
    }
    
    .chart-legend-item {
      display: flex;
      align-items: center;
      font-size: 0.8rem;
      color: #666;
    }
    
    .chart-legend-color {
      width: 12px;
      height: 12px;
      border-radius: 50%;
      margin-left: 5px;
    }
    
    /* ØªØ­Ø³ÙŠÙ†Ø§Øª Ù„Ù„ØµÙØ­Ø§Øª Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠØ© */
    .page-content {
      display: none;
    }
    
    .page-content.active {
      display: block;
    }
    
    /* Ø¥Ø²Ø§Ù„Ø© Ø£ÙŠ Ø·Ø¨Ù‚Ø© overlay ØºÙŠØ± Ù…Ø±ØºÙˆØ¨ ÙÙŠÙ‡Ø§ */
    .modal-backdrop {
      background: rgba(0,0,0,0.4) !important;
      opacity: 1 !important;
      z-index: 1040;
    }
    
    /* Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† modal ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù„Ø§ ÙŠÙ…Ù†Ø¹ Ø§Ù„ØªÙØ§Ø¹Ù„ */
    #adminLoginModal {
      z-index: 1050 !important;
    }
    
    /* Ø¥Ø²Ø§Ù„Ø© Ø£ÙŠ Ø¹Ù†Ø§ØµØ± Ù‚Ø¯ ØªÙ…Ù†Ø¹ Ø§Ù„ØªÙØ§Ø¹Ù„ */
    body::after,
    body::before {
      display: none !important;
    }
    
    /* Ø¥ØµÙ„Ø§Ø­ Ù…Ø´ÙƒÙ„Ø© Ø§Ù„ØªÙ…Ø±ÙŠØ± */
    .main-content {
      overflow-y: auto !important;
      height: auto !important;
      min-height: 100vh;
    }
    
    .container-fluid {
      overflow-y: auto !important;
      height: auto !important;
    }
    
    /* Ù…Ù†Ø¹ Ø¥ØºÙ„Ø§Ù‚ modal ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ø§Ù„Ø¶ØºØ· Ø®Ø§Ø±Ø¬ Ø§Ù„Ù†Ø§ÙØ°Ø© */
    #adminLoginModal .modal-dialog {
      pointer-events: auto;
    }
    
    /* Ø¥Ø®ÙØ§Ø¡ Ø²Ø± X ÙÙŠ modal ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ */
    #adminLoginModal .btn-close {
      display: none !important;
    }
    
    .page-title {
      margin-bottom: 20px;
      color: var(--purple-dark);
      border-bottom: 2px solid var(--purple-lightest);
      padding-bottom: 10px;
    }
    
    .card-hover {
      transition: all 0.3s ease;
    }
    
    .card-hover:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
    }
    
    /* ØªØ£Ø«ÙŠØ±Ø§Øª Ù„Ù„Ø£Ø²Ø±Ø§Ø± */
    .btn-outline-danger {
      transition: all 0.3s ease;
    }
    
    .btn-outline-danger:hover {
      background-color: var(--purple-dark);
      border-color: var(--purple-dark);
    }
    
    /* ØªØ­Ø³ÙŠÙ† Ù…Ø¸Ù‡Ø± Ø§Ù„Ø¬Ø¯Ø§ÙˆÙ„ */
    .table {
      border-collapse: separate;
      border-spacing: 0;
    }
    
    .table thead th {
      border-bottom: 2px solid var(--purple-lighter);
      font-weight: 600;
    }
    
    .table tbody tr {
      transition: all 0.2s ease;
    }
    
    .table tbody tr:hover {
      background-color: rgba(225, 190, 231, 0.1);
    }
    
    /* ØªØ­Ø³ÙŠÙ† Ù…Ø¸Ù‡Ø± Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª */
    .card {
      border: none;
      border-radius: 10px;
      overflow: hidden;
      transition: all 0.3s ease;
    }
    
    .card:hover {
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
    }
    
    /* ØªØ­Ø³ÙŠÙ† Ø´Ø±ÙŠØ· Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø¹Ù„ÙˆÙŠ */
    .fixed-stats-bar {
      font-size: 13px;
      padding: 10px 8px !important;
      margin-bottom: 10px !important;
    }
    .fixed-stats-bar .row > div {
      padding-left: 4px;
      padding-right: 4px;
    }
    .fixed-stats-bar .fw-bold.fs-5 {
      font-size: 1.1rem !important;
      margin-top: 2px;
      margin-bottom: 0;
    }
    @media (max-width: 768px) {
      .fixed-stats-bar {
        font-size: 11px;
        padding: 7px 2px !important;
      }
      .fixed-stats-bar .fw-bold.fs-5 {
        font-size: 0.95rem !important;
      }
    }
    .order-rated-checkbox {
      width: 1.5em;
      height: 1.5em;
      accent-color: #7b1fa2; /* Ø¨Ù†ÙØ³Ø¬ÙŠ Ø§Ø­ØªØ±Ø§ÙÙŠ */
      border-radius: 50%;
      background: #f3e5f5;
      box-shadow: 0 0 0 2px #7b1fa233;
      transition: box-shadow 0.2s, background 0.2s;
      vertical-align: middle;
      margin-right: 4px;
    }
    .order-rated-checkbox:checked {
      background: #7b1fa2;
      box-shadow: 0 0 0 3px #7b1fa288;
      border-color: #7b1fa2;
    }
    /* Ø£Ø¶Ù Ù‡Ø°Ø§ ÙÙŠ CSS */
    .order-rated-circle {
      display: inline-block;
      width: 24px;
      height: 24px;
      border-radius: 50%;
      border: 2px solid #7b1fa2;
      background: #f3e5f5;
      cursor: pointer;
      transition: background 0.2s;
      vertical-align: middle;
      margin-right: 4px;
    }
    .order-rated-circle.active {
      background: #7b1fa2;
    }
    /* Ø³ØªØ§ÙŠÙ„ ØªØ±Ù‚ÙŠÙ… Ø§Ù„ÙÙ†ÙŠÙŠÙ† */
    .order-badge {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 30px;
      height: 30px;
      border-radius: 50%;
      background-color: var(--purple-medium);
      color: white;
      font-weight: bold;
      font-size: 14px;
    }
  </style>
  <script>
  // ========== Ù…ØªØºÙŠØ±Ø§Øª Ø¹Ø¯Ø§Ø¯ Ø§Ù„ØªÙ†Ø§Ø²Ù„ÙŠ ==========
  let sessionTimer;
  let sessionDuration = 5 * 60 * 60; // 5 Ø³Ø§Ø¹Ø§Øª Ø¨Ø§Ù„Ø«ÙˆØ§Ù†ÙŠ (5 * 60 * 60 = 18000 Ø«Ø§Ù†ÙŠØ©)
  let remainingTime = sessionDuration;
  let isSessionActive = false;
  
  // ========== Ù…ØµÙÙˆÙØ© Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠÙ† =============
  const admins = [
    { code: "1", name: "Ø¥Ø³Ù„Ø§Ù…", password: "010115", role: "admin" },
    { code: "271280", name: "Ø®Ø§Ù„Ø¯", password: "271280", role: "admin" },
    { code: "sh", name: "Ø´Ø±ÙŠÙ", password: "123456", role: "admin" },
    { code: "gazazyousef", name: "ÙŠÙˆØ³Ù", password: "1231973123", role: "admin" },
    { code: "2712", name: "Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", password: "01007001578sss", role: "admin" },
    { code: "abdo", name: "Ø¹Ø¨Ø¯Ø§Ù„Ø±Ø­Ù…Ù†", password: "123456", role: "admin" }
  ];

  // Ø¯Ø§Ù„Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù„Ù„Ù…Ø³Ø¤ÙˆÙ„
  function adminLogin(event) {
    event.preventDefault();
    const code = document.getElementById('adminCodeInput').value.trim();
    const password = document.getElementById('adminPasswordInput').value.trim();
    
    // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„
    const admin = admins.find(a => a.code === code && a.password === password);
    
    if (admin) {
      // Ø¥Ø²Ø§Ù„Ø© Ø£ÙŠ overlays Ø£Ùˆ toasts Ø³Ø§Ø¨Ù‚Ø©
      removeOverlays();
      
      // Ø¥Ù†Ø´Ø§Ø¡ Ø¬Ù„Ø³Ø© Ø¢Ù…Ù†Ø©
      const sessionData = {
        id: admin.code,
        name: admin.name,
        role: admin.role,
        loginTime: new Date().toISOString(),
        lastActivity: new Date().toISOString()
      };
      
      sessionStorage.setItem('currentAdmin', JSON.stringify(sessionData));
      sessionStorage.setItem('sessionStartTime', new Date().toISOString());
      
      // Ø­ÙØ¸ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙÙŠ localStorage Ù„ØªØªØ¨Ø¹ Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª
      localStorage.setItem('currentUser', admin.name);
      
      // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ù†Ø§ÙØ°Ø©
      const modal = bootstrap.Modal.getInstance(document.getElementById('adminLoginModal'));
      modal.hide();
      document.getElementById('logoutBtn').style.display = 'block';
      
      // ØªØ­Ø¯ÙŠØ« ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
      updateUIForAdmin(admin);
      
      // Ø¨Ø¯Ø¡ Ø¹Ø¯Ø§Ø¯ Ø§Ù„ØªÙ†Ø§Ø²Ù„ÙŠ
      startSessionTimer();
    } else {
      document.getElementById('adminLoginError').classList.remove('d-none');
    }
  }

  // ØªØ­Ø¯ÙŠØ« ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø­Ø³Ø¨ ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„
  function updateUIForAdmin(admin) {
    // ØªØ­Ø¯ÙŠØ« Ø§Ø³Ù… Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ ÙÙŠ Ø§Ù„Ø³Ø§ÙŠØ¯Ø¨Ø§Ø±
    const adminNameElement = document.getElementById('adminNameDisplay');
    if (adminNameElement) {
      adminNameElement.textContent = admin.name;
    }
    
    // Ø­ÙØ¸ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙÙŠ localStorage Ù„ØªØªØ¨Ø¹ Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª
    localStorage.setItem('currentUser', admin.name);
    
    // ØªØ­Ø¯ÙŠØ« Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª Ø­Ø³Ø¨ Ø§Ù„Ø¯ÙˆØ±
    if (admin.role === 'admin') {
      // Ø¥Ø¸Ù‡Ø§Ø± Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø²Ø±Ø§Ø± ÙˆØ§Ù„ÙˆØ¸Ø§Ø¦Ù
      document.querySelectorAll('.admin-only').forEach(el => el.style.display = '');
    } else {
      // Ø¥Ø®ÙØ§Ø¡ Ø¨Ø¹Ø¶ Ø§Ù„ÙˆØ¸Ø§Ø¦Ù Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„Ø¹Ø§Ø¯ÙŠÙŠÙ†
      document.querySelectorAll('.admin-only').forEach(el => el.style.display = 'none');
    }
    
    // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ø¹Ø¯Ø§Ø¯
    showAdminTimer();
  }

  // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµÙ„Ø§Ø­ÙŠØ© Ø§Ù„Ø¬Ù„Ø³Ø©
  function checkSession() {
    const sessionStartTime = sessionStorage.getItem('sessionStartTime');
    const currentAdmin = sessionStorage.getItem('currentAdmin');
    
    if (!sessionStartTime || !currentAdmin) {
      return false;
    }
    
    // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ù…Ø¯Ø© Ø§Ù„Ø¬Ù„Ø³Ø© (8 Ø³Ø§Ø¹Ø§Øª)
    const sessionDuration = new Date() - new Date(sessionStartTime);
    const maxSessionDuration = 8 * 60 * 60 * 1000; // 8 Ø³Ø§Ø¹Ø§Øª Ø¨Ø§Ù„Ù…ÙŠÙ„ÙŠ Ø«Ø§Ù†ÙŠØ©
    
    if (sessionDuration > maxSessionDuration) {
      adminLogout();
      return false;
    }
    
    // ØªØ­Ø¯ÙŠØ« ÙˆÙ‚Øª Ø¢Ø®Ø± Ù†Ø´Ø§Ø·
    const adminData = JSON.parse(currentAdmin);
    adminData.lastActivity = new Date().toISOString();
    sessionStorage.setItem('currentAdmin', JSON.stringify(adminData));
    
    return true;
  }

  // ========== Ø¯ÙˆØ§Ù„ Ø¹Ø¯Ø§Ø¯ Ø§Ù„ØªÙ†Ø§Ø²Ù„ÙŠ ==========
  
  // Ø¨Ø¯Ø¡ Ø¹Ø¯Ø§Ø¯ Ø§Ù„ØªÙ†Ø§Ø²Ù„ÙŠ
  function startSessionTimer() {
    isSessionActive = true;
    remainingTime = sessionDuration;
    
    // Ø¥Ø¸Ù‡Ø§Ø± Ø¹Ø¯Ø§Ø¯ Ø§Ù„ØªÙ†Ø§Ø²Ù„ÙŠ
    showAdminTimer();
    
    // Ø¨Ø¯Ø¡ Ø§Ù„Ø¹Ø¯ Ø§Ù„ØªÙ†Ø§Ø²Ù„ÙŠ
    sessionTimer = setInterval(() => {
      remainingTime--;
      
      // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ø±Ø¶
      updateTimerDisplay();
      
      // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„ÙˆÙ‚Øª
      if (remainingTime <= 0) {
        clearInterval(sessionTimer);
        isSessionActive = false;
        
        // Ø¥Ø¸Ù‡Ø§Ø± ØªÙ†Ø¨ÙŠÙ‡ Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„Ø¬Ù„Ø³Ø©
        showSessionExpiredAlert();
        
        // ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹
        setTimeout(() => {
          adminLogout();
        }, 2000);
      }
    }, 1000);
  }
  
  // Ø¥ÙŠÙ‚Ø§Ù Ø¹Ø¯Ø§Ø¯ Ø§Ù„ØªÙ†Ø§Ø²Ù„ÙŠ
  function stopSessionTimer() {
    if (sessionTimer) {
      clearInterval(sessionTimer);
      sessionTimer = null;
    }
    isSessionActive = false;
    hideAdminTimer();
  }
  
  // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø¹Ø¯Ø§Ø¯ Ø§Ù„ØªÙ†Ø§Ø²Ù„ÙŠ
  function resetSessionTimer() {
    stopSessionTimer();
    remainingTime = sessionDuration;
    startSessionTimer();
  }
  
  // ØªÙ…Ø¯ÙŠØ¯ Ø§Ù„Ø¬Ù„Ø³Ø©
  function extendSession() {
    remainingTime = sessionDuration; // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„ÙˆÙ‚Øª Ù„Ù€ 5 Ø³Ø§Ø¹Ø§Øª ÙƒØ§Ù…Ù„Ø©
    updateTimerDisplay();
    
    // Ø¥Ø¸Ù‡Ø§Ø± Ø±Ø³Ø§Ù„Ø© ØªØ£ÙƒÙŠØ¯
    showToast('ØªÙ… ØªÙ…Ø¯ÙŠØ¯ Ø§Ù„Ø¬Ù„Ø³Ø© Ø¨Ù†Ø¬Ø§Ø­', 'success');
    
    // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø¹Ø¯Ø§Ø¯ Ø§Ù„ØªÙ†Ø§Ø²Ù„ÙŠ
    if (sessionTimer) {
      clearInterval(sessionTimer);
    }
    
    sessionTimer = setInterval(() => {
      remainingTime--;
      
      // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ø±Ø¶
      updateTimerDisplay();
      
      // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„ÙˆÙ‚Øª
      if (remainingTime <= 0) {
        clearInterval(sessionTimer);
        isSessionActive = false;
        
        // Ø¥Ø¸Ù‡Ø§Ø± ØªÙ†Ø¨ÙŠÙ‡ Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„Ø¬Ù„Ø³Ø©
        showSessionExpiredAlert();
        
        // ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹
        setTimeout(() => {
          adminLogout();
        }, 2000);
      }
    }, 1000);
  }
  
  // ØªØ­Ø¯ÙŠØ« Ø¹Ø±Ø¶ Ø§Ù„Ø¹Ø¯Ø§Ø¯
  function updateTimerDisplay() {
    const hours = Math.floor(remainingTime / 3600);
    const minutes = Math.floor((remainingTime % 3600) / 60);
    const seconds = remainingTime % 60;
    const timeString = `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
    
    document.getElementById('sessionTimerTime').textContent = timeString;
    
    // Ø­Ø³Ø§Ø¨ Ø§Ù„Ù†Ø³Ø¨Ø© Ø§Ù„Ù…Ø¦ÙˆÙŠØ© Ù„Ù„ÙˆÙ‚Øª Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ
    const percentage = (remainingTime / sessionDuration) * 100;
    document.getElementById('sessionTimerProgressBar').style.width = percentage + '%';
    
    // ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ø¹Ø¯Ø§Ø¯ Ø­Ø³Ø¨ Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ
    const timerContainer = document.getElementById('sessionTimer');
    const progressBar = document.getElementById('sessionTimerProgressBar');
    const statusText = document.getElementById('sessionTimerStatus');
    
    // ØªØ­ÙˆÙŠÙ„ 5 Ø³Ø§Ø¹Ø§Øª Ø¥Ù„Ù‰ Ø«ÙˆØ§Ù†ÙŠ Ù„Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø­Ø§Ù„Ø§Øª
    const fiveHoursInSeconds = 5 * 60 * 60;
    const thirtyMinutesInSeconds = 30 * 60;
    const tenMinutesInSeconds = 10 * 60;
    
    if (remainingTime > thirtyMinutesInSeconds) {
      // ÙˆÙ‚Øª ÙƒØ§ÙÙŠ - Ø£Ø®Ø¶Ø±
      timerContainer.className = 'session-timer';
      progressBar.className = 'timer-progress-bar';
      statusText.textContent = 'Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ';
    } else if (remainingTime > tenMinutesInSeconds) {
      // ØªØ­Ø°ÙŠØ± - Ø¨Ø±ØªÙ‚Ø§Ù„ÙŠ
      timerContainer.className = 'session-timer warning';
      progressBar.className = 'timer-progress-bar warning';
      statusText.textContent = 'ØªØ­Ø°ÙŠØ±!';
      
      // Ø¥Ø¶Ø§ÙØ© ØµÙˆØª ØªÙ†Ø¨ÙŠÙ‡ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)
      if (remainingTime === thirtyMinutesInSeconds) {
        showToast('ØªØ­Ø°ÙŠØ±: Ø§Ù„ÙˆÙ‚Øª ÙŠÙ†ÙØ¯!', 'warning');
      }
    } else {
      // Ø®Ø·Ø± - Ø£Ø­Ù…Ø±
      timerContainer.className = 'session-timer danger';
      progressBar.className = 'timer-progress-bar danger';
      statusText.textContent = 'Ø®Ø·Ø±!';
      
      // Ø¥Ø¶Ø§ÙØ© ØµÙˆØª ØªÙ†Ø¨ÙŠÙ‡ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)
      if (remainingTime === tenMinutesInSeconds) {
        showToast('Ø®Ø·Ø±: Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„Ø¬Ù„Ø³Ø© Ù‚Ø±ÙŠØ¨!', 'error');
      }
    }
  }
  
  // Ø¥Ø¸Ù‡Ø§Ø± Ø¹Ø¯Ø§Ø¯ Ø§Ù„ØªÙ†Ø§Ø²Ù„ÙŠ
  function showAdminTimer() {
    const timerContainer = document.getElementById('sessionTimer');
    timerContainer.style.display = 'flex';
    updateTimerDisplay();
  }
  
  // Ø¥Ø®ÙØ§Ø¡ Ø¹Ø¯Ø§Ø¯ Ø§Ù„ØªÙ†Ø§Ø²Ù„ÙŠ
  function hideAdminTimer() {
    const timerContainer = document.getElementById('sessionTimer');
    timerContainer.style.display = 'none';
  }
  
  // Ø¥Ø¸Ù‡Ø§Ø± ØªÙ†Ø¨ÙŠÙ‡ Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„Ø¬Ù„Ø³Ø©
  function showSessionExpiredAlert() {
    // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø¹Ø¯Ø§Ø¯
    hideAdminTimer();
    // Ø¥Ø¸Ù‡Ø§Ø± Ø±Ø³Ø§Ù„Ø© toast ÙÙ‚Ø· (Ù…Ø±Ø© ÙˆØ§Ø­Ø¯Ø© ÙÙ‚Ø·)
    if (!window.sessionExpiredShown) {
      window.sessionExpiredShown = true;
      showToast('Ø§Ù†ØªÙ‡Øª Ø§Ù„Ø¬Ù„Ø³Ø©! Ø³ÙŠØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹.', 'error');
    }
  }
  
  // Ø¥Ø¸Ù‡Ø§Ø± Ø±Ø³Ø§Ù„Ø© toast
  function showToast(message, type = 'info') {
    // Ø¥Ø²Ø§Ù„Ø© Ø£ÙŠ toast Ø³Ø§Ø¨Ù‚ Ø¨Ù†ÙØ³ Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ù„ØªØ¬Ù†Ø¨ Ø§Ù„ØªÙƒØ±Ø§Ø±
    const existingToasts = document.querySelectorAll('[style*="z-index: 10001"]');
    existingToasts.forEach(toast => {
      if (toast.textContent.includes(message)) {
        toast.remove();
      }
    });
    
    const toast = document.createElement('div');
    const bgColor = type === 'success' ? '#4caf50' : 
                   type === 'error' ? '#f44336' : 
                   type === 'warning' ? '#ff9800' : '#2196f3';
    
    toast.style.cssText = `
      position: fixed;
      top: 20px;
      right: 20px;
      background: ${bgColor};
      color: white;
      padding: 15px 20px;
      border-radius: 8px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
      z-index: 10001;
      font-weight: 500;
      max-width: 300px;
      word-wrap: break-word;
      animation: slideIn 0.3s ease;
    `;
    
    // Ø¥Ø¶Ø§ÙØ© Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø­Ø³Ø¨ Ø§Ù„Ù†ÙˆØ¹
    const icon = type === 'success' ? 'âœ“' : 
                type === 'error' ? 'âœ—' : 
                type === 'warning' ? 'âš ' : 'â„¹';
    
    toast.innerHTML = `<span style="margin-left: 8px;">${icon}</span> ${message}`;
    document.body.appendChild(toast);
    
    // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø¨Ø¹Ø¯ 3 Ø«ÙˆØ§Ù†ÙŠ
    setTimeout(() => {
      if (toast.parentElement) {
        toast.style.animation = 'slideOut 0.3s ease';
        setTimeout(() => {
          if (toast.parentElement) {
            toast.remove();
          }
        }, 300);
      }
    }, 3000);
  }
  
  // ØªØ­Ø¯ÙŠØ« Ø¯Ø§Ù„Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬
  function adminLogout() {
    // Ø¥ÙŠÙ‚Ø§Ù Ø¹Ø¯Ø§Ø¯ Ø§Ù„ØªÙ†Ø§Ø²Ù„ÙŠ
    stopSessionTimer();
    
    // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø¹Ø¯Ø§Ø¯
    hideAdminTimer();
    
    // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ù…ØªØºÙŠØ± Ù…Ù†Ø¹ ØªÙƒØ±Ø§Ø± Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±
    window.sessionExpiredShown = false;
    
    sessionStorage.removeItem('currentAdmin');
    sessionStorage.removeItem('sessionStartTime');
    localStorage.removeItem('currentUser');
    checkAdminLogin();
  }

  // ØªØ­Ø¯ÙŠØ« Ø¯Ø§Ù„Ø© Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
  function checkAdminLogin() {
    if (!checkSession()) {
      showAdminLoginModal();
      document.getElementById('logoutBtn').style.display = 'none';
      // Ø¥ÙŠÙ‚Ø§Ù Ø¹Ø¯Ø§Ø¯ Ø§Ù„ØªÙ†Ø§Ø²Ù„ÙŠ Ø¥Ø°Ø§ ÙƒØ§Ù† Ù†Ø´Ø·Ø§Ù‹
      stopSessionTimer();
      // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø¹Ø¯Ø§Ø¯
      hideAdminTimer();
    } else {
      const adminData = JSON.parse(sessionStorage.getItem('currentAdmin'));
      document.getElementById('logoutBtn').style.display = 'block';
      updateUIForAdmin(adminData);
      
      // Ø¨Ø¯Ø¡ Ø¹Ø¯Ø§Ø¯ Ø§Ù„ØªÙ†Ø§Ø²Ù„ÙŠ Ø¥Ø°Ø§ Ù„Ù… ÙŠÙƒÙ† Ù†Ø´Ø·Ø§Ù‹
      if (!isSessionActive) {
        startSessionTimer();
      }
    }
  }

  // Ø¥Ø¸Ù‡Ø§Ø± modal ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠÙ†
  function showAdminLoginModal() {
    // Ø¥Ø²Ø§Ù„Ø© Ø£ÙŠ overlays Ø£Ùˆ toasts Ø³Ø§Ø¨Ù‚Ø©
    removeOverlays();
    
    const modal = new bootstrap.Modal(document.getElementById('adminLoginModal'));
    modal.show();
    
    // Ù…Ø³Ø­ Ø§Ù„Ø­Ù‚ÙˆÙ„
    document.getElementById('adminCodeInput').value = '';
    document.getElementById('adminPasswordInput').value = '';
    document.getElementById('adminLoginError').classList.add('d-none');
    
    // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø¹Ø¯Ø§Ø¯
    hideAdminTimer();
  }

  // Ø¥Ø¶Ø§ÙØ© Ù…Ø±Ø§Ù‚Ø¨ Ù„Ù„Ù†Ø´Ø§Ø·
  document.addEventListener('click', function() {
    if (sessionStorage.getItem('currentAdmin')) {
      const adminData = JSON.parse(sessionStorage.getItem('currentAdmin'));
      adminData.lastActivity = new Date().toISOString();
      sessionStorage.setItem('currentAdmin', JSON.stringify(adminData));
      
      // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø¹Ø¯Ø§Ø¯ Ø§Ù„ØªÙ†Ø§Ø²Ù„ÙŠ Ø¹Ù†Ø¯ Ø§Ù„Ù†Ø´Ø§Ø· (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)
      // ÙŠÙ…ÙƒÙ† Ø¥Ù„ØºØ§Ø¡ Ø§Ù„ØªØ¹Ù„ÙŠÙ‚ Ù…Ù† Ø§Ù„Ø³Ø·Ø± Ø§Ù„ØªØ§Ù„ÙŠ Ø¥Ø°Ø§ Ø£Ø±Ø¯Øª Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø¹Ø¯Ø§Ø¯ Ø¹Ù†Ø¯ ÙƒÙ„ Ù†Ø´Ø§Ø·
      // if (isSessionActive) resetSessionTimer();
    }
  });

  // Ø¥Ø¶Ø§ÙØ© Ù…Ø±Ø§Ù‚Ø¨ Ù„Ø­Ø±ÙƒØ© Ø§Ù„Ù…Ø§ÙˆØ³
  document.addEventListener('mousemove', function() {
    if (sessionStorage.getItem('currentAdmin') && isSessionActive) {
      const adminData = JSON.parse(sessionStorage.getItem('currentAdmin'));
      adminData.lastActivity = new Date().toISOString();
      sessionStorage.setItem('currentAdmin', JSON.stringify(adminData));
    }
  });

  // Ø¥Ø¶Ø§ÙØ© Ù…Ø±Ø§Ù‚Ø¨ Ù„Ù„ÙƒÙŠØ¨ÙˆØ±Ø¯
  document.addEventListener('keydown', function() {
    if (sessionStorage.getItem('currentAdmin') && isSessionActive) {
      const adminData = JSON.parse(sessionStorage.getItem('currentAdmin'));
      adminData.lastActivity = new Date().toISOString();
      sessionStorage.setItem('currentAdmin', JSON.stringify(adminData));
    }
  });

  // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¬Ù„Ø³Ø© ÙƒÙ„ Ø¯Ù‚ÙŠÙ‚Ø©
  setInterval(checkSession, 60000);
  
  // Ø¯Ø§Ù„Ø© Ù„Ø¥Ø²Ø§Ù„Ø© Ø£ÙŠ Ø·Ø¨Ù‚Ø§Øª overlay ØºÙŠØ± Ù…Ø±ØºÙˆØ¨ ÙÙŠÙ‡Ø§
  function removeOverlays() {
    // Ø¥Ø²Ø§Ù„Ø© modal-backdrop
    // const backdrops = document.querySelectorAll('.modal-backdrop');
    // backdrops.forEach(backdrop => backdrop.remove());
    
    // Ø¥Ø²Ø§Ù„Ø© Ø£ÙŠ Ø¹Ù†Ø§ØµØ± Ø¨ z-index Ø¹Ø§Ù„ÙŠ Ù‚Ø¯ ØªÙ…Ù†Ø¹ Ø§Ù„ØªÙØ§Ø¹Ù„
    const overlays = document.querySelectorAll('[style*="z-index: 10000"], [style*="z-index: 10001"]');
    overlays.forEach(overlay => {
      if (!overlay.classList.contains('session-timer') && !overlay.id.includes('toast')) {
        overlay.remove();
      }
    });
    
    // Ø¥Ø²Ø§Ù„Ø© Ø£ÙŠ Ø¹Ù†Ø§ØµØ± Ø¨ position: fixed Ù‚Ø¯ ØªÙ…Ù†Ø¹ Ø§Ù„ØªÙØ§Ø¹Ù„
    const fixedElements = document.querySelectorAll('[style*="position: fixed"]');
    fixedElements.forEach(element => {
      if (!element.classList.contains('session-timer') && 
          !element.id.includes('toast') && 
          !element.id.includes('modal') &&
          !element.classList.contains('sidebar') &&
          !element.classList.contains('mobile-toggle-sidebar')) {
        element.remove();
      }
    });
    
    // Ø¥ØµÙ„Ø§Ø­ Ù…Ø´ÙƒÙ„Ø© Ø§Ù„ØªÙ…Ø±ÙŠØ±
    document.body.style.overflow = 'auto';
    document.body.style.height = 'auto';
    document.documentElement.style.overflow = 'auto';
    document.documentElement.style.height = 'auto';
    
    // Ø¥Ø²Ø§Ù„Ø© Ø£ÙŠ CSS Ù‚Ø¯ ÙŠÙ…Ù†Ø¹ Ø§Ù„ØªÙ…Ø±ÙŠØ±
    const mainContent = document.querySelector('.main-content');
    if (mainContent) {
      mainContent.style.overflow = 'auto';
      mainContent.style.height = 'auto';
    }
  }
  
  // ØªØ´ØºÙŠÙ„ Ø¯Ø§Ù„Ø© Ø¥Ø²Ø§Ù„Ø© overlays ÙƒÙ„ Ø«Ø§Ù†ÙŠØ©
  setInterval(removeOverlays, 1000);

  // Ø¥Ø²Ø§Ù„Ø© Ø£ÙŠ Ø¨Ù‚Ø§ÙŠØ§ modal-backdrop Ø¹Ù†Ø¯ Ø¥ØºÙ„Ø§Ù‚ Ø£ÙŠ Ù†Ø§ÙØ°Ø© Ù…Ù†Ø¨Ø«Ù‚Ø©
  // ÙŠØ¹Ù…Ù„ Ù…Ø¹ Ø¬Ù…ÙŠØ¹ modals

  document.addEventListener('hidden.bs.modal', function () {
    document.querySelectorAll('.modal-backdrop').forEach(el => el.remove());
  });

  // Ø¯Ø§Ù„Ø© Ø¹Ø±Ø¶ Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„
  function showCustomerTransactions(customerId) {
    const customers = JSON.parse(localStorage.getItem('customers') || '[]');
    const orders = JSON.parse(localStorage.getItem('orders') || '[]');
    const customer = customers.find(c => c.id === customerId);
    if (!customer) return;
    // Ø¬Ù„Ø¨ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø®Ø§ØµØ© Ø¨Ù‡Ø°Ø§ Ø§Ù„Ø¹Ù…ÙŠÙ„
    const customerOrders = orders.filter(order => order.phone === customer.phone);
    let html = `<h5 class='mb-3'>Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„: ${customer.name}</h5>`;
    if (customerOrders.length === 0) {
      html += `<div class='alert alert-info'>Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ù„Ù‡Ø°Ø§ Ø§Ù„Ø¹Ù…ÙŠÙ„.</div>`;
    } else {
      html += `<div class='table-responsive'><table class='table table-sm'><thead><tr><th>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø·Ù„Ø¨</th><th>Ø§Ø³Ù… Ø§Ù„ÙÙ†ÙŠ/Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨</th><th>Ù†ÙˆØ¹ Ø§Ù„Ø®Ø¯Ù…Ø©</th></tr></thead><tbody>`;
      customerOrders.forEach(order => {
        html += `<tr><td>${formatDate(order.date)}</td><td>${order.assigned || '-'}</td><td>${getServiceTypeName(order.serviceType)}</td></tr>`;
      });
      html += `</tbody></table></div>`;
    }
    // Ø¥Ù†Ø´Ø§Ø¡ modal Ø¥Ø°Ø§ Ù„Ù… ÙŠÙƒÙ† Ù…ÙˆØ¬ÙˆØ¯Ø§Ù‹
    let modal = document.getElementById('customerTransactionsModal');
    if (!modal) {
      modal = document.createElement('div');
      modal.className = 'modal fade';
      modal.id = 'customerTransactionsModal';
      modal.tabIndex = '-1';
      modal.innerHTML = `
        <div class="modal-dialog modal-lg">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title">Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„</h5>
              <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body" id="customerTransactionsBody"></div>
            <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Ø¥ØºÙ„Ø§Ù‚</button>
            </div>
          </div>
        </div>`;
      document.body.appendChild(modal);
    }
    // ØªØ£ÙƒØ¯ Ù…Ù† ÙˆØ¬ÙˆØ¯ body
    if (!document.getElementById('customerTransactionsBody')) {
      modal.querySelector('.modal-body').id = 'customerTransactionsBody';
    }
    document.getElementById('customerTransactionsBody').innerHTML = html;
    const bsModal = new bootstrap.Modal(modal);
    bsModal.show();
  }

  </script>
</head>
<body>


  <!-- Ø²Ø± Ø§Ù„ØªØ¨Ø¯ÙŠÙ„ Ù„Ù„Ø³Ø§ÙŠØ¯Ø¨Ø§Ø± ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„ØµØºÙŠØ±Ø© -->
  <button class="mobile-toggle-sidebar d-md-none" onclick="toggleSidebar()">
    <i class="bi bi-list"></i>
  </button>

  <div class="container-fluid p-0">
    <div class="row g-0">
      <!-- Sidebar -->
      <div class="sidebar" id="sidebar">
        <a href="#" class="navbar-brand mb-4 fs-3 fw-bold p-3">Ana Jay</a>
        <ul class="nav nav-pills flex-column mb-auto">
          <li><a href="#" class="nav-link active p-3" id="dashboardNav" onclick="showPage('dashboard')"><i class="bi bi-speedometer2 me-2"></i><span>Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</span></a></li>
          <li><a href="#" class="nav-link p-3" id="ordersNav" onclick="showPage('orders')"><i class="bi bi-cart4 me-2"></i><span>Ø§Ù„Ø·Ù„Ø¨Ø§Øª</span></a></li>
          <li><a href="#" class="nav-link p-3" id="allOrdersNav" onclick="showPage('allOrders')"><i class="bi bi-archive me-2"></i><span>ÙƒÙ„ Ø§Ù„Ø·Ù„Ø¨Ø§Øª</span></a></li>
          <li><a href="#" class="nav-link p-3" id="techniciansNav" onclick="showPage('technicians')"><i class="bi bi-person-gear me-2"></i><span>Ø§Ù„ÙÙ†ÙŠÙŠÙ†</span></a></li>
          
          <li><a href="#" class="nav-link p-3" id="deliverymenNav" onclick="showPage('deliverymen')"><i class="bi bi-truck me-2"></i><span>Ø§Ù„Ù…Ù†Ø§Ø¯ÙŠØ¨</span></a></li>
          <li><a href="#" class="nav-link p-3" id="customersNav" onclick="showPage('customers')"><i class="bi bi-people me-2"></i><span>Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡</span></a></li>
          <li><a href="#" class="nav-link p-3" id="complaintsNav" onclick="showPage('complaints')"><i class="bi bi-exclamation-triangle me-2"></i><span>Ø§Ù„Ø´ÙƒØ§ÙˆÙ‰</span></a></li>
          <li><a href="#" class="nav-link p-3" id="vipCardsNav" onclick="showPage('vipCards')"><i class="bi bi-credit-card me-2"></i><span>ÙƒØ±ÙˆØª VIP</span></a></li>
          <li><a href="#" class="nav-link p-3" id="backupNav" onclick="showPage('backup')"><i class="bi bi-download me-2"></i><span>Ø§Ù„Ù†Ø³Ø® Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠ</span></a></li>

        </ul>
        <hr>
        <div class="mt-auto p-3">
          <div class="d-flex align-items-center">
            <img src="https://randomuser.me/api/portraits/men/32.jpg" class="user-avatar me-2" alt="admin">
            <span id="adminNameDisplay">Ø¹Ø¨Ø¯Ø§Ù„Ø±Ø­Ù…Ù† Ø³ÙŠØ¯</span>
          </div>
        </div>
      </div>
      
      <!-- Main Content -->
      <div class="main-content" id="mainContent">
        <!-- Header -->
        <div class="dashboard-header p-3 mb-4 d-flex justify-content-between align-items-center">
          <h4 class="mb-0 fw-bold" id="pageTitle">Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</h4>
          <div class="d-flex align-items-center gap-3">
            <!-- Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø¬Ù„Ø³Ø© -->
            <div class="session-timer" id="sessionTimer" style="display: none;">
              <div class="timer-display">
                <div class="timer-time" id="sessionTimerTime">01:00</div>
                <div class="timer-status" id="sessionTimerStatus">Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ</div>
              </div>
              <div class="timer-progress">
                <div class="timer-progress-bar" id="sessionTimerProgressBar"></div>
              </div>
              <div class="timer-actions">
                <button class="btn btn-sm btn-outline-warning" onclick="extendSession()">
                  <i class="bi bi-arrow-clockwise"></i>
                </button>
                <button class="btn btn-sm btn-outline-danger" onclick="adminLogout()">
                  <i class="bi bi-box-arrow-right"></i>
                </button>
              </div>
            </div>
            <span class="text-muted">Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ğŸ‘‹</span>
            <button id="logoutBtn" class="btn btn-outline-danger btn-sm" onclick="adminLogout()" style="display: none;">
              <i class="bi bi-box-arrow-right"></i> ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬
            </button>
          </div>
        </div>
        
        <!-- Ø´Ø±ÙŠØ· Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø«Ø§Ø¨Øª -->
        <div class="fixed-stats-bar bg-white p-3 rounded shadow-sm mb-4 sticky-top" style="top: 10px; z-index: 999;">
          <div class="row text-center g-2">
            <div class="col-6 col-md-3">
              <div class="small text-muted">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø·Ù„Ø¨Ø§Øª</div>
              <div class="fw-bold fs-5" id="fixedStatsTotal">1</div>
            </div>
            <div class="col-6 col-md-3">
              <div class="small text-muted">Ø·Ù„Ø¨Ø§Øª Ø¬Ø¯ÙŠØ¯Ø©</div>
              <div class="fw-bold fs-5 text-primary" id="fixedStatsNew">0</div>
            </div>
            <div class="col-6 col-md-3">
              <div class="small text-muted">Ù‚ÙŠØ¯ Ø§Ù„ØªÙ†ÙÙŠØ°</div>
              <div class="fw-bold fs-5 text-warning" id="fixedStatsPending">0</div>
            </div>
            <div class="col-6 col-md-3">
              <div class="small text-muted">ØªÙ… Ø§Ù„ØªÙˆØµÙŠÙ„</div>
              <div class="fw-bold fs-5 text-success" id="fixedStatsCompleted">1</div>
            </div>
          </div>
        </div>
        
        <!-- Dashboard Page -->
        <div class="page-content active" id="dashboardPage">
          <div class="container-fluid py-3">
            <div class="row flex-nowrap">
              <div class="col p-4">
                <!-- Welcome Alert -->
                <div class="alert alert-info text-center mb-4" role="alert">
                  Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©! ÙŠÙ…ÙƒÙ†Ùƒ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø·Ù„Ø¨Ø§Øª ÙˆØ§Ù„ÙÙ†ÙŠÙŠÙ† ÙˆØ§Ù„Ø¹Ù…Ù„Ø§Ø¡ Ø¨Ø³Ù‡ÙˆÙ„Ø©.
                </div>
                <!-- Stats Cards -->
                <div class="row g-2 mb-3">
                  <div class="col-6 col-md-3">
                    <div class="bg-white p-2 stat-card shadow-sm d-flex align-items-center">
                      <i class="bi bi-box-seam stat-icon text-primary ms-2"></i>
                      <div>
                        <div class="fw-bold fs-6" id="statsItems">0</div>
                        <div class="text-muted small">Ø§Ù„Ø£ØµÙ†Ø§Ù <button class="btn btn-sm btn-outline-primary btn-xs ms-1" onclick="showAddItemModal()">+</button></div>
                      </div>
                    </div>
                  </div>
                  <div class="col-6 col-md-3">
                    <div class="bg-white p-2 stat-card shadow-sm d-flex align-items-center">
                      <i class="bi bi-cart4 stat-icon text-success ms-2"></i>
                      <div>
                        <div class="fw-bold fs-6" id="statsOrders">0</div>
                        <div class="text-muted small">Ø§Ù„Ø·Ù„Ø¨Ø§Øª</div>
                      </div>
                    </div>
                  </div>
                  <div class="col-6 col-md-3">
                    <div class="bg-white p-2 stat-card shadow-sm d-flex align-items-center">
                      <i class="bi bi-exclamation-triangle stat-icon text-warning ms-2"></i>
                      <div>
                        <div class="fw-bold fs-6" id="statsComplaints">0</div>
                        <div class="text-muted small">Ø§Ù„Ø´ÙƒØ§ÙˆÙ‰ <button class="btn btn-sm btn-outline-primary btn-xs ms-1" onclick="showAddComplaintModal()">+</button></div>
                      </div>
                    </div>
                  </div>
                  <div class="col-6 col-md-3">
                    <div class="bg-white p-2 stat-card shadow-sm d-flex align-items-center">
                      <i class="bi bi-people stat-icon text-danger ms-2"></i>
                      <div>
                        <div class="fw-bold fs-6" id="statsCustomers">0</div>
                        <div class="text-muted small">Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡</div>
                      </div>
                    </div>
                  </div>
                </div>
                <!-- Orders Chart -->
                <div class="bg-white p-3 rounded shadow-sm mb-4">
                  <div class="chart-options">
                    <h5 class="fw-bold mb-0">Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø·Ù„Ø¨Ø§Øª</h5>
                    <div class="d-flex gap-2">
                      <div class="chart-type-selector">
                        <button class="chart-type-btn active" data-type="line" onclick="changeChartType('line')">Ø®Ø·ÙŠ</button>
                        <button class="chart-type-btn" data-type="bar" onclick="changeChartType('bar')">Ø´Ø±ÙŠØ·ÙŠ</button>
                        <button class="chart-type-btn" data-type="doughnut" onclick="changeChartType('doughnut')">Ø¯Ø§Ø¦Ø±ÙŠ</button>
                      </div>
                      <div class="chart-period-selector">
                        <select class="form-select form-select-sm" id="chartPeriod" onchange="updateChartPeriod()">
                          <option value="thisWeek">Ù‡Ø°Ø§ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹</option>
                          <option value="thisMonth">Ù‡Ø°Ø§ Ø§Ù„Ø´Ù‡Ø±</option>
                          <option value="week">Ø£Ø³Ø¨ÙˆØ¹ÙŠ</option>
                          <option value="month" selected>Ø´Ù‡Ø±ÙŠ</option>
                          <option value="year">Ø³Ù†ÙˆÙŠ</option>
                          <option value="custom">ØªØ®ØµÙŠØµ ÙØªØ±Ø©</option>
                        </select>
                      </div>
                      <div class="date-range-selector" id="dateRangeSelector" style="display: none;">
                        <div class="input-group input-group-sm">
                          <input type="date" class="form-control form-control-sm" id="startDate" onchange="updateChartPeriod()">
                          <span class="input-group-text">Ø¥Ù„Ù‰</span>
                          <input type="date" class="form-control form-control-sm" id="endDate" onchange="updateChartPeriod()">
                        </div>
                      </div>
                      <button class="btn btn-sm btn-outline-primary" onclick="exportChartData()">
                        <i class="bi bi-download"></i> ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                      </button>
                    </div>
                  </div>
                  <div class="chart-container">
                    <canvas id="ordersChart"></canvas>
                    <div id="chartLoading" class="text-center p-5" style="display: none; position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: rgba(255,255,255,0.8);">
                      <div class="spinner-border text-primary" role="status">
                        <span class="visually-hidden">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</span>
                      </div>
                      <p class="mt-2">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...</p>
                    </div>
                  </div>
                  <div class="chart-legend" id="chartLegend">
                    <!-- Ø³ÙŠØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠÙ‹Ø§ -->
                  </div>
                </div>
                <!-- Orders Table -->
                <div class="bg-white p-2 p-md-3 rounded shadow-sm mb-4">
                  <div class="d-flex flex-wrap justify-content-between align-items-center mb-3 gap-2">
                    <div class="d-flex flex-column flex-md-row gap-2">
                      <input type="text" class="form-control form-control-sm" id="orderSearchInput" placeholder="Ø¨Ø­Ø« Ø¹Ù† Ø¹Ù…ÙŠÙ„ Ø£Ùˆ Ø±Ù‚Ù… Ø·Ù„Ø¨..." style="min-width: 200px;" oninput="filterOrders()">
                      <select class="form-select form-select-sm" id="orderStatusFilter" style="min-width: 120px;" onchange="filterOrders()">
                        <option value="">ÙƒÙ„ Ø§Ù„Ø­Ø§Ù„Ø§Øª</option>
                        <option value="Ø¬Ø¯ÙŠØ¯">Ø¬Ø¯ÙŠØ¯</option>
                        <option value="Ù‚ÙŠØ¯ Ø§Ù„ØªÙ†ÙÙŠØ°">Ù‚ÙŠØ¯ Ø§Ù„ØªÙ†ÙÙŠØ°</option>
                        <option value="Ù…Ø¤Ø¬Ù„">Ù…Ø¤Ø¬Ù„</option>
                        <option value="ØªÙ… Ø§Ù„ØªÙˆØµÙŠÙ„">ØªÙ… Ø§Ù„ØªÙˆØµÙŠÙ„</option>
                        <option value="Ù…Ù„ØºÙŠ">Ù…Ù„ØºÙŠ</option>
                      </select>
                    </div>
                    <div class="d-flex flex-column flex-md-row gap-2">
                      <button class="btn btn-sm btn-primary" onclick="showAddOrderModal()"><i class="bi bi-plus-lg"></i> Ø¥Ø¶Ø§ÙØ© Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯</button>
                    </div>
                  </div>
                  <div class="table-responsive">
                    <table class="table align-middle table-sm" id="ordersTable">
                      <thead>
                        <tr>
                          <th>Ø±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨</th>
                          <th>Ø§Ù„Ø¹Ù…ÙŠÙ„</th>
                          <th class="d-none d-md-table-cell">Ø§Ù„Ø¹Ù†ÙˆØ§Ù†</th>
                          <th>Ø§Ù„Ø­Ø§Ù„Ø©</th>
                          <th class="d-none d-md-table-cell">Ø§Ù„ÙÙ†ÙŠ/Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨</th>
                          <th class="d-none d-md-table-cell">ØªØ§Ø±ÙŠØ® ÙˆÙˆÙ‚Øª Ø§Ù„Ø·Ù„Ø¨</th>
                          <th>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
                        </tr>
                      </thead>
                      <tbody id="ordersTableBodyMain">
                        <!-- Ø§Ù„Ø·Ù„Ø¨Ø§Øª ØªÙØ¨Ù†Ù‰ Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠÙ‹Ø§ Ù…Ù† localStorage ÙÙ‚Ø· -->
                      </tbody>
                    </table>
                  </div>
                </div>
                <!-- Top Technicians & Customers -->
                <div class="row g-2">
                  <div class="col-12 col-md-4">
                    <div class="bg-white p-2 rounded shadow-sm mb-3">
                      <h6 class="fw-bold mb-2 fs-6">Ø£ÙØ¶Ù„ Ø§Ù„ÙÙ†ÙŠÙŠÙ†</h6>
                      <ul class="list-group list-group-sm" id="topTechniciansList">
                        <!-- Ø³ÙŠØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ù‚Ø§Ø¦Ù…Ø© Ø£ÙØ¶Ù„ Ø§Ù„ÙÙ†ÙŠÙŠÙ† Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠÙ‹Ø§ Ù…Ù† Ø®Ù„Ø§Ù„ Ø§Ù„ÙƒÙˆØ¯ -->
                      </ul>
                    </div>
                  </div>
                  <div class="col-12 col-md-4">
                    <div class="bg-white p-2 rounded shadow-sm mb-3">
                      <h6 class="fw-bold mb-2 fs-6">Ø£ÙØ¶Ù„ Ø§Ù„Ù…Ù†Ø§Ø¯ÙŠØ¨</h6>
                      <ul class="list-group list-group-sm" id="topDeliverymenList">
                        <!-- Ø³ÙŠØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ù‚Ø§Ø¦Ù…Ø© Ø£ÙØ¶Ù„ Ø§Ù„Ù…Ù†Ø§Ø¯ÙŠØ¨ Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠÙ‹Ø§ Ù…Ù† Ø®Ù„Ø§Ù„ Ø§Ù„ÙƒÙˆØ¯ -->
                      </ul>
                    </div>
                  </div>
                  <div class="col-12 col-md-4">
                    <div class="bg-white p-2 rounded shadow-sm mb-3">
                      <h6 class="fw-bold mb-2 fs-6">Ø£ÙØ¶Ù„ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡</h6>
                      <ul class="list-group list-group-sm" id="topCustomersList">
                        <!-- Ø³ÙŠØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ù‚Ø§Ø¦Ù…Ø© Ø£ÙØ¶Ù„ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠÙ‹Ø§ Ù…Ù† Ø®Ù„Ø§Ù„ Ø§Ù„ÙƒÙˆØ¯ -->
                      </ul>
                    </div>
                  </div>
                </div>
                <!-- Footer -->
                <footer class="text-center text-muted mt-4 py-2" style="font-size: 14px;">
                  &copy; 2025 Ana Jay. Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø©.
                </footer>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Orders Page -->
        <div class="page-content" id="ordersPage">
          <div class="container-fluid py-3">
            <div class="row">
              <div class="col-12">
                <h5 class="page-title">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø·Ù„Ø¨Ø§Øª</h5>
                
                <div class="bg-white p-3 rounded shadow-sm mb-4">
                  <div class="d-flex flex-wrap justify-content-between align-items-center mb-3 gap-2">
                    <div class="d-flex flex-column flex-md-row gap-2">
                      <input type="text" class="form-control form-control-sm" id="orderPageSearchInput" placeholder="Ø¨Ø­Ø« Ø¹Ù† Ø¹Ù…ÙŠÙ„ Ø£Ùˆ Ø±Ù‚Ù… Ø·Ù„Ø¨..." style="min-width: 200px;" oninput="filterOrdersPage()">
                      <select class="form-select form-select-sm" id="orderPageStatusFilter" style="min-width: 120px;" onchange="filterOrdersPage()">
                        <option value="">ÙƒÙ„ Ø§Ù„Ø­Ø§Ù„Ø§Øª</option>
                        <option value="Ø¬Ø¯ÙŠØ¯">Ø¬Ø¯ÙŠØ¯</option>
                        <option value="Ù‚ÙŠØ¯ Ø§Ù„ØªÙ†ÙÙŠØ°">Ù‚ÙŠØ¯ Ø§Ù„ØªÙ†ÙÙŠØ°</option>
                        <option value="Ù…Ø¤Ø¬Ù„">Ù…Ø¤Ø¬Ù„</option>
                        <option value="ØªÙ… Ø§Ù„ØªÙˆØµÙŠÙ„">ØªÙ… Ø§Ù„ØªÙˆØµÙŠÙ„</option>
                        <option value="Ù…Ù„ØºÙŠ">Ù…Ù„ØºÙŠ</option>
                      </select>
                      <select class="form-select form-select-sm" id="orderMonthFilter" style="min-width: 120px;" onchange="filterOrdersPage()">
                        <option value="">ÙƒÙ„ Ø§Ù„Ø£Ø´Ù‡Ø±</option>
                        <option value="0">ÙŠÙ†Ø§ÙŠØ±</option>
                        <option value="1">ÙØ¨Ø±Ø§ÙŠØ±</option>
                        <option value="2">Ù…Ø§Ø±Ø³</option>
                        <option value="3">Ø£Ø¨Ø±ÙŠÙ„</option>
                        <option value="4">Ù…Ø§ÙŠÙˆ</option>
                        <option value="5">ÙŠÙˆÙ†ÙŠÙˆ</option>
                        <option value="6">ÙŠÙˆÙ„ÙŠÙˆ</option>
                        <option value="7">Ø£ØºØ³Ø·Ø³</option>
                        <option value="8">Ø³Ø¨ØªÙ…Ø¨Ø±</option>
                        <option value="9">Ø£ÙƒØªÙˆØ¨Ø±</option>
                        <option value="10">Ù†ÙˆÙÙ…Ø¨Ø±</option>
                        <option value="11">Ø¯ÙŠØ³Ù…Ø¨Ø±</option>
                      </select>
                      <select class="form-select form-select-sm" id="orderDayFilter" style="min-width: 120px;" onchange="filterOrdersPage()">
                        <option value="">ÙƒÙ„ Ø§Ù„Ø£ÙŠØ§Ù…</option>
                        <option value="0">Ø§Ù„Ø£Ø­Ø¯</option>
                        <option value="1">Ø§Ù„Ø¥Ø«Ù†ÙŠÙ†</option>
                        <option value="2">Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡</option>
                        <option value="3">Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡</option>
                        <option value="4">Ø§Ù„Ø®Ù…ÙŠØ³</option>
                        <option value="5">Ø§Ù„Ø¬Ù…Ø¹Ø©</option>
                        <option value="6">Ø§Ù„Ø³Ø¨Øª</option>
                      </select>
                    </div>
                    <div class="d-flex flex-column flex-md-row gap-2">
                      <button class="btn btn-sm btn-primary" onclick="showAddOrderModal()"><i class="bi bi-plus-lg"></i> Ø¥Ø¶Ø§ÙØ© Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯</button>
                    </div>
                  </div>
                  <div class="table-responsive">
                    <table class="table align-middle" id="ordersPageTable">
                      <thead>
                        <tr>
                          <th>Ø±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨</th>
                          <th>Ø§Ù„Ø¹Ù…ÙŠÙ„</th>
                          <th>Ø§Ù„Ø¹Ù†ÙˆØ§Ù†</th>
                          <th>Ø§Ù„Ø­Ø§Ù„Ø©</th>
                          <th>Ø§Ù„ÙÙ†ÙŠ/Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨</th>
                          <th>Ø§Ù„Ù…Ø¨Ù„Øº</th>
                          <th>ØªØ§Ø±ÙŠØ® ÙˆÙˆÙ‚Øª Ø§Ù„Ø·Ù„Ø¨</th>
                          <th>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
                        </tr>
                      </thead>
                      <tbody id="ordersTableBody">
                        <!-- Ø§Ù„Ø·Ù„Ø¨Ø§Øª ØªÙØ¨Ù†Ù‰ Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ§Ù‹ Ù…Ù† localStorage ÙÙ‚Ø· -->
                      </tbody>
                    </table>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        
        <!-- All Orders Page -->
        <div class="page-content" id="allOrdersPage">
          <div class="container-fluid py-3">
            <div class="row">
              <div class="col-12">
                <h5 class="page-title">ÙƒÙ„ Ø§Ù„Ø·Ù„Ø¨Ø§Øª - Ø§Ù„Ø£Ø±Ø´ÙŠÙ</h5>
                
                <div class="alert alert-info mb-4">
                  <i class="bi bi-info-circle-fill me-2"></i>
                  Ù‡Ø°Ù‡ Ø§Ù„ØµÙØ­Ø© ØªØ¹Ø±Ø¶ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ù…Ù†Ø° Ù„Ø­Ø¸Ø© Ø¥Ù†Ø´Ø§Ø¦Ù‡Ø§ØŒ Ø¨Ù…Ø§ ÙÙŠ Ø°Ù„Ùƒ Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù…Ø­Ø°ÙˆÙØ© ÙˆØ§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„ØªÙŠ ØªÙ… ØªØµÙÙŠØ© Ø§Ù„ÙÙ†ÙŠÙŠÙ† Ù…Ù†Ù‡Ø§.
                </div>
                
                <div class="bg-white p-3 rounded shadow-sm mb-4">
                  <div class="d-flex flex-wrap justify-content-between align-items-center mb-3 gap-2">
                    <div class="d-flex flex-column flex-md-row gap-2">
                      <input type="text" class="form-control form-control-sm" id="allOrdersSearchInput" placeholder="Ø¨Ø­Ø« Ø¹Ù† Ø¹Ù…ÙŠÙ„ Ø£Ùˆ Ø±Ù‚Ù… Ø·Ù„Ø¨..." style="min-width: 200px;" oninput="filterAllOrders()">
                      <select class="form-select form-select-sm" id="allOrdersStatusFilter" style="min-width: 120px;" onchange="filterAllOrders()">
                        <option value="">ÙƒÙ„ Ø§Ù„Ø­Ø§Ù„Ø§Øª</option>
                        <option value="Ø¬Ø¯ÙŠØ¯">Ø¬Ø¯ÙŠØ¯</option>
                        <option value="Ù‚ÙŠØ¯ Ø§Ù„ØªÙ†ÙÙŠØ°">Ù‚ÙŠØ¯ Ø§Ù„ØªÙ†ÙÙŠØ°</option>
                        <option value="Ù…Ø¤Ø¬Ù„">Ù…Ø¤Ø¬Ù„</option>
                        <option value="ØªÙ… Ø§Ù„ØªÙˆØµÙŠÙ„">ØªÙ… Ø§Ù„ØªÙˆØµÙŠÙ„</option>
                        <option value="Ù…Ù„ØºÙŠ">Ù…Ù„ØºÙŠ</option>
                        <option value="Ù…Ø­Ø°ÙˆÙ">Ù…Ø­Ø°ÙˆÙ</option>
                      </select>
                      <select class="form-select form-select-sm" id="allOrdersMonthFilter" style="min-width: 120px;" onchange="filterAllOrders()">
                        <option value="">ÙƒÙ„ Ø§Ù„Ø£Ø´Ù‡Ø±</option>
                        <option value="0">ÙŠÙ†Ø§ÙŠØ±</option>
                        <option value="1">ÙØ¨Ø±Ø§ÙŠØ±</option>
                        <option value="2">Ù…Ø§Ø±Ø³</option>
                        <option value="3">Ø£Ø¨Ø±ÙŠÙ„</option>
                        <option value="4">Ù…Ø§ÙŠÙˆ</option>
                        <option value="5">ÙŠÙˆÙ†ÙŠÙˆ</option>
                        <option value="6">ÙŠÙˆÙ„ÙŠÙˆ</option>
                        <option value="7">Ø£ØºØ³Ø·Ø³</option>
                        <option value="8">Ø³Ø¨ØªÙ…Ø¨Ø±</option>
                        <option value="9">Ø£ÙƒØªÙˆØ¨Ø±</option>
                        <option value="10">Ù†ÙˆÙÙ…Ø¨Ø±</option>
                        <option value="11">Ø¯ÙŠØ³Ù…Ø¨Ø±</option>
                      </select>
                      <select class="form-select form-select-sm" id="allOrdersYearFilter" style="min-width: 120px;" onchange="filterAllOrders()">
                        <option value="">ÙƒÙ„ Ø§Ù„Ø³Ù†ÙˆØ§Øª</option>
                        <option value="2023">2023</option>
                        <option value="2024">2024</option>
                        <option value="2025">2025</option>
                        <option value="2026">2026</option>
                      </select>
                      <input type="date" class="form-control form-control-sm" id="allOrdersDateFrom" placeholder="Ù…Ù† ØªØ§Ø±ÙŠØ®" style="min-width: 140px;" onchange="filterAllOrders()">
                      <input type="date" class="form-control form-control-sm" id="allOrdersDateTo" placeholder="Ø¥Ù„Ù‰ ØªØ§Ø±ÙŠØ®" style="min-width: 140px;" onchange="filterAllOrders()">
                    </div>
                    <div class="d-flex flex-column flex-md-row gap-2">
                      <button class="btn btn-sm btn-success" onclick="exportAllOrdersExcel()"><i class="bi bi-file-earmark-excel"></i> ØªØµØ¯ÙŠØ± Excel</button>
                      <button class="btn btn-sm btn-warning" onclick="clearAllOrdersArchive()"><i class="bi bi-trash"></i> Ù…Ø³Ø­ Ø§Ù„Ø£Ø±Ø´ÙŠÙ</button>
                    </div>
                  </div>
                  <div class="table-responsive">
                    <table class="table align-middle" id="allOrdersPageTable">
                      <thead>
                        <tr>
                          <th>Ø±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨</th>
                          <th>Ø§Ù„Ø¹Ù…ÙŠÙ„</th>
                          <th>Ø§Ù„Ø¹Ù†ÙˆØ§Ù†</th>
                          <th>Ø§Ù„Ø­Ø§Ù„Ø©</th>
                          <th>Ø§Ù„ÙÙ†ÙŠ/Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨</th>
                          <th>Ø§Ù„Ù…Ø¨Ù„Øº</th>
                          <th>ØªØ§Ø±ÙŠØ® ÙˆÙˆÙ‚Øª Ø§Ù„Ø·Ù„Ø¨</th>
                          <th>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø­Ø°Ù/Ø§Ù„Ø¥Ø®ÙØ§Ø¡</th>
                          <th>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
                        </tr>
                      </thead>
                      <tbody id="allOrdersTableBody">
                        <!-- ÙƒÙ„ Ø§Ù„Ø·Ù„Ø¨Ø§Øª ØªÙØ¨Ù†Ù‰ Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ§Ù‹ Ù…Ù† localStorage -->
                      </tbody>
                    </table>
                  </div>
                </div>
                
                <!-- Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª ÙƒÙ„ Ø§Ù„Ø·Ù„Ø¨Ø§Øª -->
                <div class="row g-3 mb-4">
                  <div class="col-md-3">
                    <div class="card text-center">
                      <div class="card-body">
                        <h3 class="fw-bold text-primary" id="allOrdersTotalCount">0</h3>
                        <p class="mb-0">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø·Ù„Ø¨Ø§Øª</p>
                      </div>
                    </div>
                  </div>
                  <div class="col-md-3">
                    <div class="card text-center">
                      <div class="card-body">
                        <h3 class="fw-bold text-success" id="allOrdersActiveCount">0</h3>
                        <p class="mb-0">Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù†Ø´Ø·Ø©</p>
                      </div>
                    </div>
                  </div>
                  <div class="col-md-3">
                    <div class="card text-center">
                      <div class="card-body">
                        <h3 class="fw-bold text-danger" id="allOrdersDeletedCount">0</h3>
                        <p class="mb-0">Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù…Ø­Ø°ÙˆÙØ©</p>
                      </div>
                    </div>
                  </div>
                  <div class="col-md-3">
                    <div class="card text-center">
                      <div class="card-body">
                        <h3 class="fw-bold text-info" id="allOrdersTotalAmount">0</h3>
                        <p class="mb-0">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø¨Ø§Ù„Øº</p>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Technicians Page -->
        <div class="page-content" id="techniciansPage">
          <div class="container-fluid py-3">
            <div class="row">
              <div class="col-12">
                <h5 class="page-title">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ÙÙ†ÙŠÙŠÙ†</h5>
                
                <div class="d-flex justify-content-between align-items-center mb-3">
                  <div>
                    <label for="technicianSpecialtyFilter" class="form-label mb-0 me-2">ØªØµÙÙŠØ© Ø­Ø³Ø¨ Ø§Ù„ØªØ®ØµØµ:</label>
                    <select id="technicianSpecialtyFilter" class="form-select form-select-sm d-inline-block" style="width: 180px; display: inline-block;" onchange="filterTechniciansBySpecialty()">
                      <option value="">ÙƒÙ„ Ø§Ù„ØªØ®ØµØµØ§Øª</option>
                      <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¡ Ø§Ù„ØªØ®ØµØµØ§Øª Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ§Ù‹ -->
                    </select>
                  </div>
                  <button class="btn btn-primary admin-only" onclick="showAddTechnicianModal()"><i class="bi bi-plus-lg"></i> Ø¥Ø¶Ø§ÙØ© ÙÙ†ÙŠ Ø¬Ø¯ÙŠØ¯</button>
                </div>
                
                <div class="row g-3" id="techniciansList">
                  <!-- Ø³ÙŠØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„ÙÙ†ÙŠÙŠÙ† Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠÙ‹Ø§ Ù…Ù† Ø®Ù„Ø§Ù„ Ø§Ù„ÙƒÙˆØ¯ -->
                </div>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Restaurants Page -->
        <div class="page-content" id="restaurantsPage">
          <div class="container-fluid py-3">
            <div class="row">
              <div class="col-12">
                <h5 class="page-title">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø·Ø§Ø¹Ù…</h5>
                
                <div class="d-flex justify-content-end mb-3">
                  <button class="btn btn-primary admin-only" onclick="showAddRestaurantModal()"><i class="bi bi-plus-lg"></i> Ø¥Ø¶Ø§ÙØ© Ù…Ø·Ø¹Ù… Ø¬Ø¯ÙŠØ¯</button>
                </div>
                
                <div class="row g-3" id="restaurantsList">
                  <!-- Ø³ÙŠØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ù…Ø·Ø§Ø¹Ù… Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠÙ‹Ø§ Ù…Ù† Ø®Ù„Ø§Ù„ Ø§Ù„ÙƒÙˆØ¯ -->
                </div>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Deliverymen Page -->
        <div class="page-content" id="deliverymenPage">
          <div class="container-fluid py-3">
            <div class="row">
              <div class="col-12">
                <h5 class="page-title">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ù†Ø§Ø¯ÙŠØ¨</h5>
                
                <div class="d-flex justify-content-end mb-3">
                  <button class="btn btn-primary admin-only" onclick="showAddDeliverymanModal()"><i class="bi bi-plus-lg"></i> Ø¥Ø¶Ø§ÙØ© Ù…Ù†Ø¯ÙˆØ¨ Ø¬Ø¯ÙŠØ¯</button>
                </div>
                
                <div class="row g-3" id="deliverymenList">
                  <!-- Ø³ÙŠØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ù…Ù†Ø§Ø¯ÙŠØ¨ Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠÙ‹Ø§ Ù…Ù† Ø®Ù„Ø§Ù„ Ø§Ù„ÙƒÙˆØ¯ -->
                </div>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Customers Page -->
        <div class="page-content" id="customersPage">
          <div class="container-fluid py-3">
            <div class="row">
              <div class="col-12">
                <h5 class="page-title">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡</h5>
                
                <div class="d-flex justify-content-between mb-3">
                  <input type="text" class="form-control" placeholder="Ø¨Ø­Ø« Ø¹Ù† Ø¹Ù…ÙŠÙ„..." style="max-width: 300px;" id="customerSearchInput" oninput="filterCustomers()">
                  <button class="btn btn-primary admin-only" onclick="showAddCustomerModal()"><i class="bi bi-plus-lg"></i> Ø¥Ø¶Ø§ÙØ© Ø¹Ù…ÙŠÙ„ Ø¬Ø¯ÙŠØ¯</button>
                </div>
                
                <div class="table-responsive">
                  <table class="table align-middle" id="customersTable">
                    <thead>
                      <tr>
                        <th>Ø§Ù„Ø§Ø³Ù…</th>
                        <th>Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ</th>
                        <th>Ø§Ù„Ø¹Ù†ÙˆØ§Ù†</th>
                        <th>Ø¹Ø¯Ø¯ Ø§Ù„Ø·Ù„Ø¨Ø§Øª</th>
                        <th>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
                      </tr>
                    </thead>
                    <tbody id="customersTableBody">
                      <!-- Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ ÙŠÙØ¨Ù†ÙˆÙ† Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ§Ù‹ Ù…Ù† localStorage ÙÙ‚Ø· -->
                    </tbody>
                  </table>
                </div>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Backup Page -->
        <div class="page-content" id="backupPage">
          <div class="container-fluid py-3">
            <div class="row">
              <div class="col-12">
                <h5 class="page-title">Ù†Ø³Ø® Ø§Ø­ØªÙŠØ§Ø·ÙŠ ÙˆØ§Ø³ØªØ¹Ø§Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</h5>
                
                <div class="alert alert-info mb-4">
                  <i class="bi bi-info-circle-fill me-2"></i>
                  ÙŠÙ…ÙƒÙ†Ùƒ Ù‡Ù†Ø§ Ø¹Ù…Ù„ Ù†Ø³Ø® Ø§Ø­ØªÙŠØ§Ø·ÙŠ Ù„Ø¨ÙŠØ§Ù†Ø§ØªÙƒ ÙˆØªØµØ¯ÙŠØ±Ù‡Ø§ ÙƒÙ…Ù„Ù Ù„Ø­ÙØ¸Ù‡Ø§ Ø¹Ù„Ù‰ Ø¬Ù‡Ø§Ø²Ùƒ Ø£Ùˆ Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ù†Ø³Ø®Ø© Ø³Ø§Ø¨Ù‚Ø©.
                </div>
                
                <div class="row g-4 mb-4">
                  <!-- Import Data Section -->
                  <div class="col-md-6">
                    <div class="card shadow-sm h-100">
                      <div class="card-header bg-success text-white text-center">
                        <h5 class="mb-0">Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</h5>
                      </div>
                      <div class="card-body">
                        <p class="text-center text-muted mb-4">
                          Ù‚Ù… Ø¨Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ù…Ù„Ù Ù„Ù„Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø£Ùˆ Ù†Ù‚Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ø¬Ù‡Ø§Ø² Ø¢Ø®Ø±
                        </p>
                        
                        <div class="input-group mb-3">
                          <input type="file" class="form-control" id="importFileInput" accept=".json">
                          <label class="input-group-text" for="importFileInput">Choose File</label>
                        </div>
                        
                        <div class="d-grid">
                          <button class="btn btn-success" onclick="importData()">
                            <i class="bi bi-upload me-2"></i> Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                          </button>
                        </div>
                      </div>
                    </div>
                  </div>
                  
                  <!-- Export Data Section -->
                  <div class="col-md-6">
                    <div class="card shadow-sm h-100">
                      <div class="card-header bg-primary text-white text-center">
                        <h5 class="mb-0">ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</h5>
                      </div>
                      <div class="card-body">
                        <p class="text-center text-muted mb-4">
                          Ù‚Ù… Ø¨ØªØµØ¯ÙŠØ± Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¥Ù„Ù‰ Ù…Ù„Ù Ù„Ø­ÙØ¸Ù‡Ø§ Ø£Ùˆ Ù†Ù‚Ù„Ù‡Ø§ Ø¥Ù„Ù‰ Ø¬Ù‡Ø§Ø² Ø¢Ø®Ø±
                        </p>
                        
                        <div class="d-grid gap-2">
                          <button class="btn btn-primary" onclick="exportDataJSON()">
                            <i class="bi bi-filetype-json me-2"></i> ØªØµØ¯ÙŠØ± Ø¨ØªÙ†Ø³ÙŠÙ‚ JSON
                          </button>
                          
                          <button class="btn btn-success" onclick="exportDataExcel()">
                            <i class="bi bi-file-earmark-excel me-2"></i> ØªØµØ¯ÙŠØ± Ø¨ØªÙ†Ø³ÙŠÙ‚ Excel
                          </button>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                
                <!-- Current Data Section -->
                <div class="card shadow-sm">
                  <div class="card-header bg-info text-white">
                    <h5 class="mb-0">Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø®Ø²Ù†Ø© Ø­Ø§Ù„ÙŠØ§Ù‹</h5>
                  </div>
                  <div class="card-body p-0">
                    <div class="table-responsive">
                      <table class="table table-striped mb-0">
                        <thead class="bg-light">
                          <tr>
                            <th>Ù†ÙˆØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</th>
                            <th>Ø§Ù„Ø¹Ø¯Ø¯</th>
                            <th>Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ«</th>
                            <th>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
                          </tr>
                        </thead>
                        <tbody id="backupTableBody">
                          <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¡ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ§Ù‹ -->
                        </tbody>
                      </table>
                    </div>
                  </div>
                </div>
                
                <!-- Backup History Card (Additional Enhancement) -->
                <div class="card shadow-sm mt-4">
                  <div class="card-header bg-secondary text-white d-flex justify-content-between align-items-center">
                    <h5 class="mb-0">Ø³Ø¬Ù„ Ø§Ù„Ù†Ø³Ø® Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠ</h5>
                    <button class="btn btn-sm btn-light" onclick="clearBackupHistory()">
                      <i class="bi bi-trash me-1"></i> Ù…Ø³Ø­ Ø§Ù„Ø³Ø¬Ù„
                    </button>
                  </div>
                  <div class="card-body p-0">
                    <div class="table-responsive">
                      <table class="table table-striped mb-0">
                        <thead class="bg-light">
                          <tr>
                            <th>Ø§Ù„ØªØ§Ø±ÙŠØ®</th>
                            <th>Ù†ÙˆØ¹ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©</th>
                            <th>Ø§Ù„Ø­Ø¬Ù…</th>
                            <th>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
                          </tr>
                        </thead>
                        <tbody id="backupHistoryTableBody">
                          <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¡ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ§Ù‹ -->
                        </tbody>
                      </table>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <!-- Complaints Page -->
        <div class="page-content" id="complaintsPage">
          <div class="container-fluid py-3">
            <div class="row">
              <div class="col-12">
                <h5 class="page-title">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø´ÙƒØ§ÙˆÙ‰</h5>
                
                <div class="bg-white p-3 rounded shadow-sm mb-4">
                  <div class="d-flex flex-wrap justify-content-between align-items-center mb-3 gap-2">
                    <div class="d-flex flex-column flex-md-row gap-2">
                      <input type="text" class="form-control form-control-sm" id="complaintSearchInput" placeholder="Ø¨Ø­Ø« Ø¹Ù† Ø´ÙƒÙˆÙ‰ Ø£Ùˆ Ø¹Ù…ÙŠÙ„..." style="min-width: 200px;" oninput="filterComplaints()">
                      <select class="form-select form-select-sm" id="complaintStatusFilter" style="min-width: 120px;" onchange="filterComplaints()">
                        <option value="">ÙƒÙ„ Ø§Ù„Ø­Ø§Ù„Ø§Øª</option>
                        <option value="Ø¬Ø¯ÙŠØ¯Ø©">Ø¬Ø¯ÙŠØ¯Ø©</option>
                        <option value="Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©">Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©</option>
                        <option value="ØªÙ… Ø§Ù„Ø­Ù„">ØªÙ… Ø§Ù„Ø­Ù„</option>
                        <option value="Ù…Ø±ÙÙˆØ¶Ø©">Ù…Ø±ÙÙˆØ¶Ø©</option>
                      </select>
                      <select class="form-select form-select-sm" id="complaintTypeFilter" style="min-width: 120px;" onchange="filterComplaints()">
                        <option value="">ÙƒÙ„ Ø§Ù„Ø£Ù†ÙˆØ§Ø¹</option>
                        <option value="Ø¬ÙˆØ¯Ø© Ø§Ù„Ø®Ø¯Ù…Ø©">Ø¬ÙˆØ¯Ø© Ø§Ù„Ø®Ø¯Ù…Ø©</option>
                        <option value="Ø³Ù„ÙˆÙƒ Ø§Ù„ÙÙ†ÙŠ">Ø³Ù„ÙˆÙƒ Ø§Ù„ÙÙ†ÙŠ</option>
                        <option value="ØªØ£Ø®ÙŠØ±">ØªØ£Ø®ÙŠØ±</option>
                        <option value="Ø±Ø³ÙˆÙ… Ø¥Ø¶Ø§ÙÙŠØ©">Ø±Ø³ÙˆÙ… Ø¥Ø¶Ø§ÙÙŠØ©</option>
                        <option value="Ø£Ø®Ø±Ù‰">Ø£Ø®Ø±Ù‰</option>
                      </select>
                    </div>
                    <div class="d-flex flex-column flex-md-row gap-2">
                      <button class="btn btn-sm btn-primary" onclick="showAddComplaintModal()"><i class="bi bi-plus-lg"></i> Ø¥Ø¶Ø§ÙØ© Ø´ÙƒÙˆÙ‰ Ø¬Ø¯ÙŠØ¯Ø©</button>
                    </div>
                  </div>
                  <div class="table-responsive">
                    <table class="table align-middle" id="complaintsTable">
                      <thead>
                        <tr>
                          <th>Ø±Ù‚Ù… Ø§Ù„Ø´ÙƒÙˆÙ‰</th>
                          <th>Ø§Ù„Ø¹Ù…ÙŠÙ„</th>
                          <th>Ø±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨</th>
                          <th>Ù†ÙˆØ¹ Ø§Ù„Ø´ÙƒÙˆÙ‰</th>
                          <th>Ø§Ù„Ø­Ø§Ù„Ø©</th>
                          <th>ØªØ§Ø±ÙŠØ® Ø§Ù„ØªÙ‚Ø¯ÙŠÙ…</th>
                          <th>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
                        </tr>
                      </thead>
                      <tbody id="complaintsTableBody">
                        <!-- Ø§Ù„Ø´ÙƒØ§ÙˆÙ‰ ØªÙØ¨Ù†Ù‰ Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ§Ù‹ Ù…Ù† localStorage ÙÙ‚Ø· -->
                      </tbody>
                    </table>
                  </div>
                </div>
                
                <!-- Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø´ÙƒØ§ÙˆÙ‰ -->
                <div class="row g-3 mb-4">
                  <div class="col-md-6">
                    <div class="card">
                      <div class="card-header bg-purple-medium text-white">
                        <h5 class="mb-0">Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø´ÙƒØ§ÙˆÙ‰</h5>
                      </div>
                      <div class="card-body">
                        <div class="row text-center">
                          <div class="col-6 mb-3">
                            <div class="border rounded p-2">
                              <h3 class="fw-bold text-primary" id="totalComplaintsCount">0</h3>
                              <p class="mb-0">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø´ÙƒØ§ÙˆÙ‰</p>
                            </div>
                          </div>
                          <div class="col-6 mb-3">
                            <div class="border rounded p-2">
                              <h3 class="fw-bold text-success" id="resolvedComplaintsCount">0</h3>
                              <p class="mb-0">ØªÙ… Ø­Ù„Ù‡Ø§</p>
                            </div>
                          </div>
                          <div class="col-6">
                            <div class="border rounded p-2">
                              <h3 class="fw-bold text-warning" id="pendingComplaintsCount">0</h3>
                              <p class="mb-0">Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©</p>
                            </div>
                          </div>
                          <div class="col-6">
                            <div class="border rounded p-2">
                              <h3 class="fw-bold text-danger" id="newComplaintsCount">0</h3>
                              <p class="mb-0">Ø¬Ø¯ÙŠØ¯Ø©</p>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="col-md-6">
                    <div class="card h-100">
                      <div class="card-header bg-purple-medium text-white">
                        <h5 class="mb-0">Ø£ÙƒØ«Ø± Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ø´ÙƒØ§ÙˆÙ‰</h5>
                      </div>
                      <div class="card-body">
                        <ul class="list-group" id="complaintTypesStats">
                          <!-- Ø³ÙŠØªÙ… ØªØ¹Ø¨Ø¦ØªÙ‡Ø§ Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠÙ‹Ø§ -->
                        </ul>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        
        <!-- VIP Cards Page -->
        <div class="page-content" id="vipCardsPage">
          <div class="container-fluid py-3">
            <div class="row">
              <div class="col-12">
                <h5 class="page-title">Ø¥Ø¯Ø§Ø±Ø© ÙƒØ±ÙˆØª VIP</h5>
                
                <div class="alert alert-info mb-4">
                  <i class="bi bi-info-circle-fill me-2"></i>
                  Ù†Ø¸Ø§Ù… ÙƒØ±ÙˆØª VIP ÙŠØ³Ù…Ø­ Ø¨Ø¥Ø¯Ø§Ø±Ø© ÙƒØ±ÙˆØª Ø§Ù„Ø®ØµÙ… ÙˆØ§Ù„ØªÙˆØµÙŠÙ„ Ø§Ù„Ù…Ø¬Ø§Ù†ÙŠ Ù…Ø¹ ØªØªØ¨Ø¹ Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… ÙˆØ§Ù„ØµÙ„Ø§Ø­ÙŠØ©.
                </div>
                
                <div class="bg-white p-3 rounded shadow-sm mb-4">
                  <div class="d-flex flex-wrap justify-content-between align-items-center mb-3 gap-2">
                    <div class="d-flex flex-column flex-md-row gap-2">
                      <input type="text" class="form-control form-control-sm" id="vipCardSearchInput" placeholder="Ø¨Ø­Ø« Ø¹Ù† ÙƒØ§Ø±Øª Ø£Ùˆ Ù…Ø§Ù„Ùƒ..." style="min-width: 200px;" oninput="filterVipCards()">
                      <select class="form-select form-select-sm" id="vipCardTypeFilter" style="min-width: 120px;" onchange="filterVipCards()">
                        <option value="">ÙƒÙ„ Ø§Ù„Ø£Ù†ÙˆØ§Ø¹</option>
                        <option value="Ø®ØµÙ… ÙÙ†ÙŠ 15%">Ø®ØµÙ… ÙÙ†ÙŠ 15%</option>
                        <option value="Ø®ØµÙ… ÙÙ†ÙŠ 25%">Ø®ØµÙ… ÙÙ†ÙŠ 25%</option>
                        <option value="ØªÙˆØµÙŠÙ„ Ù…Ø¬Ø§Ù†ÙŠ">ØªÙˆØµÙŠÙ„ Ù…Ø¬Ø§Ù†ÙŠ</option>
                      </select>
                      <select class="form-select form-select-sm" id="vipCardStatusFilter" style="min-width: 120px;" onchange="filterVipCards()">
                        <option value="">ÙƒÙ„ Ø§Ù„Ø­Ø§Ù„Ø§Øª</option>
                        <option value="Ù†Ø´Ø·">Ù†Ø´Ø·</option>
                        <option value="Ù…Ù†ØªÙ‡ÙŠ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ©">Ù…Ù†ØªÙ‡ÙŠ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ©</option>
                        <option value="Ù…Ø³ØªÙ†ÙØ°">Ù…Ø³ØªÙ†ÙØ°</option>
                      </select>
                    </div>
                    <div class="d-flex flex-column flex-md-row gap-2">
                      <button class="btn btn-sm btn-success" onclick="exportVipCardsExcel()"><i class="bi bi-file-earmark-excel"></i> ØªØµØ¯ÙŠØ± Excel</button>
                      <button class="btn btn-sm btn-primary" onclick="showAddVipCardModal()"><i class="bi bi-plus-lg"></i> Ø¥Ø¶Ø§ÙØ© ÙƒØ§Ø±Øª Ø¬Ø¯ÙŠØ¯</button>
                    </div>
                  </div>
                  <div class="table-responsive">
                    <table class="table align-middle" id="vipCardsTable">
                      <thead>
                        <tr>
                          <th>Ø±Ù‚Ù… Ø§Ù„ÙƒØ§Ø±Øª</th>
                          <th>Ø§Ø³Ù… Ø§Ù„Ù…Ø§Ù„Ùƒ</th>
                          <th>Ù†ÙˆØ¹ Ø§Ù„ÙƒØ§Ø±Øª</th>
                          <th>Ø¹Ø¯Ø¯ Ù…Ø±Ø§Øª Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…</th>
                          <th>Ø§Ù„Ù…Ø±Ø§Øª Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ©</th>
                          <th>ØªØ§Ø±ÙŠØ® Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ©</th>
                          <th>Ø§Ù„Ø­Ø§Ù„Ø©</th>
                          <th>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
                        </tr>
                      </thead>
                      <tbody id="vipCardsTableBody">
                        <!-- ÙƒØ±ÙˆØª VIP ØªÙØ¨Ù†Ù‰ Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ§Ù‹ Ù…Ù† localStorage -->
                      </tbody>
                    </table>
                  </div>
                </div>
                
                <!-- Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª ÙƒØ±ÙˆØª VIP -->
                <div class="row g-3 mb-4">
                  <div class="col-md-3">
                    <div class="card text-center">
                      <div class="card-body">
                        <h3 class="fw-bold text-primary" id="totalVipCardsCount">0</h3>
                        <p class="mb-0">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ÙƒØ±ÙˆØª</p>
                      </div>
                    </div>
                  </div>
                  <div class="col-md-3">
                    <div class="card text-center">
                      <div class="card-body">
                        <h3 class="fw-bold text-success" id="activeVipCardsCount">0</h3>
                        <p class="mb-0">ÙƒØ±ÙˆØª Ù†Ø´Ø·Ø©</p>
                      </div>
                    </div>
                  </div>
                  <div class="col-md-3">
                    <div class="card text-center">
                      <div class="card-body">
                        <h3 class="fw-bold text-warning" id="expiredVipCardsCount">0</h3>
                        <p class="mb-0">Ù…Ù†ØªÙ‡ÙŠØ© Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ©</p>
                      </div>
                    </div>
                  </div>
                  <div class="col-md-3">
                    <div class="card text-center">
                      <div class="card-body">
                        <h3 class="fw-bold text-danger" id="exhaustedVipCardsCount">0</h3>
                        <p class="mb-0">Ù…Ø³ØªÙ†ÙØ°Ø©</p>
                      </div>
                    </div>
                  </div>
                </div>
                
                <!-- Ø§Ø³ØªØ®Ø¯Ø§Ù… ÙƒØ§Ø±Øª VIP -->
                <div class="card shadow-sm">
                  <div class="card-header bg-purple-medium text-white">
                    <h5 class="mb-0">Ø§Ø³ØªØ®Ø¯Ø§Ù… ÙƒØ§Ø±Øª VIP</h5>
                  </div>
                  <div class="card-body">
                    <div class="row">
                      <div class="col-md-6">
                        <div class="mb-3">
                          <label class="form-label">Ø±Ù‚Ù… Ø§Ù„ÙƒØ§Ø±Øª (6 Ø£Ø±Ù‚Ø§Ù…)</label>
                          <input type="text" class="form-control" id="useVipCardInput" placeholder="Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… Ø§Ù„ÙƒØ§Ø±Øª" maxlength="6" oninput="this.value = this.value.replace(/[^0-9]/g, '')">
                        </div>
                        <button class="btn btn-primary" onclick="useVipCard()">
                          <i class="bi bi-check-circle"></i> Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„ÙƒØ§Ø±Øª
                        </button>
                      </div>
                      <div class="col-md-6">
                        <div id="vipCardUsageResult" class="alert" style="display: none;">
                          <!-- Ù†ØªÙŠØ¬Ø© Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„ÙƒØ§Ø±Øª -->
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        


      </div>
    </div>
  </div>
  
  <!-- Modal Ù„Ø¥Ø¶Ø§ÙØ© Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯ -->
  <div class="modal fade" id="addOrderModal" tabindex="-1" aria-labelledby="addOrderModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <form id="addOrderForm" onsubmit="addOrder(event)">
          <div class="modal-header">
            <h5 class="modal-title" id="addOrderModalLabel">Ø¥Ø¶Ø§ÙØ© Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Ø¥ØºÙ„Ø§Ù‚"></button>
          </div>
          <div class="modal-body">
            <div class="mb-3">
              <label class="form-label">Ø±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨</label>
              <input type="text" class="form-control" id="orderIdInput" required readonly>
            </div>
            <div class="mb-3">
              <label class="form-label">Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„</label>
              <input type="text" class="form-control" id="orderCustomerInput" required>
            </div>
            <div class="mb-3">
              <label class="form-label">Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ</label>
              <input type="text" class="form-control" id="orderPhoneInput" required>
            </div>
            <div class="mb-3">
              <label class="form-label">Ø§Ù„Ø¹Ù†ÙˆØ§Ù†</label>
              <input type="text" class="form-control" id="orderAddressInput" required>
            </div>
            <div class="mb-3">
              <label class="form-label">Ù†ÙˆØ¹ Ø§Ù„Ø®Ø¯Ù…Ø©</label>
              <select class="form-select" id="orderServiceTypeInput" required onchange="updateOrderTechniciansDropdown()">
                <option value="">Ø§Ø®ØªØ± Ù†ÙˆØ¹ Ø§Ù„Ø®Ø¯Ù…Ø©</option>
              </select>
            </div>
            <div class="mb-3">
              <label class="form-label">Ø§Ù„ÙÙ†ÙŠ/Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨</label>
              <select class="form-select" id="orderAssignedInput" required></select>
            </div>
            <div class="mb-3">
              <label class="form-label">Ø§Ù„Ø¹Ø¯Ø¯</label>
              <select class="form-select" id="orderCountInput" required>
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5</option>
                <option value="6">6</option>
                <option value="7">7</option>
                <option value="8">8</option>
                <option value="9">9</option>
                <option value="10">10</option>
              </select>
            </div>
            <div class="mb-3">
              <label class="form-label">Ø§Ù„Ù…Ø¨Ù„Øº</label>
              <input type="number" class="form-control" id="orderAmountInput" min="0" required>
            </div>
            <div class="mb-3">
              <label class="form-label">Ø§Ù„Ø­Ø§Ù„Ø©</label>
              <select class="form-select" id="orderStatusInput">
                <option selected>Ø¬Ø¯ÙŠØ¯</option>
                <option>Ù‚ÙŠØ¯ Ø§Ù„ØªÙ†ÙÙŠØ°</option>
                <option>Ù…Ø¤Ø¬Ù„</option>
                <option>ØªÙ… Ø§Ù„ØªÙˆØµÙŠÙ„</option>
                <option>Ù…Ù„ØºÙŠ</option>
              </select>
            </div>
            <div class="mb-3">
              <label class="form-label">Ù…Ù„Ø§Ø­Ø¸Ø§Øª</label>
              <textarea class="form-control" id="orderNotesInput" rows="2"></textarea>
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Ø¥Ù„ØºØ§Ø¡</button>
            <button type="submit" class="btn btn-primary">Ø­ÙØ¸</button>
          </div>
        </form>
      </div>
    </div>
  </div>
  
  <!-- Modal ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø·Ù„Ø¨ -->
  <div class="modal fade" id="orderDetailsModal" tabindex="-1" aria-labelledby="orderDetailsModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="orderDetailsModalLabel">ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø·Ù„Ø¨</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Ø¥ØºÙ„Ø§Ù‚"></button>
        </div>
        <div class="modal-body" id="orderDetailsBody">
          <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¡ Ø§Ù„ØªÙØ§ØµÙŠÙ„ Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ§Ù‹ -->
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Ø¥ØºÙ„Ø§Ù‚</button>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Modal Ù„Ø¥Ø¶Ø§ÙØ© Ù…Ø·Ø¹Ù… Ø¬Ø¯ÙŠØ¯ -->
  <div class="modal fade" id="addRestaurantModal" tabindex="-1" aria-labelledby="addRestaurantModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <form id="addRestaurantForm" onsubmit="addRestaurant(event)">
          <div class="modal-header">
            <h5 class="modal-title" id="addRestaurantModalLabel">Ø¥Ø¶Ø§ÙØ© Ù…Ø·Ø¹Ù… Ø¬Ø¯ÙŠØ¯</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Ø¥ØºÙ„Ø§Ù‚"></button>
          </div>
          <div class="modal-body">
            <div class="mb-3">
              <label class="form-label">Ø§Ø³Ù… Ø§Ù„Ù…Ø·Ø¹Ù…</label>
              <input type="text" class="form-control" id="restaurantNameInput" required>
            </div>
            <div class="mb-3">
              <label class="form-label">Ø§Ù„Ø¹Ù†ÙˆØ§Ù†</label>
              <input type="text" class="form-control" id="restaurantAddressInput" required>
            </div>
            <div class="mb-3">
              <label class="form-label">Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ</label>
              <input type="text" class="form-control" id="restaurantPhoneInput" required>
            </div>
            <div class="mb-3">
              <label class="form-label">Ù†ÙˆØ¹ Ø§Ù„Ù…Ø·Ø¹Ù…</label>
              <select class="form-select" id="restaurantTypeInput" required>
                <option value="Ù…Ø·Ø¹Ù… Ø´Ø±Ù‚ÙŠ">Ù…Ø·Ø¹Ù… Ø´Ø±Ù‚ÙŠ</option>
                <option value="Ù…Ø·Ø¹Ù… ØºØ±Ø¨ÙŠ">Ù…Ø·Ø¹Ù… ØºØ±Ø¨ÙŠ</option>
                <option value="ÙˆØ¬Ø¨Ø§Øª Ø³Ø±ÙŠØ¹Ø©">ÙˆØ¬Ø¨Ø§Øª Ø³Ø±ÙŠØ¹Ø©</option>
                <option value="Ø­Ù„ÙˆÙŠØ§Øª">Ø­Ù„ÙˆÙŠØ§Øª</option>
                <option value="Ù…Ø´Ø±ÙˆØ¨Ø§Øª">Ù…Ø´Ø±ÙˆØ¨Ø§Øª</option>
              </select>
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Ø¥Ù„ØºØ§Ø¡</button>
            <button type="submit" class="btn btn-primary">Ø­ÙØ¸</button>
          </div>
        </form>
      </div>
    </div>
  </div>
  
  <!-- Modal Ù„Ø¥Ø¶Ø§ÙØ© ØµÙ†Ù Ø¬Ø¯ÙŠØ¯ -->
  <div class="modal fade" id="addItemModal" tabindex="-1" aria-labelledby="addItemModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <form id="addItemForm" onsubmit="addItem(event)">
          <div class="modal-header">
            <h5 class="modal-title" id="addItemModalLabel">Ø¥Ø¶Ø§ÙØ© ØµÙ†Ù Ø¬Ø¯ÙŠØ¯</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Ø¥ØºÙ„Ø§Ù‚"></button>
          </div>
          <div class="modal-body">
            <div class="mb-3">
              <label class="form-label">Ø§Ø³Ù… Ø§Ù„ØµÙ†Ù</label>
              <input type="text" class="form-control" id="itemNameInput" required>
            </div>
            <div class="mb-3">
              <label class="form-label">Ø§Ù„ÙˆØµÙ</label>
              <textarea class="form-control" id="itemDescriptionInput" rows="2"></textarea>
            </div>
            <div class="mb-3">
              <label class="form-label">Ø§Ù„Ø³Ø¹Ø±</label>
              <input type="number" class="form-control" id="itemPriceInput" min="0" required>
            </div>
            <div class="mb-3">
              <label class="form-label">Ø§Ù„Ù…Ø·Ø¹Ù…</label>
              <select class="form-select" id="itemRestaurantInput" required>
                <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¡ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ§Ù‹ -->
              </select>
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Ø¥Ù„ØºØ§Ø¡</button>
            <button type="submit" class="btn btn-primary">Ø­ÙØ¸</button>
          </div>
        </form>
      </div>
    </div>
  </div>
  
  <!-- Modal Ù„Ø¥Ø¶Ø§ÙØ© ÙÙ†ÙŠ Ø¬Ø¯ÙŠØ¯ -->
  <div class="modal fade" id="addTechnicianModal" tabindex="-1" aria-labelledby="addTechnicianModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <form id="addTechnicianForm" onsubmit="addTechnician(event)">
          <div class="modal-header">
            <h5 class="modal-title" id="addTechnicianModalLabel">Ø¥Ø¶Ø§ÙØ© ÙÙ†ÙŠ Ø¬Ø¯ÙŠØ¯</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Ø¥ØºÙ„Ø§Ù‚"></button>
          </div>
          <div class="modal-body">
            <div class="mb-3">
              <label class="form-label">Ø§Ø³Ù… Ø§Ù„ÙÙ†ÙŠ</label>
              <input type="text" class="form-control" id="technicianNameInput" required>
            </div>
            <div class="mb-3">
              <label class="form-label">Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ</label>
              <input type="text" class="form-control" id="technicianPhoneInput" required>
            </div>
            <div class="mb-3">
              <label class="form-label">Ø§Ù„ØªØ®ØµØµ</label>
              <select class="form-select" id="technicianSpecialtyInput" required>
                <option value="ØªÙƒÙŠÙŠÙ">ØªÙƒÙŠÙŠÙ</option>
                <option value="Ø³Ø¨Ø§ÙƒØ©">Ø³Ø¨Ø§ÙƒØ©</option>
                <option value="Ù†Ø¬Ø§Ø±Ø©">Ù†Ø¬Ø§Ø±Ø©</option>
                <option value="ÙƒÙ‡Ø±Ø¨Ø§Ø¡">ÙƒÙ‡Ø±Ø¨Ø§Ø¡</option>
                <option value="Ø§Ø¯ÙˆØ§Øª Ù…Ù†Ø²Ù„ÙŠØ©">Ø§Ø¯ÙˆØ§Øª Ù…Ù†Ø²Ù„ÙŠØ©</option>
                <option value="Ø¯Ø´">Ø¯Ø´</option>
                <option value="Ø­Ø¯Ø§Ø¯">Ø­Ø¯Ø§Ø¯</option>
                <option value="Ø²Ø¬Ø§Ø¬">Ø²Ø¬Ø§Ø¬</option>
                <option value="Ù†Ù‚Ø§Ø´">Ù†Ù‚Ø§Ø´</option>
                <option value="Ø³ÙŠØ±Ø§Ù…ÙŠÙƒ">Ø³ÙŠØ±Ø§Ù…ÙŠÙƒ</option>
              </select>
            </div>
            <div class="mb-3">
              <label class="form-label">Ø§Ù„ØªØ±ØªÙŠØ¨</label>
              <input type="number" class="form-control" id="technicianOrderInput" min="1" value="1">
            </div>
            <div class="mb-3">
              <label class="form-label">Ù…Ù„Ø§Ø­Ø¸Ø§Øª</label>
              <textarea class="form-control" id="technicianNotesInput" rows="3"></textarea>
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Ø¥Ù„ØºØ§Ø¡</button>
            <button type="submit" class="btn btn-primary">Ø­ÙØ¸</button>
          </div>
        </form>
      </div>
    </div>
  </div>
  
  <!-- Modal Ù„ØªØ¹Ø¯ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙÙ†ÙŠ -->
  <div class="modal fade" id="editTechnicianModal" tabindex="-1" aria-labelledby="editTechnicianModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <form id="editTechnicianForm" onsubmit="updateTechnician(event)">
          <div class="modal-header">
            <h5 class="modal-title" id="editTechnicianModalLabel">ØªØ¹Ø¯ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙÙ†ÙŠ</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Ø¥ØºÙ„Ø§Ù‚"></button>
          </div>
          <div class="modal-body">
            <input type="hidden" id="editTechnicianId">
            <div class="mb-3">
              <label class="form-label">Ø§Ø³Ù… Ø§Ù„ÙÙ†ÙŠ</label>
              <input type="text" class="form-control" id="editTechnicianNameInput" required>
            </div>
            <div class="mb-3">
              <label class="form-label">Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ</label>
              <input type="text" class="form-control" id="editTechnicianPhoneInput" required>
            </div>
            <div class="mb-3">
              <label class="form-label">Ø§Ù„ØªØ®ØµØµ</label>
              <select class="form-select" id="editTechnicianSpecialtyInput" required>
                <option value="ØªÙƒÙŠÙŠÙ">ØªÙƒÙŠÙŠÙ</option>
                <option value="Ø³Ø¨Ø§ÙƒØ©">Ø³Ø¨Ø§ÙƒØ©</option>
                <option value="Ù†Ø¬Ø§Ø±Ø©">Ù†Ø¬Ø§Ø±Ø©</option>
                <option value="ÙƒÙ‡Ø±Ø¨Ø§Ø¡">ÙƒÙ‡Ø±Ø¨Ø§Ø¡</option>
                <option value="Ø§Ø¯ÙˆØ§Øª Ù…Ù†Ø²Ù„ÙŠØ©">Ø§Ø¯ÙˆØ§Øª Ù…Ù†Ø²Ù„ÙŠØ©</option>
                <option value="Ø¯Ø´">Ø¯Ø´</option>
                <option value="Ø­Ø¯Ø§Ø¯">Ø­Ø¯Ø§Ø¯</option>
                <option value="Ø²Ø¬Ø§Ø¬">Ø²Ø¬Ø§Ø¬</option>
                <option value="Ù†Ù‚Ø§Ø´">Ù†Ù‚Ø§Ø´</option>
                <option value="Ø³ÙŠØ±Ø§Ù…ÙŠÙƒ">Ø³ÙŠØ±Ø§Ù…ÙŠÙƒ</option>
              </select>
            </div>
            <div class="mb-3">
              <label class="form-label">Ø§Ù„ØªØ±ØªÙŠØ¨</label>
              <input type="number" class="form-control" id="editTechnicianOrderInput" min="1">
            </div>
            <div class="mb-3">
              <label class="form-label">Ù…Ù„Ø§Ø­Ø¸Ø§Øª</label>
              <textarea class="form-control" id="editTechnicianNotesInput" rows="3"></textarea>
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Ø¥Ù„ØºØ§Ø¡</button>
            <button type="submit" class="btn btn-primary">Ø­ÙØ¸ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª</button>
          </div>
        </form>
      </div>
    </div>
  </div>
  
  <!-- Modal Ù„Ø¥Ø¶Ø§ÙØ© Ù…Ù†Ø¯ÙˆØ¨ Ø¬Ø¯ÙŠØ¯ -->
  <div class="modal fade" id="addDeliverymanModal" tabindex="-1" aria-labelledby="addDeliverymanModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <form id="addDeliverymanForm" onsubmit="addDeliveryman(event)">
          <div class="modal-header">
            <h5 class="modal-title" id="addDeliverymanModalLabel">Ø¥Ø¶Ø§ÙØ© Ù…Ù†Ø¯ÙˆØ¨ Ø¬Ø¯ÙŠØ¯</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Ø¥ØºÙ„Ø§Ù‚"></button>
          </div>
          <div class="modal-body">
            <div class="mb-3">
              <label class="form-label">Ø§Ø³Ù… Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨</label>
              <input type="text" class="form-control" id="deliverymanNameInput" required>
            </div>
            <div class="mb-3">
              <label class="form-label">Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ</label>
              <input type="text" class="form-control" id="deliverymanPhoneInput" required>
            </div>
            <div class="mb-3">
              <label class="form-label">ÙˆØ³ÙŠÙ„Ø© Ø§Ù„Ù†Ù‚Ù„</label>
              <select class="form-select" id="deliverymanVehicleInput" required>
                <option value="Ø¯Ø±Ø§Ø¬Ø© Ù†Ø§Ø±ÙŠØ©">Ø¯Ø±Ø§Ø¬Ø© Ù†Ø§Ø±ÙŠØ©</option>
                <option value="Ø³ÙŠØ§Ø±Ø©">Ø³ÙŠØ§Ø±Ø©</option>
                <option value="Ø¯Ø±Ø§Ø¬Ø© Ù‡ÙˆØ§Ø¦ÙŠØ©">Ø¯Ø±Ø§Ø¬Ø© Ù‡ÙˆØ§Ø¦ÙŠØ©</option>
              </select>
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Ø¥Ù„ØºØ§Ø¡</button>
            <button type="submit" class="btn btn-primary">Ø­ÙØ¸</button>
          </div>
        </form>
      </div>
    </div>
  </div>
  
  <!-- Modal Ù„Ø¥Ø¶Ø§ÙØ© Ø¹Ù…ÙŠÙ„ Ø¬Ø¯ÙŠØ¯ -->
  <div class="modal fade" id="addCustomerModal" tabindex="-1" aria-labelledby="addCustomerModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <form id="addCustomerForm" onsubmit="addCustomer(event)">
          <div class="modal-header">
            <h5 class="modal-title" id="addCustomerModalLabel">Ø¥Ø¶Ø§ÙØ© Ø¹Ù…ÙŠÙ„ Ø¬Ø¯ÙŠØ¯</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Ø¥ØºÙ„Ø§Ù‚"></button>
          </div>
          <div class="modal-body">
            <div class="mb-3">
              <label class="form-label">Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„</label>
              <input type="text" class="form-control" id="customerNameInput" required>
            </div>
            <div class="mb-3">
              <label class="form-label">Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ</label>
              <input type="text" class="form-control" id="customerPhoneInput" required>
            </div>
            <div class="mb-3">
              <label class="form-label">Ø§Ù„Ø¹Ù†ÙˆØ§Ù†</label>
              <input type="text" class="form-control" id="customerAddressInput" required>
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Ø¥Ù„ØºØ§Ø¡</button>
            <button type="submit" class="btn btn-primary">Ø­ÙØ¸</button>
          </div>
        </form>
      </div>
    </div>
  </div>
  
  <!-- Modal Ù„Ø¥Ø¶Ø§ÙØ© Ø´ÙƒÙˆÙ‰ Ø¬Ø¯ÙŠØ¯Ø© -->
  <div class="modal fade" id="addComplaintModal" tabindex="-1" aria-labelledby="addComplaintModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <form id="addComplaintForm" onsubmit="addComplaint(event)">
          <div class="modal-header">
            <h5 class="modal-title" id="addComplaintModalLabel">Ø¥Ø¶Ø§ÙØ© Ø´ÙƒÙˆÙ‰ Ø¬Ø¯ÙŠØ¯Ø©</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Ø¥ØºÙ„Ø§Ù‚"></button>
          </div>
          <div class="modal-body">
            <div class="mb-3">
              <label class="form-label">Ø±Ù‚Ù… Ø§Ù„Ø´ÙƒÙˆÙ‰</label>
              <input type="text" class="form-control" id="complaintIdInput" required readonly>
            </div>
            <div class="mb-3">
              <label class="form-label">Ø±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨ Ø§Ù„Ù…ØªØ¹Ù„Ù‚ Ø¨Ø§Ù„Ø´ÙƒÙˆÙ‰</label>
              <select class="form-select" id="complaintOrderInput" required onchange="loadOrderCustomerData()">
                <option value="">Ø§Ø®ØªØ± Ø±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨</option>
                <!-- Ø³ÙŠØªÙ… ØªØ¹Ø¨Ø¦ØªÙ‡Ø§ Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠÙ‹Ø§ -->
              </select>
            </div>
            <div class="mb-3">
              <label class="form-label">Ø§Ù„Ø¹Ù…ÙŠÙ„</label>
              <input type="text" class="form-control" id="complaintCustomerInput" readonly>
            </div>
            <div class="mb-3">
              <label class="form-label">Ø±Ù‚Ù… Ù‡Ø§ØªÙ Ø§Ù„Ø¹Ù…ÙŠÙ„</label>
              <input type="text" class="form-control" id="complaintCustomerPhoneInput" readonly>
            </div>
            <div class="mb-3">
              <label class="form-label">Ù†ÙˆØ¹ Ø§Ù„Ø´ÙƒÙˆÙ‰</label>
              <select class="form-select" id="complaintTypeInput" required>
                <option value="">Ø§Ø®ØªØ± Ù†ÙˆØ¹ Ø§Ù„Ø´ÙƒÙˆÙ‰</option>
                <option value="Ø¬ÙˆØ¯Ø© Ø§Ù„Ø®Ø¯Ù…Ø©">Ø¬ÙˆØ¯Ø© Ø§Ù„Ø®Ø¯Ù…Ø©</option>
                <option value="Ø³Ù„ÙˆÙƒ Ø§Ù„ÙÙ†ÙŠ">Ø³Ù„ÙˆÙƒ Ø§Ù„ÙÙ†ÙŠ</option>
                <option value="ØªØ£Ø®ÙŠØ±">ØªØ£Ø®ÙŠØ±</option>
                <option value="Ø±Ø³ÙˆÙ… Ø¥Ø¶Ø§ÙÙŠØ©">Ø±Ø³ÙˆÙ… Ø¥Ø¶Ø§ÙÙŠØ©</option>
                <option value="Ø£Ø®Ø±Ù‰">Ø£Ø®Ø±Ù‰</option>
              </select>
            </div>
            <div class="mb-3">
              <label class="form-label">ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø´ÙƒÙˆÙ‰</label>
              <textarea class="form-control" id="complaintDetailsInput" rows="3" required></textarea>
            </div>
            <div class="mb-3">
              <label class="form-label">Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ©</label>
              <select class="form-select" id="complaintPriorityInput">
                <option value="Ø¹Ø§Ø¯ÙŠØ©">Ø¹Ø§Ø¯ÙŠØ©</option>
                <option value="Ù…ØªÙˆØ³Ø·Ø©">Ù…ØªÙˆØ³Ø·Ø©</option>
                <option value="Ø¹Ø§Ù„ÙŠØ©">Ø¹Ø§Ù„ÙŠØ©</option>
              </select>
            </div>
            <div class="mb-3">
              <label class="form-label">Ø§Ù„Ø­Ø§Ù„Ø©</label>
              <select class="form-select" id="complaintStatusInput">
                <option value="Ø¬Ø¯ÙŠØ¯Ø©">Ø¬Ø¯ÙŠØ¯Ø©</option>
                <option value="Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©">Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©</option>
                <option value="ØªÙ… Ø§Ù„Ø­Ù„">ØªÙ… Ø§Ù„Ø­Ù„</option>
                <option value="Ù…Ø±ÙÙˆØ¶Ø©">Ù…Ø±ÙÙˆØ¶Ø©</option>
              </select>
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Ø¥Ù„ØºØ§Ø¡</button>
            <button type="submit" class="btn btn-primary">Ø­ÙØ¸</button>
          </div>
        </form>
      </div>
    </div>
  </div>
  
  <!-- Modal ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø´ÙƒÙˆÙ‰ -->
  <div class="modal fade" id="complaintDetailsModal" tabindex="-1" aria-labelledby="complaintDetailsModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="complaintDetailsModalLabel">ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø´ÙƒÙˆÙ‰</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Ø¥ØºÙ„Ø§Ù‚"></button>
        </div>
        <div class="modal-body" id="complaintDetailsBody">
          <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¡ Ø§Ù„ØªÙØ§ØµÙŠÙ„ Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ§Ù‹ -->
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Ø¥ØºÙ„Ø§Ù‚</button>
          <button type="button" class="btn btn-primary" id="updateComplaintStatusBtn" onclick="showUpdateComplaintModal()">ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø­Ø§Ù„Ø©</button>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Modal ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ø´ÙƒÙˆÙ‰ -->
  <div class="modal fade" id="updateComplaintStatusModal" tabindex="-1" aria-labelledby="updateComplaintStatusModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <form id="updateComplaintStatusForm" onsubmit="updateComplaintStatus(event)">
          <div class="modal-header">
            <h5 class="modal-title" id="updateComplaintStatusModalLabel">ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ø´ÙƒÙˆÙ‰</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Ø¥ØºÙ„Ø§Ù‚"></button>
          </div>
          <div class="modal-body">
            <input type="hidden" id="updateComplaintId">
            <div class="mb-3">
              <label class="form-label">Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©</label>
              <select class="form-select" id="updateComplaintStatusInput" required>
                <option value="Ø¬Ø¯ÙŠØ¯Ø©">Ø¬Ø¯ÙŠØ¯Ø©</option>
                <option value="Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©">Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©</option>
                <option value="ØªÙ… Ø§Ù„Ø­Ù„">ØªÙ… Ø§Ù„Ø­Ù„</option>
                <option value="Ù…Ø±ÙÙˆØ¶Ø©">Ù…Ø±ÙÙˆØ¶Ø©</option>
              </select>
            </div>
            <div class="mb-3">
              <label class="form-label">Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø§Ù„Ø­Ù„</label>
              <textarea class="form-control" id="complaintResolutionNotesInput" rows="3"></textarea>
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Ø¥Ù„ØºØ§Ø¡</button>
            <button type="submit" class="btn btn-primary">Ø­ÙØ¸ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª</button>
          </div>
        </form>
      </div>
    </div>
  </div>
  
  <!-- Modal Ù„Ø¥Ø¶Ø§ÙØ© ÙƒØ§Ø±Øª VIP Ø¬Ø¯ÙŠØ¯ -->
  <div class="modal fade" id="addVipCardModal" tabindex="-1" aria-labelledby="addVipCardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <form id="addVipCardForm" onsubmit="addVipCard(event)">
          <div class="modal-header">
            <h5 class="modal-title" id="addVipCardModalLabel">Ø¥Ø¶Ø§ÙØ© ÙƒØ§Ø±Øª VIP Ø¬Ø¯ÙŠØ¯</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Ø¥ØºÙ„Ø§Ù‚"></button>
          </div>
          <div class="modal-body">
            <div class="mb-3">
              <label class="form-label">Ø±Ù‚Ù… Ø§Ù„ÙƒØ§Ø±Øª (6 Ø£Ø±Ù‚Ø§Ù…)</label>
              <input type="text" class="form-control" id="vipCardNumberInput" required maxlength="6" placeholder="Ù…Ø«Ø§Ù„: 123456" oninput="this.value = this.value.replace(/[^0-9]/g, '')">
              <div class="form-text">ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø§Ù„Ø±Ù‚Ù… Ù…ÙƒÙˆÙ† Ù…Ù† 6 Ø£Ø±Ù‚Ø§Ù… ÙÙ‚Ø·</div>
            </div>
            <div class="mb-3">
              <label class="form-label">Ø§Ø³Ù… Ù…Ø§Ù„Ùƒ Ø§Ù„ÙƒØ§Ø±Øª</label>
              <input type="text" class="form-control" id="vipCardOwnerInput" required>
            </div>
            <div class="mb-3">
              <label class="form-label">Ù†ÙˆØ¹ Ø§Ù„ÙƒØ§Ø±Øª</label>
              <select class="form-select" id="vipCardTypeInput" required>
                <option value="">Ø§Ø®ØªØ± Ù†ÙˆØ¹ Ø§Ù„ÙƒØ§Ø±Øª</option>
                <option value="Ø®ØµÙ… ÙÙ†ÙŠ 15%">Ø®ØµÙ… ÙÙ†ÙŠ (15% Ø®ØµÙ…)</option>
                <option value="Ø®ØµÙ… ÙÙ†ÙŠ 25%">Ø®ØµÙ… ÙÙ†ÙŠ (25% Ø®ØµÙ…)</option>
                <option value="ØªÙˆØµÙŠÙ„ Ù…Ø¬Ø§Ù†ÙŠ">ØªÙˆØµÙŠÙ„ Ù…Ø¬Ø§Ù†ÙŠ</option>
              </select>
            </div>
            <div class="mb-3">
              <label class="form-label">Ø¹Ø¯Ø¯ Ù…Ø±Ø§Øª Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…</label>
              <select class="form-select" id="vipCardUsageLimitInput" required>
                <option value="1">1 Ù…Ø±Ø©</option>
                <option value="2">2 Ù…Ø±Ø§Øª</option>
                <option value="3">3 Ù…Ø±Ø§Øª</option>
                <option value="4">4 Ù…Ø±Ø§Øª</option>
                <option value="5">5 Ù…Ø±Ø§Øª</option>
                <option value="6">6 Ù…Ø±Ø§Øª</option>
                <option value="7">7 Ù…Ø±Ø§Øª</option>
                <option value="8">8 Ù…Ø±Ø§Øª</option>
                <option value="9">9 Ù…Ø±Ø§Øª</option>
                <option value="10" selected>10 Ù…Ø±Ø§Øª</option>
              </select>
            </div>
            <div class="mb-3">
              <label class="form-label">ØªØ§Ø±ÙŠØ® Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ©</label>
              <input type="date" class="form-control" id="vipCardExpiryInput" required>
            </div>
            <div class="mb-3">
              <label class="form-label">Ù…Ù„Ø§Ø­Ø¸Ø§Øª</label>
              <textarea class="form-control" id="vipCardNotesInput" rows="3" placeholder="Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ© Ø¹Ù† Ø§Ù„ÙƒØ§Ø±Øª"></textarea>
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Ø¥Ù„ØºØ§Ø¡</button>
            <button type="submit" class="btn btn-primary">Ø­ÙØ¸</button>
          </div>
        </form>
      </div>
    </div>
  </div>
  
  <!-- Modal Ù„ØªØ¹Ø¯ÙŠÙ„ ÙƒØ§Ø±Øª VIP -->
  <div class="modal fade" id="editVipCardModal" tabindex="-1" aria-labelledby="editVipCardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <form id="editVipCardForm" onsubmit="updateVipCard(event)">
          <div class="modal-header">
            <h5 class="modal-title" id="editVipCardModalLabel">ØªØ¹Ø¯ÙŠÙ„ ÙƒØ§Ø±Øª VIP</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Ø¥ØºÙ„Ø§Ù‚"></button>
          </div>
          <div class="modal-body">
            <input type="hidden" id="editVipCardId">
            <div class="mb-3">
              <label class="form-label">Ø±Ù‚Ù… Ø§Ù„ÙƒØ§Ø±Øª</label>
              <input type="text" class="form-control" id="editVipCardNumberInput" required readonly>
            </div>
            <div class="mb-3">
              <label class="form-label">Ø§Ø³Ù… Ù…Ø§Ù„Ùƒ Ø§Ù„ÙƒØ§Ø±Øª</label>
              <input type="text" class="form-control" id="editVipCardOwnerInput" required>
            </div>
            <div class="mb-3">
              <label class="form-label">Ù†ÙˆØ¹ Ø§Ù„ÙƒØ§Ø±Øª</label>
              <select class="form-select" id="editVipCardTypeInput" required>
                <option value="Ø®ØµÙ… ÙÙ†ÙŠ 15%">Ø®ØµÙ… ÙÙ†ÙŠ (15% Ø®ØµÙ…)</option>
                <option value="Ø®ØµÙ… ÙÙ†ÙŠ 25%">Ø®ØµÙ… ÙÙ†ÙŠ (25% Ø®ØµÙ…)</option>
                <option value="ØªÙˆØµÙŠÙ„ Ù…Ø¬Ø§Ù†ÙŠ">ØªÙˆØµÙŠÙ„ Ù…Ø¬Ø§Ù†ÙŠ</option>
              </select>
            </div>
            <div class="mb-3">
              <label class="form-label">Ø¹Ø¯Ø¯ Ù…Ø±Ø§Øª Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø­Ø§Ù„ÙŠ</label>
              <input type="number" class="form-control" id="editVipCardUsageCountInput" min="0" required>
            </div>
            <div class="mb-3">
              <label class="form-label">ØªØ§Ø±ÙŠØ® Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ©</label>
              <input type="date" class="form-control" id="editVipCardExpiryInput" required>
            </div>
            <div class="mb-3">
              <label class="form-label">Ù…Ù„Ø§Ø­Ø¸Ø§Øª</label>
              <textarea class="form-control" id="editVipCardNotesInput" rows="3"></textarea>
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Ø¥Ù„ØºØ§Ø¡</button>
            <button type="submit" class="btn btn-primary">Ø­ÙØ¸ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª</button>
          </div>
        </form>
      </div>
    </div>
  </div>
  
  <!-- Modal ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠÙ† -->
  <div class="modal fade" id="adminLoginModal" tabindex="-1" aria-labelledby="adminLoginModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header bg-primary text-white">
          <h5 class="modal-title" id="adminLoginModalLabel">
            <i class="bi bi-shield-lock"></i> ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„
          </h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Ø¥ØºÙ„Ø§Ù‚"></button>
        </div>
        <form id="adminLoginForm" onsubmit="adminLogin(event)">
          <div class="modal-body">
            <div class="alert alert-info">
              <i class="bi bi-info-circle"></i>
              <strong>Ù…Ù„Ø§Ø­Ø¸Ø©:</strong> Ø§Ù„Ø¬Ù„Ø³Ø© ØªÙ†ØªÙ‡ÙŠ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø¨Ø¹Ø¯ Ø¯Ù‚ÙŠÙ‚Ø© Ù…Ù† Ø¹Ø¯Ù… Ø§Ù„Ù†Ø´Ø§Ø·
            </div>
            
            <div class="alert alert-warning">
              <i class="bi bi-person-circle"></i>
              <strong>Ù…Ù„Ø§Ø­Ø¸Ø©:</strong> ÙŠØ±Ø¬Ù‰ Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø§Ù„Ù…Ø¯ÙŠØ± Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø¨ÙŠØ§Ù†Ø§Øª ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
            </div>
            
            <div class="mb-3">
              <label for="adminCodeInput" class="form-label">Ø±Ù‚Ù… Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„</label>
              <input type="text" class="form-control" id="adminCodeInput" required placeholder="Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„">
            </div>
            <div class="mb-3">
              <label for="adminPasswordInput" class="form-label">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label>
              <input type="password" class="form-control" id="adminPasswordInput" required placeholder="Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">
            </div>
            <div class="alert alert-danger d-none" id="adminLoginError">
              <i class="bi bi-exclamation-triangle"></i>
              Ø±Ù‚Ù… Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ Ø£Ùˆ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± ØµØ­ÙŠØ­Ø©
            </div>
          </div>
          <div class="modal-footer">
            <button type="submit" class="btn btn-primary">
              <i class="bi bi-box-arrow-in-right"></i> ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- Bootstrap Bundle with Popper -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    // Ù…ØªØºÙŠØ±Ø§Øª Ø¹Ø§Ù…Ø©
    let ordersChart;
    let currentChartType = 'line';
    
    // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
    document.addEventListener('DOMContentLoaded', function() {
      // ØªÙ‡ÙŠØ¦Ø© localStorage Ø¥Ø°Ø§ Ù„Ù… ØªÙƒÙ† Ù…ÙˆØ¬ÙˆØ¯Ø©
      if (!localStorage.getItem('orders')) {
        localStorage.setItem('orders', JSON.stringify([]));
      }
      if (!localStorage.getItem('restaurants')) {
        localStorage.setItem('restaurants', JSON.stringify([]));
      }
      if (!localStorage.getItem('items')) {
        localStorage.setItem('items', JSON.stringify([]));
      }
      if (!localStorage.getItem('technicians')) {
        localStorage.setItem('technicians', JSON.stringify([]));
      }
      if (!localStorage.getItem('deliverymen')) {
        localStorage.setItem('deliverymen', JSON.stringify([]));
      }
      if (!localStorage.getItem('customers')) {
        localStorage.setItem('customers', JSON.stringify([]));
      }
      
      // ØªÙ‡ÙŠØ¦Ø© Ø£Ø±Ø´ÙŠÙ Ø§Ù„Ø·Ù„Ø¨Ø§Øª
      initializeAllOrdersArchive();
      
      // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„
      checkAdminLogin();
      
      // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
      updateStats();
      
      // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø·Ù„Ø¨Ø§Øª
      loadOrders();
      loadOrdersPage();
      
      // ØªØ­Ù…ÙŠÙ„ Ù‚ÙˆØ§Ø¦Ù… Ø£ÙØ¶Ù„ Ø§Ù„ÙÙ†ÙŠÙŠÙ† ÙˆØ§Ù„Ù…Ù†Ø§Ø¯ÙŠØ¨ ÙˆØ§Ù„Ø¹Ù…Ù„Ø§Ø¡
      loadTopLists();
      
      // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ø±Ø³Ù… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠ
      initOrdersChart();
      
      // ØªØ­Ø¯ÙŠØ« Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø·Ø§Ø¹Ù… ÙÙŠ Ù†Ù…ÙˆØ°Ø¬ Ø¥Ø¶Ø§ÙØ© Ø§Ù„ØµÙ†Ù
      updateRestaurantsDropdown();
      
      // ØªØ­Ø¯ÙŠØ« Ù‚Ø§Ø¦Ù…Ø© Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ø®Ø¯Ù…Ø§Øª ÙÙŠ Ù†Ù…ÙˆØ°Ø¬ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø·Ù„Ø¨
      updateServiceTypesDropdown();
      
      // ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø§Øª Ø§Ù„Ø£Ø®Ø±Ù‰
      loadTechniciansPage();
      // loadRestaurantsPage(); // ØªÙ… Ø¥ÙŠÙ‚Ø§Ù ØªØ­Ù…ÙŠÙ„ ØµÙØ­Ø© Ø§Ù„Ù…Ø·Ø§Ø¹Ù…
      loadDeliverymenPage();
      loadCustomersPage();
    });
    
    // ØªØ¨Ø¯ÙŠÙ„ Ø­Ø§Ù„Ø© Ø§Ù„Ø³Ø§ÙŠØ¯Ø¨Ø§Ø± ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„ØµØºÙŠØ±Ø©
    function toggleSidebar() {
      document.getElementById('sidebar').classList.toggle('show');
    }
    
    // ØªØ¨Ø¯ÙŠÙ„ Ø¨ÙŠÙ† Ø§Ù„ØµÙØ­Ø§Øª
    function showPage(page) {
      // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„ÙƒÙ„Ø§Ø³ active Ù…Ù† Ø¬Ù…ÙŠØ¹ Ø±ÙˆØ§Ø¨Ø· Ø§Ù„ØªÙ†Ù‚Ù„
      document.querySelectorAll('.sidebar .nav-link').forEach(link => {
        link.classList.remove('active');
      });
      
      // Ø¥Ø¶Ø§ÙØ© Ø§Ù„ÙƒÙ„Ø§Ø³ active Ù„Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ù…Ø­Ø¯Ø¯
      document.getElementById(page + 'Nav').classList.add('active');
      
      // Ø¥Ø®ÙØ§Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„ØµÙØ­Ø§Øª
      document.querySelectorAll('.page-content').forEach(pageContent => {
        pageContent.classList.remove('active');
      });
      
      // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ù…Ø­Ø¯Ø¯Ø©
      document.getElementById(page + 'Page').classList.add('active');
      
      // ØªØ­Ø¯ÙŠØ« Ø¹Ù†ÙˆØ§Ù† Ø§Ù„ØµÙØ­Ø©
      let pageTitle = '';
      switch(page) {
        case 'dashboard': pageTitle = 'Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…'; break;
        case 'orders': pageTitle = 'Ø§Ù„Ø·Ù„Ø¨Ø§Øª'; break;
        case 'allOrders': pageTitle = 'ÙƒÙ„ Ø§Ù„Ø·Ù„Ø¨Ø§Øª'; loadAllOrdersPage(); break;
        case 'technicians': pageTitle = 'Ø§Ù„ÙÙ†ÙŠÙŠÙ†'; break;
        case 'deliverymen': pageTitle = 'Ø§Ù„Ù…Ù†Ø§Ø¯ÙŠØ¨'; break;
        case 'customers': pageTitle = 'Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡'; break;
        case 'backup': pageTitle = 'Ø§Ù„Ù†Ø³Ø® Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠ'; loadBackupPageData(); break;
      }
      
      document.getElementById('pageTitle').textContent = pageTitle;
      
      // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ø³Ø§ÙŠØ¯Ø¨Ø§Ø± ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„ØµØºÙŠØ±Ø©
      if (window.innerWidth < 768) {
        document.getElementById('sidebar').classList.remove('show');
      }
    }
    
    // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
    function updateStats() {
      // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø© Ø£ÙˆÙ„Ø§Ù‹
      updateOldOrders();
      
      const orders = JSON.parse(localStorage.getItem('orders') || '[]');
      const complaints = JSON.parse(localStorage.getItem('complaints') || '[]');
      const items = JSON.parse(localStorage.getItem('items') || '[]');
      const customers = JSON.parse(localStorage.getItem('customers') || '[]');
      
      // ØªØµÙÙŠØ© Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù…Ø®ÙÙŠØ© Ù„Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
      const visibleOrders = orders.filter(order => !order.isHidden);
      
      document.getElementById('statsOrders').textContent = visibleOrders.length;
      document.getElementById('statsComplaints').textContent = complaints.length;
      document.getElementById('statsItems').textContent = items.length;
      document.getElementById('statsCustomers').textContent = customers.length;
      
      // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø«Ø§Ø¨ØªØ© Ø£ÙŠØ¶Ù‹Ø§
      updateFixedStats();
    }
    
    // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø«Ø§Ø¨ØªØ©
    function updateFixedStats() {
      // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø© Ø£ÙˆÙ„Ø§Ù‹
      updateOldOrders();
      
      const orders = JSON.parse(localStorage.getItem('orders') || '[]');
      // ØªØµÙÙŠØ© Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù…Ø®ÙÙŠØ©
      const visibleOrders = orders.filter(order => !order.isHidden);
      
      // Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø·Ù„Ø¨Ø§Øª
      const totalOrders = visibleOrders.length;
      document.getElementById('fixedStatsTotal').textContent = totalOrders;
      // Ø·Ù„Ø¨Ø§Øª Ø¬Ø¯ÙŠØ¯Ø©
      const newOrders = visibleOrders.filter(order => order.status === 'Ø¬Ø¯ÙŠØ¯').length;
      document.getElementById('fixedStatsNew').textContent = newOrders;
      // Ø·Ù„Ø¨Ø§Øª Ù‚ÙŠØ¯ Ø§Ù„ØªÙ†ÙÙŠØ°
      const pendingOrders = visibleOrders.filter(order => order.status === 'Ù‚ÙŠØ¯ Ø§Ù„ØªÙ†ÙÙŠØ°').length;
      document.getElementById('fixedStatsPending').textContent = pendingOrders;
      // Ø·Ù„Ø¨Ø§Øª ØªÙ… ØªÙˆØµÙŠÙ„Ù‡Ø§
      const completedOrders = visibleOrders.filter(order => order.status === 'ØªÙ… Ø§Ù„ØªÙˆØµÙŠÙ„').length;
      document.getElementById('fixedStatsCompleted').textContent = completedOrders;
    }
    
    // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø·Ù„Ø¨Ø§Øª ÙÙŠ Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
    function loadOrders() {
      // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø© Ø£ÙˆÙ„Ø§Ù‹
      updateOldOrders();
      
      const orders = JSON.parse(localStorage.getItem('orders') || '[]');
      const tableBody = document.getElementById('ordersTableBodyMain');
      tableBody.innerHTML = '';
      
      // ØªØµÙÙŠØ© Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù…Ø®ÙÙŠØ©
      const visibleOrders = orders.filter(order => !order.isHidden);
      
      if (visibleOrders.length === 0) {
        tableBody.innerHTML = `<tr><td colspan="7" class="text-center">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø·Ù„Ø¨Ø§Øª</td></tr>`;
        return;
      }
      
      // Ø¹Ø±Ø¶ Ø¢Ø®Ø± 5 Ø·Ù„Ø¨Ø§Øª ÙÙ‚Ø·
      visibleOrders.slice(-5).reverse().forEach(order => {
        const row = document.createElement('tr');
        row.innerHTML = `
          <td>${order.id}</td>
          <td>${order.customer} <span class="text-muted small">(${order.phone})</span></td>
          <td class="d-none d-md-table-cell">${order.address}</td>
          <td><span class="badge ${getStatusBadgeClass(order.status)}">${order.status}</span></td>
          <td class="d-none d-md-table-cell">${order.assigned}</td>
          <td class="d-none d-md-table-cell">${formatDate(order.date)}</td>
          <td>
            <button class="btn btn-sm btn-outline-primary" onclick="showOrderDetails(${order.id})"><i class="bi bi-eye"></i></button>
            <button class="btn btn-sm btn-outline-warning" onclick="showEditOrderModal(${order.id})"><i class="bi bi-pencil"></i></button>
            <button class="btn btn-sm btn-outline-success" onclick="contactViaWhatsApp(${order.id})"><i class="bi bi-whatsapp"></i></button>
          </td>
        `;
        tableBody.appendChild(row);
      });
    }
    
    // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø·Ù„Ø¨Ø§Øª ÙÙŠ ØµÙØ­Ø© Ù„Ø·Ù„Ø¨Ø§Øª
    function loadOrdersPage() {
      // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø© Ø£ÙˆÙ„Ø§Ù‹
      updateOldOrders();
      
      const orders = JSON.parse(localStorage.getItem('orders') || '[]');
      const tableBody = document.getElementById('ordersTableBody');
      tableBody.innerHTML = '';
      
      // ØªØµÙÙŠØ© Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù…Ø®ÙÙŠØ©
      const visibleOrders = orders.filter(order => !order.isHidden);
      
      if (visibleOrders.length === 0) {
        tableBody.innerHTML = `<tr><td colspan="8" class="text-center">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø·Ù„Ø¨Ø§Øª</td></tr>`;
        return;
      }
      
      visibleOrders.reverse().forEach(order => {
        const row = document.createElement('tr');
        row.innerHTML = `
          <td>${order.id}</td>
          <td>${order.customer} <span class="text-muted small">(${order.phone})</span></td>
          <td>${order.address}</td>
          <td><span class="badge ${getStatusBadgeClass(order.status)}">${order.status}</span></td>
          <td>${order.assigned}</td>
          <td>${order.amount} Ø¬</td>
          <td>${formatDate(order.date)}</td>
          <td>
            <button class="btn btn-sm btn-outline-primary" onclick="showOrderDetails(${order.id})"><i class="bi bi-eye"></i></button>
            <button class="btn btn-sm btn-outline-warning" onclick="showEditOrderModal(${order.id})"><i class="bi bi-pencil"></i></button>
            <button class="btn btn-sm btn-outline-success" onclick="contactViaWhatsApp(${order.id})"><i class="bi bi-whatsapp"></i></button>
          </td>
        `;
        tableBody.appendChild(row);
      });
    }
    
    // ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„ØªØ§Ø±ÙŠØ®
    function formatDate(dateString) {
      const date = new Date(dateString);
      return date.toLocaleDateString('ar-EG', {
        year: 'numeric',
        month: '2-digit',
        day: '2-digit',
        hour: '2-digit',
        minute: '2-digit'
      });
    }
    
    // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ ÙƒÙ„Ø§Ø³ Ø§Ù„Ø¨Ø§Ø¯Ø¬ Ø­Ø³Ø¨ Ø§Ù„Ø­Ø§Ù„Ø©
    function getStatusBadgeClass(status) {
      switch(status) {
        case 'Ø¬Ø¯ÙŠØ¯': return 'bg-info text-dark';
        case 'Ù‚ÙŠØ¯ Ø§Ù„ØªÙ†ÙÙŠØ°': return 'bg-warning text-dark';
        case 'Ù…Ø¤Ø¬Ù„': return 'bg-secondary';
        case 'ØªÙ… Ø§Ù„ØªÙˆØµÙŠÙ„': return 'bg-success';
        case 'Ù…Ù„ØºÙŠ': return 'bg-danger';
        case 'Ù…Ø­Ø°ÙˆÙ': return 'bg-dark';
        default: return 'bg-secondary';
      }
    }
    
    // ========== Ø¯ÙˆØ§Ù„ Ø¥Ø¯Ø§Ø±Ø© ÙƒÙ„ Ø§Ù„Ø·Ù„Ø¨Ø§Øª ==========
    
    // ØªÙ‡ÙŠØ¦Ø© Ø£Ø±Ø´ÙŠÙ Ø§Ù„Ø·Ù„Ø¨Ø§Øª ÙÙŠ localStorage
    function initializeAllOrdersArchive() {
      if (!localStorage.getItem('allOrdersArchive')) {
        localStorage.setItem('allOrdersArchive', JSON.stringify([]));
      }
    }
    
    // Ø¥Ø¶Ø§ÙØ© Ø·Ù„Ø¨ Ø¥Ù„Ù‰ Ø§Ù„Ø£Ø±Ø´ÙŠÙ Ø¹Ù†Ø¯ Ø¥Ù†Ø´Ø§Ø¦Ù‡
    function addOrderToArchive(order) {
      const archive = JSON.parse(localStorage.getItem('allOrdersArchive') || '[]');
      const archivedOrder = {
        ...order,
        archivedAt: new Date().toISOString(),
        isDeleted: false
      };
      archive.push(archivedOrder);
      localStorage.setItem('allOrdersArchive', JSON.stringify(archive));
    }
    
    // ØªØ­Ø¯ÙŠØ« Ø·Ù„Ø¨ ÙÙŠ Ø§Ù„Ø£Ø±Ø´ÙŠÙ Ø¹Ù†Ø¯ ØªØ¹Ø¯ÙŠÙ„Ù‡
    function updateOrderInArchive(orderId, updatedOrder) {
      const archive = JSON.parse(localStorage.getItem('allOrdersArchive') || '[]');
      const orderIndex = archive.findIndex(order => order.id === orderId);
      
      if (orderIndex !== -1) {
        archive[orderIndex] = {
          ...archive[orderIndex],
          ...updatedOrder,
          lastUpdated: new Date().toISOString()
        };
        localStorage.setItem('allOrdersArchive', JSON.stringify(archive));
      }
    }
    
    // Ø­Ø°Ù Ø·Ù„Ø¨ Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù†Ø´Ø·Ø© ÙˆØ¥Ø¶Ø§ÙØªÙ‡ Ù„Ù„Ø£Ø±Ø´ÙŠÙ
    function deleteOrderToArchive(orderId) {
      const orders = JSON.parse(localStorage.getItem('orders') || '[]');
      const orderToDelete = orders.find(order => order.id === orderId);
      
      if (orderToDelete) {
        // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø·Ù„Ø¨ Ù„Ù„Ø£Ø±Ø´ÙŠÙ Ù…Ø¹ Ø¹Ù„Ø§Ù…Ø© Ù…Ø­Ø°ÙˆÙ
        const archive = JSON.parse(localStorage.getItem('allOrdersArchive') || '[]');
        const archivedOrder = {
          ...orderToDelete,
          archivedAt: new Date().toISOString(),
          deletedAt: new Date().toISOString(),
          isDeleted: true,
          originalStatus: orderToDelete.status
        };
        archive.push(archivedOrder);
        localStorage.setItem('allOrdersArchive', JSON.stringify(archive));
        
        // Ø­Ø°Ù Ø§Ù„Ø·Ù„Ø¨ Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù†Ø´Ø·Ø©
        const updatedOrders = orders.filter(order => order.id !== orderId);
        localStorage.setItem('orders', JSON.stringify(updatedOrders));
        
        return true;
      }
      return false;
    }
    
    // ØªØ­Ù…ÙŠÙ„ ØµÙØ­Ø© ÙƒÙ„ Ø§Ù„Ø·Ù„Ø¨Ø§Øª
    function loadAllOrdersPage() {
      // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø© Ø£ÙˆÙ„Ø§Ù‹
      updateOldOrders();
      
      initializeAllOrdersArchive();
      
      const archive = JSON.parse(localStorage.getItem('allOrdersArchive') || '[]');
      const activeOrders = JSON.parse(localStorage.getItem('orders') || '[]');
      
      // Ø¯Ù…Ø¬ Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù†Ø´Ø·Ø© Ù…Ø¹ Ø§Ù„Ø£Ø±Ø´ÙŠÙ Ù…Ø¹ ØªØ¬Ù†Ø¨ Ø§Ù„ØªÙƒØ±Ø§Ø±
      const allOrders = [];
      const processedIds = new Set();
      
      // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù†Ø´Ø·Ø© Ø£ÙˆÙ„Ø§Ù‹
      activeOrders.forEach(order => {
        allOrders.push(order);
        processedIds.add(order.id);
      });
      
      // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ù…Ù† Ø§Ù„Ø£Ø±Ø´ÙŠÙ Ø§Ù„ØªÙŠ Ù„Ù… ÙŠØªÙ… Ù…Ø¹Ø§Ù„Ø¬ØªÙ‡Ø§ Ø¨Ø¹Ø¯
      archive.forEach(order => {
        if (!processedIds.has(order.id)) {
          allOrders.push(order);
          processedIds.add(order.id);
        }
      });
      
      // ØªØ±ØªÙŠØ¨ Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø­Ø³Ø¨ Ø§Ù„ØªØ§Ø±ÙŠØ® (Ø§Ù„Ø£Ø­Ø¯Ø« Ø£ÙˆÙ„Ø§Ù‹)
      allOrders.sort((a, b) => new Date(b.date) - new Date(a.date));
      
      const tableBody = document.getElementById('allOrdersTableBody');
      tableBody.innerHTML = '';
      
      if (allOrders.length === 0) {
        tableBody.innerHTML = `<tr><td colspan="9" class="text-center">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø·Ù„Ø¨Ø§Øª</td></tr>`;
        updateAllOrdersStats(allOrders);
        return;
      }
      
      allOrders.forEach(order => {
        const isDeleted = order.isDeleted || false;
        const isHidden = order.isHidden || false;
        const deletedAt = order.deletedAt ? formatDate(order.deletedAt) : '-';
        const hiddenAt = order.hiddenAt ? formatDate(order.hiddenAt) : '-';
        const status = isDeleted ? 'Ù…Ø­Ø°ÙˆÙ' : order.status; // Ø¹Ø±Ø¶ Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø£ØµÙ„ÙŠØ© Ø­ØªÙ‰ Ù„Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù…Ø®ÙÙŠØ©
        
        const row = document.createElement('tr');
        row.className = isDeleted ? 'table-secondary' : (isHidden ? 'table-warning' : '');
        row.innerHTML = `
          <td>${order.id}</td>
          <td>${order.customer} <span class="text-muted small">(${order.phone})</span></td>
          <td>${order.address}</td>
          <td><span class="badge ${getStatusBadgeClass(status)}">${status}</span></td>
          <td>${order.assigned || '-'}</td>
          <td>${order.amount} Ø¬</td>
          <td>${formatDate(order.date)}</td>
          <td>${isDeleted ? deletedAt : (isHidden ? hiddenAt : '-')}</td>
          <td>
            <button class="btn btn-sm btn-outline-primary" onclick="showAllOrderDetails(${order.id}, ${isDeleted}, ${isHidden})"><i class="bi bi-eye"></i></button>
            ${!isDeleted && !isHidden ? `
              <button class="btn btn-sm btn-outline-warning" onclick="showEditOrderModal(${order.id})"><i class="bi bi-pencil"></i></button>
              <button class="btn btn-sm btn-outline-success" onclick="contactViaWhatsApp(${order.id})"><i class="bi bi-whatsapp"></i></button>
            ` : isDeleted ? `
              <button class="btn btn-sm btn-outline-info" onclick="restoreOrder(${order.id})"><i class="bi bi-arrow-clockwise"></i></button>
            ` : isHidden ? `
              <button class="btn btn-sm btn-outline-info" onclick="restoreHiddenOrder(${order.id})"><i class="bi bi-arrow-clockwise"></i></button>
            ` : ''}
          </td>
        `;
        tableBody.appendChild(row);
      });
      
      updateAllOrdersStats(allOrders);
    }
    
    // ØªØ­Ø¯ÙŠØ« Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª ÙƒÙ„ Ø§Ù„Ø·Ù„Ø¨Ø§Øª
    function updateAllOrdersStats(allOrders) {
      const totalCount = allOrders.length;
      const activeCount = allOrders.filter(order => !order.isDeleted && !order.isHidden).length;
      const deletedCount = allOrders.filter(order => order.isDeleted).length;
      const hiddenCount = allOrders.filter(order => order.isHidden).length;
      const totalAmount = allOrders.reduce((sum, order) => sum + (parseFloat(order.amount) || 0), 0);
      
      document.getElementById('allOrdersTotalCount').textContent = totalCount;
      document.getElementById('allOrdersActiveCount').textContent = activeCount;
      document.getElementById('allOrdersDeletedCount').textContent = deletedCount;
      document.getElementById('allOrdersTotalAmount').textContent = totalAmount.toFixed(0) + ' Ø¬';
    }
    
    // ØªØµÙÙŠØ© ÙƒÙ„ Ø§Ù„Ø·Ù„Ø¨Ø§Øª
    function filterAllOrders() {
      const searchTerm = document.getElementById('allOrdersSearchInput').value.toLowerCase();
      const statusFilter = document.getElementById('allOrdersStatusFilter').value;
      const monthFilter = document.getElementById('allOrdersMonthFilter').value;
      const yearFilter = document.getElementById('allOrdersYearFilter').value;
      const dateFrom = document.getElementById('allOrdersDateFrom').value;
      const dateTo = document.getElementById('allOrdersDateTo').value;
      
      const archive = JSON.parse(localStorage.getItem('allOrdersArchive') || '[]');
      const activeOrders = JSON.parse(localStorage.getItem('orders') || '[]');
      
      // Ø¯Ù…Ø¬ Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù†Ø´Ø·Ø© Ù…Ø¹ Ø§Ù„Ø£Ø±Ø´ÙŠÙ Ù…Ø¹ ØªØ¬Ù†Ø¨ Ø§Ù„ØªÙƒØ±Ø§Ø±
      const allOrders = [];
      const processedIds = new Set();
      
      // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù†Ø´Ø·Ø© Ø£ÙˆÙ„Ø§Ù‹
      activeOrders.forEach(order => {
        allOrders.push(order);
        processedIds.add(order.id);
      });
      
      // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ù…Ù† Ø§Ù„Ø£Ø±Ø´ÙŠÙ Ø§Ù„ØªÙŠ Ù„Ù… ÙŠØªÙ… Ù…Ø¹Ø§Ù„Ø¬ØªÙ‡Ø§ Ø¨Ø¹Ø¯
      archive.forEach(order => {
        if (!processedIds.has(order.id)) {
          allOrders.push(order);
          processedIds.add(order.id);
        }
      });
      
      let filteredOrders = allOrders.filter(order => {
        // ÙÙ„ØªØ± Ø§Ù„Ø¨Ø­Ø«
        const matchesSearch = !searchTerm || 
          order.customer.toLowerCase().includes(searchTerm) ||
          order.id.toString().includes(searchTerm) ||
          order.address.toLowerCase().includes(searchTerm) ||
          (order.phone && order.phone.includes(searchTerm));
        
        // ÙÙ„ØªØ± Ø§Ù„Ø­Ø§Ù„Ø©
        const currentStatus = order.isDeleted ? 'Ù…Ø­Ø°ÙˆÙ' : order.status; // Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø£ØµÙ„ÙŠØ© Ø­ØªÙ‰ Ù„Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù…Ø®ÙÙŠØ©
        const matchesStatus = !statusFilter || currentStatus === statusFilter;
        
        // ÙÙ„ØªØ± Ø§Ù„Ø´Ù‡Ø±
        const orderDate = new Date(order.date);
        const matchesMonth = !monthFilter || orderDate.getMonth().toString() === monthFilter;
        
        // ÙÙ„ØªØ± Ø§Ù„Ø³Ù†Ø©
        const matchesYear = !yearFilter || orderDate.getFullYear().toString() === yearFilter;
        
        // ÙÙ„ØªØ± Ø§Ù„ØªØ§Ø±ÙŠØ®
        let matchesDate = true;
        if (dateFrom || dateTo) {
          const orderDateStr = orderDate.toISOString().split('T')[0];
          if (dateFrom && orderDateStr < dateFrom) matchesDate = false;
          if (dateTo && orderDateStr > dateTo) matchesDate = false;
        }
        
        return matchesSearch && matchesStatus && matchesMonth && matchesYear && matchesDate;
      });
      
      // ØªØ±ØªÙŠØ¨ Ø§Ù„Ù†ØªØ§Ø¦Ø¬
      filteredOrders.sort((a, b) => new Date(b.date) - new Date(a.date));
      
      // Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªØ§Ø¦Ø¬
      const tableBody = document.getElementById('allOrdersTableBody');
      tableBody.innerHTML = '';
      
      if (filteredOrders.length === 0) {
        tableBody.innerHTML = `<tr><td colspan="9" class="text-center">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬</td></tr>`;
        return;
      }
      
      filteredOrders.forEach(order => {
        const isDeleted = order.isDeleted || false;
        const isHidden = order.isHidden || false;
        const deletedAt = order.deletedAt ? formatDate(order.deletedAt) : '-';
        const hiddenAt = order.hiddenAt ? formatDate(order.hiddenAt) : '-';
        const status = isDeleted ? 'Ù…Ø­Ø°ÙˆÙ' : order.status; // Ø¹Ø±Ø¶ Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø£ØµÙ„ÙŠØ© Ø­ØªÙ‰ Ù„Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù…Ø®ÙÙŠØ©
        
        const row = document.createElement('tr');
        row.className = isDeleted ? 'table-secondary' : (isHidden ? 'table-warning' : '');
        row.innerHTML = `
          <td>${order.id}</td>
          <td>${order.customer} <span class="text-muted small">(${order.phone})</span></td>
          <td>${order.address}</td>
          <td><span class="badge ${getStatusBadgeClass(status)}">${status}</span></td>
          <td>${order.assigned || '-'}</td>
          <td>${order.amount} Ø¬</td>
          <td>${formatDate(order.date)}</td>
          <td>${isDeleted ? deletedAt : (isHidden ? hiddenAt : '-')}</td>
          <td>
            <button class="btn btn-sm btn-outline-primary" onclick="showAllOrderDetails(${order.id}, ${isDeleted}, ${isHidden})"><i class="bi bi-eye"></i></button>
            ${!isDeleted && !isHidden ? `
              <button class="btn btn-sm btn-outline-warning" onclick="showEditOrderModal(${order.id})"><i class="bi bi-pencil"></i></button>
              <button class="btn btn-sm btn-outline-success" onclick="contactViaWhatsApp(${order.id})"><i class="bi bi-whatsapp"></i></button>
            ` : isDeleted ? `
              <button class="btn btn-sm btn-outline-info" onclick="restoreOrder(${order.id})"><i class="bi bi-arrow-clockwise"></i></button>
            ` : isHidden ? `
              <button class="btn btn-sm btn-outline-info" onclick="restoreHiddenOrder(${order.id})"><i class="bi bi-arrow-clockwise"></i></button>
            ` : ''}
          </td>
        `;
        tableBody.appendChild(row);
      });
      
      updateAllOrdersStats(filteredOrders);
    }
    
    // Ø¹Ø±Ø¶ ØªÙØ§ØµÙŠÙ„ Ø·Ù„Ø¨ Ù…Ù† Ø§Ù„Ø£Ø±Ø´ÙŠÙ
    function showAllOrderDetails(orderId, isDeleted, isHidden) {
      const archive = JSON.parse(localStorage.getItem('allOrdersArchive') || '[]');
      const activeOrders = JSON.parse(localStorage.getItem('orders') || '[]');
      
      // Ø¯Ù…Ø¬ Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù†Ø´Ø·Ø© Ù…Ø¹ Ø§Ù„Ø£Ø±Ø´ÙŠÙ Ù…Ø¹ ØªØ¬Ù†Ø¨ Ø§Ù„ØªÙƒØ±Ø§Ø±
      const allOrders = [];
      const processedIds = new Set();
      
      // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù†Ø´Ø·Ø© Ø£ÙˆÙ„Ø§Ù‹
      activeOrders.forEach(order => {
        allOrders.push(order);
        processedIds.add(order.id);
      });
      
      // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ù…Ù† Ø§Ù„Ø£Ø±Ø´ÙŠÙ Ø§Ù„ØªÙŠ Ù„Ù… ÙŠØªÙ… Ù…Ø¹Ø§Ù„Ø¬ØªÙ‡Ø§ Ø¨Ø¹Ø¯
      archive.forEach(order => {
        if (!processedIds.has(order.id)) {
          allOrders.push(order);
          processedIds.add(order.id);
        }
      });
      
      const order = allOrders.find(o => o.id === orderId);
      
      if (!order) {
        alert('Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„Ø·Ù„Ø¨');
        return;
      }
      
      const status = isDeleted ? 'Ù…Ø­Ø°ÙˆÙ' : order.status; // Ø¹Ø±Ø¶ Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø£ØµÙ„ÙŠØ© Ø­ØªÙ‰ Ù„Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù…Ø®ÙÙŠØ©
      const deletedAt = order.deletedAt ? formatDate(order.deletedAt) : 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯';
      const hiddenAt = order.hiddenAt ? formatDate(order.hiddenAt) : 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯';
      
      const detailsBody = document.getElementById('orderDetailsBody');
      detailsBody.innerHTML = `
        <div class="row mb-2">
          <div class="col-4 fw-bold">Ø±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨:</div>
          <div class="col-8">${order.id}</div>
        </div>
        <div class="row mb-2">
          <div class="col-4 fw-bold">Ø§Ù„Ø¹Ù…ÙŠÙ„:</div>
          <div class="col-8">${order.customer}</div>
        </div>
        <div class="row mb-2">
          <div class="col-4 fw-bold">Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ:</div>
          <div class="col-8">${order.phone}</div>
        </div>
        <div class="row mb-2">
          <div class="col-4 fw-bold">Ø§Ù„Ø¹Ù†ÙˆØ§Ù†:</div>
          <div class="col-8">${order.address}</div>
        </div>
        <div class="row mb-2">
          <div class="col-4 fw-bold">Ù†ÙˆØ¹ Ø§Ù„Ø®Ø¯Ù…Ø©:</div>
          <div class="col-8">${getServiceTypeName(order.serviceType)}</div>
        </div>
        <div class="row mb-2">
          <div class="col-4 fw-bold">Ø§Ù„ÙÙ†ÙŠ/Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨:</div>
          <div class="col-8">${order.assigned || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</div>
        </div>
        <div class="row mb-2">
          <div class="col-4 fw-bold">Ø§Ù„Ø¹Ø¯Ø¯:</div>
          <div class="col-8">${order.count}</div>
        </div>
        <div class="row mb-2">
          <div class="col-4 fw-bold">Ø§Ù„Ù…Ø¨Ù„Øº:</div>
          <div class="col-8">${order.amount} Ø¬</div>
        </div>
        <div class="row mb-2">
          <div class="col-4 fw-bold">Ø§Ù„Ø­Ø§Ù„Ø©:</div>
          <div class="col-8"><span class="badge ${getStatusBadgeClass(status)}">${status}</span></div>
        </div>
        <div class="row mb-2">
          <div class="col-4 fw-bold">Ø§Ù„ØªØ§Ø±ÙŠØ®:</div>
          <div class="col-8">${formatDate(order.date)}</div>
        </div>
        ${isDeleted ? `
          <div class="row mb-2">
            <div class="col-4 fw-bold">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø­Ø°Ù:</div>
            <div class="col-8">${deletedAt}</div>
          </div>
          <div class="row mb-2">
            <div class="col-4 fw-bold">Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø£ØµÙ„ÙŠØ©:</div>
            <div class="col-8">${order.originalStatus || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</div>
          </div>
        ` : ''}
        ${isHidden ? `
          <div class="row mb-2">
            <div class="col-4 fw-bold">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥Ø®ÙØ§Ø¡:</div>
            <div class="col-8">${hiddenAt}</div>
          </div>
          <div class="row mb-2">
            <div class="col-4 fw-bold">Ø³Ø¨Ø¨ Ø§Ù„Ø¥Ø®ÙØ§Ø¡:</div>
            <div class="col-8">${order.hiddenReason || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</div>
          </div>
        ` : ''}
        ${order.notes ? `
          <div class="row mb-2">
            <div class="col-4 fw-bold">Ù…Ù„Ø§Ø­Ø¸Ø§Øª:</div>
            <div class="col-8">${order.notes}</div>
          </div>
        ` : ''}
        <div class="row mb-2">
          <div class="col-4 fw-bold">Ù…Ù†Ø´Ø¦ Ø§Ù„Ø·Ù„Ø¨:</div>
          <div class="col-8">${order.createdBy || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</div>
        </div>
        <div class="row mb-2">
          <div class="col-4 fw-bold">Ø¢Ø®Ø± Ù…Ù† Ø¹Ø¯Ù‘Ù„ Ø§Ù„Ø·Ù„Ø¨:</div>
          <div class="col-8">${order.lastModifiedBy || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</div>
        </div>
      `;
      
      const modal = new bootstrap.Modal(document.getElementById('orderDetailsModal'));
      modal.show();
    }
    
    // Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø·Ù„Ø¨ Ù…Ø­Ø°ÙˆÙ
    function restoreOrder(orderId) {
      if (confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ù‡Ø°Ø§ Ø§Ù„Ø·Ù„Ø¨ØŸ')) {
        const archive = JSON.parse(localStorage.getItem('allOrdersArchive') || '[]');
        const orderToRestore = archive.find(order => order.id === orderId && order.isDeleted);
        
        if (orderToRestore) {
          // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø·Ù„Ø¨ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰ Ù„Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù†Ø´Ø·Ø©
          const orders = JSON.parse(localStorage.getItem('orders') || '[]');
          const restoredOrder = {
            ...orderToRestore,
            status: orderToRestore.originalStatus || 'Ø¬Ø¯ÙŠØ¯',
            restoredAt: new Date().toISOString()
          };
          delete restoredOrder.isDeleted;
          delete restoredOrder.deletedAt;
          delete restoredOrder.originalStatus;
          delete restoredOrder.archivedAt;
          
          orders.push(restoredOrder);
          localStorage.setItem('orders', JSON.stringify(orders));
          
          // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø£Ø±Ø´ÙŠÙ
          const updatedArchive = archive.filter(order => !(order.id === orderId && order.isDeleted));
          localStorage.setItem('allOrdersArchive', JSON.stringify(updatedArchive));
          
          // Ø¥Ø¶Ø§ÙØ© Ø³Ø¬Ù„ Ø§Ù„Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ù„Ù„Ø£Ø±Ø´ÙŠÙ
          const restoreRecord = {
            ...orderToRestore,
            restoredAt: new Date().toISOString(),
            isRestored: true
          };
          updatedArchive.push(restoreRecord);
          localStorage.setItem('allOrdersArchive', JSON.stringify(updatedArchive));
          
          // ØªØ­Ø¯ÙŠØ« Ø§Ù„ØµÙØ­Ø©
          loadAllOrdersPage();
          loadOrdersPage();
          updateStats();
          
          showToast('ØªÙ… Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø§Ù„Ø·Ù„Ø¨ Ø¨Ù†Ø¬Ø§Ø­');
        }
      }
    }
    
    // Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø·Ù„Ø¨ Ù…Ø®ÙÙŠ (ØªÙ… ØªØµÙÙŠØªÙ‡)
    function restoreHiddenOrder(orderId) {
      if (confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ù‡Ø°Ø§ Ø§Ù„Ø·Ù„Ø¨ Ø§Ù„Ù…Ø®ÙÙŠØŸ')) {
        const orders = JSON.parse(localStorage.getItem('orders') || '[]');
        const orderToRestore = orders.find(order => order.id === orderId && order.isHidden);
        
        if (orderToRestore) {
          // Ø¥Ø²Ø§Ù„Ø© Ø¹Ù„Ø§Ù…Ø© Ø§Ù„Ø¥Ø®ÙØ§Ø¡ Ù…Ù† Ø§Ù„Ø·Ù„Ø¨
          const restoredOrder = { ...orderToRestore };
          delete restoredOrder.isHidden;
          delete restoredOrder.hiddenAt;
          delete restoredOrder.hiddenBy;
          delete restoredOrder.hiddenReason;
          
          // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø·Ù„Ø¨ ÙÙŠ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©
          const updatedOrders = orders.map(order => 
            order.id === orderId ? restoredOrder : order
          );
          localStorage.setItem('orders', JSON.stringify(updatedOrders));
          
          // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ø·Ù„Ø¨ Ù…Ù† Ø§Ù„Ø£Ø±Ø´ÙŠÙ Ø¥Ø°Ø§ ÙƒØ§Ù† Ù…ÙˆØ¬ÙˆØ¯Ø§Ù‹
          const archive = JSON.parse(localStorage.getItem('allOrdersArchive') || '[]');
          const updatedArchive = archive.filter(order => !(order.id === orderId && order.isFiltered));
          localStorage.setItem('allOrdersArchive', JSON.stringify(updatedArchive));
          
          // ØªØ­Ø¯ÙŠØ« Ø§Ù„ØµÙØ­Ø§Øª
          updateStats();
          loadOrders();
          loadOrdersPage();
          loadAllOrdersPage();
          
          showToast('ØªÙ… Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø§Ù„Ø·Ù„Ø¨ Ø§Ù„Ù…Ø®ÙÙŠ Ø¨Ù†Ø¬Ø§Ø­');
        } else {
          alert('Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„Ø·Ù„Ø¨ Ø§Ù„Ù…Ø®ÙÙŠ');
        }
      }
    }
    
    // ØªØµØ¯ÙŠØ± ÙƒÙ„ Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø¥Ù„Ù‰ Excel
    function exportAllOrdersExcel() {
      const archive = JSON.parse(localStorage.getItem('allOrdersArchive') || '[]');
      const activeOrders = JSON.parse(localStorage.getItem('orders') || '[]');
      
      // Ø¯Ù…Ø¬ Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù†Ø´Ø·Ø© Ù…Ø¹ Ø§Ù„Ø£Ø±Ø´ÙŠÙ Ù…Ø¹ ØªØ¬Ù†Ø¨ Ø§Ù„ØªÙƒØ±Ø§Ø±
      const allOrders = [];
      const processedIds = new Set();
      
      // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù†Ø´Ø·Ø© Ø£ÙˆÙ„Ø§Ù‹
      activeOrders.forEach(order => {
        allOrders.push(order);
        processedIds.add(order.id);
      });
      
      // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ù…Ù† Ø§Ù„Ø£Ø±Ø´ÙŠÙ Ø§Ù„ØªÙŠ Ù„Ù… ÙŠØªÙ… Ù…Ø¹Ø§Ù„Ø¬ØªÙ‡Ø§ Ø¨Ø¹Ø¯
      archive.forEach(order => {
        if (!processedIds.has(order.id)) {
          allOrders.push(order);
          processedIds.add(order.id);
        }
      });
      
      if (allOrders.length === 0) {
        alert('Ù„Ø§ ØªÙˆØ¬Ø¯ Ø·Ù„Ø¨Ø§Øª Ù„Ù„ØªØµØ¯ÙŠØ±');
        return;
      }
      
      // ØªØ­Ø¶ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„ØªØµØ¯ÙŠØ±
      const exportData = allOrders.map(order => ({
        'Ø±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨': order.id,
        'Ø§Ù„Ø¹Ù…ÙŠÙ„': order.customer,
        'Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ': order.phone,
        'Ø§Ù„Ø¹Ù†ÙˆØ§Ù†': order.address,
        'Ù†ÙˆØ¹ Ø§Ù„Ø®Ø¯Ù…Ø©': getServiceTypeName(order.serviceType),
        'Ø§Ù„ÙÙ†ÙŠ/Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨': order.assigned || '',
        'Ø§Ù„Ø¹Ø¯Ø¯': order.count,
        'Ø§Ù„Ù…Ø¨Ù„Øº': order.amount,
        'Ø§Ù„Ø­Ø§Ù„Ø©': order.isDeleted ? 'Ù…Ø­Ø°ÙˆÙ' : order.status, // Ø¹Ø±Ø¶ Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø£ØµÙ„ÙŠØ© Ø­ØªÙ‰ Ù„Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù…Ø®ÙÙŠØ©
        'ØªØ§Ø±ÙŠØ® ÙˆÙˆÙ‚Øª Ø§Ù„Ø·Ù„Ø¨': formatDate(order.date),
        'ØªØ§Ø±ÙŠØ® Ø§Ù„Ø­Ø°Ù/Ø§Ù„Ø¥Ø®ÙØ§Ø¡': order.deletedAt ? formatDate(order.deletedAt) : (order.hiddenAt ? formatDate(order.hiddenAt) : ''),
        'Ø³Ø¨Ø¨ Ø§Ù„Ø­Ø°Ù/Ø§Ù„Ø¥Ø®ÙØ§Ø¡': order.deletedReason || order.hiddenReason || '',
        'Ù…Ù„Ø§Ø­Ø¸Ø§Øª': order.notes || '',
        'Ù…Ù†Ø´Ø¦ Ø§Ù„Ø·Ù„Ø¨': order.createdBy || '',
        'Ø¢Ø®Ø± Ù…Ù† Ø¹Ø¯Ù‘Ù„ Ø§Ù„Ø·Ù„Ø¨': order.lastModifiedBy || ''
      }));
      
      // Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù„Ù Excel
      const ws = XLSX.utils.json_to_sheet(exportData);
      const wb = XLSX.utils.book_new();
      XLSX.utils.book_append_sheet(wb, ws, 'ÙƒÙ„ Ø§Ù„Ø·Ù„Ø¨Ø§Øª');
      
      // ØªØµØ¯ÙŠØ± Ø§Ù„Ù…Ù„Ù
      const fileName = `ÙƒÙ„_Ø§Ù„Ø·Ù„Ø¨Ø§Øª_${new Date().toISOString().split('T')[0]}.xlsx`;
      XLSX.writeFile(wb, fileName);
      
      showToast('ØªÙ… ØªØµØ¯ÙŠØ± ÙƒÙ„ Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø¨Ù†Ø¬Ø§Ø­');
    }
    
    // Ù…Ø³Ø­ Ø£Ø±Ø´ÙŠÙ Ø§Ù„Ø·Ù„Ø¨Ø§Øª
    function clearAllOrdersArchive() {
      if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ù…Ø³Ø­ Ø£Ø±Ø´ÙŠÙ Ø§Ù„Ø·Ù„Ø¨Ø§ØªØŸ Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø¹Ù†Ù‡.')) {
        localStorage.removeItem('allOrdersArchive');
        loadAllOrdersPage();
        showToast('ØªÙ… Ù…Ø³Ø­ Ø£Ø±Ø´ÙŠÙ Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø¨Ù†Ø¬Ø§Ø­');
      }
    }
    
    // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ø³Ù… Ù†ÙˆØ¹ Ø§Ù„Ø®Ø¯Ù…Ø©
    function getServiceTypeName(serviceType) {
      const serviceTypes = {
        'ac': 'ØªÙƒÙŠÙŠÙ',
        'plumbing': 'Ø³Ø¨Ø§Ùƒ',
        'carpenter': 'Ù†Ø¬Ø§Ø±',
        'electrician': 'ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠ',
        'hometools': 'Ø§Ø¯ÙˆØ§Øª Ù…Ù†Ø²Ù„ÙŠØ©',
        'dish': 'Ø¯Ø´',
        'delivery': 'Ø¯Ù„ÙŠÙØ±ÙŠ',
        'glass': 'Ø²Ø¬Ø§Ø¬',
        'hadad': 'Ø­Ø¯Ø§Ø¯',
        'painter': 'Ù†Ù‚Ø§Ø´',
        'ceramic': 'Ø³ÙŠØ±Ø§Ù…ÙŠÙƒ'
      };
      return serviceTypes[serviceType] || serviceType;
    }
    
    // ØªØ­Ù…ÙŠÙ„ Ù‚ÙˆØ§Ø¦Ù… Ø£ÙØ¶Ù„ Ø§Ù„ÙÙ†ÙŠÙŠÙ† ÙˆØ§Ù„Ù…Ù†Ø§Ø¯ÙŠØ¨ ÙˆØ§Ù„Ø¹Ù…Ù„Ø§Ø¡
    function loadTopLists() {
      // ØªØ­Ù…ÙŠÙ„ Ø£ÙØ¶Ù„ Ø§Ù„ÙÙ†ÙŠÙŠÙ†
      const techniciansList = document.getElementById('topTechniciansList');
      techniciansList.innerHTML = '';
      
      const technicians = JSON.parse(localStorage.getItem('technicians') || '[]');
      if (technicians.length === 0) {
        techniciansList.innerHTML = '<li class="list-group-item py-1 px-2 text-center">Ù„Ø§ ÙŠÙˆØ¬Ø¯ ÙÙ†ÙŠÙŠÙ†</li>';
      } else {
        technicians.slice(0, 3).forEach((technician, index) => {
          const li = document.createElement('li');
          li.className = 'list-group-item py-1 px-2 d-flex align-items-center';
          li.innerHTML = `
            <img src="https://randomuser.me/api/portraits/men/${11 + index}.jpg" class="user-avatar ms-1" alt="tech" style="width: 28px; height: 28px;">
            <span class="fw-bold small">${technician.name}</span>
            <span class="badge bg-primary ms-auto">${technician.rating || 0} â˜…</span>
          `;
          techniciansList.appendChild(li);
        });
      }
      
      // ØªØ­Ù…ÙŠÙ„ Ø£ÙØ¶Ù„ Ø§Ù„Ù…Ù†Ø§Ø¯ÙŠØ¨
      const deliverymenList = document.getElementById('topDeliverymenList');
      deliverymenList.innerHTML = '';
      
      const deliverymen = JSON.parse(localStorage.getItem('deliverymen') || '[]');
      if (deliverymen.length === 0) {
        deliverymenList.innerHTML = '<li class="list-group-item py-1 px-2 text-center">Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ù†Ø§Ø¯ÙŠØ¨</li>';
      } else {
        deliverymen.slice(0, 3).forEach((deliveryman, index) => {
          const li = document.createElement('li');
          li.className = 'list-group-item py-1 px-2 d-flex align-items-center';
          li.innerHTML = `
            <img src="https://randomuser.me/api/portraits/men/${13 + index}.jpg" class="user-avatar ms-1" alt="deliveryman" style="width: 28px; height: 28px;">
            <span class="fw-bold small">${deliveryman.name}</span>
            <span class="badge bg-primary ms-auto">${deliveryman.rating || 0} â˜…</span>
          `;
          deliverymenList.appendChild(li);
        });
      }
      
      // ØªØ­Ù…ÙŠÙ„ Ø£ÙØ¶Ù„ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡
      const customersList = document.getElementById('topCustomersList');
      customersList.innerHTML = '';
      
      const customers = JSON.parse(localStorage.getItem('customers') || '[]');
      if (customers.length === 0) {
        customersList.innerHTML = '<li class="list-group-item py-1 px-2 text-center">Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø¹Ù…Ù„Ø§Ø¡</li>';
      } else {
        customers.slice(0, 3).forEach((customer, index) => {
          const li = document.createElement('li');
          li.className = 'list-group-item py-1 px-2 d-flex align-items-center';
          li.innerHTML = `
            <img src="https://randomuser.me/api/portraits/men/${15 + index}.jpg" class="user-avatar ms-1" alt="customer" style="width: 28px; height: 28px;">
            <span class="fw-bold small">${customer.name}</span>
            <span class="badge bg-primary ms-auto">${customer.orders || 0} Ø·Ù„Ø¨</span>
          `;
          customersList.appendChild(li);
        });
      }
    }
    
    // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ø±Ø³Ù… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠ
    function initOrdersChart() {
      // Ø¥Ø¸Ù‡Ø§Ø± Ù…Ø¤Ø´Ø± Ø§Ù„ØªØ­Ù…ÙŠÙ„
      document.getElementById('chartLoading').style.display = 'flex';
      
      setTimeout(() => {
        try {
          const ctx = document.getElementById('ordersChart').getContext('2d');
          
          // Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø±Ø³Ù… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠ
          const chartData = generateChartData();
          
          // ØªÙƒÙˆÙŠÙ† Ø§Ù„Ø±Ø³Ù… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠ
          const config = {
            type: currentChartType,
            data: chartData,
            options: {
              responsive: true,
              maintainAspectRatio: false,
              plugins: {
                legend: {
                  display: currentChartType === 'doughnut',
                  position: 'top',
                },
                tooltip: {
                  mode: 'index',
                  intersect: false,
                }
              },
              scales: {
                x: {
                  display: currentChartType !== 'doughnut',
                },
                y: {
                  display: currentChartType !== 'doughnut',
                  beginAtZero: true
                }
              }
            }
          };
          
          // Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø±Ø³Ù… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠ
          if (ordersChart) {
            ordersChart.destroy();
          }
          ordersChart = new Chart(ctx, config);
          
          // ØªØ­Ø¯ÙŠØ« ÙˆØ³ÙŠÙ„Ø© Ø§Ù„Ø¥ÙŠØ¶Ø§Ø­
          updateChartLegend(chartData);
        } catch (error) {
          console.error('Error generating chart:', error);
        } finally {
          // Ø¥Ø®ÙØ§Ø¡ Ù…Ø¤Ø´Ø± Ø§Ù„ØªØ­Ù…ÙŠÙ„ Ø¨Ø¹Ø¯ Ø§ÙƒØªÙ…Ø§Ù„ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©
          document.getElementById('chartLoading').style.display = 'none';
        }
      }, 300); // Ø¥Ø¶Ø§ÙØ© ØªØ£Ø®ÙŠØ± ØµØºÙŠØ± Ù„Ø¬Ø¹Ù„ Ø§Ù„ØªØ­Ù…ÙŠÙ„ Ù…Ø±Ø¦ÙŠÙ‹Ø§
    }
    
    // ØªØºÙŠÙŠØ± Ù†ÙˆØ¹ Ø§Ù„Ø±Ø³Ù… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠ
    function changeChartType(type) {
      currentChartType = type;
      
      // ØªØ­Ø¯ÙŠØ« Ø£Ø²Ø±Ø§Ø± Ù†ÙˆØ¹ Ø§Ù„Ø±Ø³Ù… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠ
      document.querySelectorAll('.chart-type-btn').forEach(btn => {
        btn.classList.remove('active');
      });
      document.querySelector(`.chart-type-btn[data-type="${type}"]`).classList.add('active');
      
      // Ø¥Ø¹Ø§Ø¯Ø© ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ø±Ø³Ù… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠ
      initOrdersChart();
    }
    
    // ØªØ­Ø¯ÙŠØ« ÙØªØ±Ø© Ø§Ù„Ø±Ø³Ù… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠ
    function updateChartPeriod() {
      const period = document.getElementById('chartPeriod').value;
      const dateRangeSelector = document.getElementById('dateRangeSelector');
      
      // Ø¹Ø±Ø¶ Ø£Ùˆ Ø¥Ø®ÙØ§Ø¡ Ù…Ù†ØªÙ‚ÙŠ Ù†Ø·Ø§Ù‚ Ø§Ù„ØªØ§Ø±ÙŠØ® Ø­Ø³Ø¨ Ø§Ù„Ø§Ø®ØªÙŠØ§Ø±
      if (period === 'custom') {
        // Ø¥Ø°Ø§ ØªÙ… Ø§Ø®ØªÙŠØ§Ø± "ØªØ®ØµÙŠØµ ÙØªØ±Ø©"ØŒ Ø¹Ø±Ø¶ Ù…Ù†ØªÙ‚ÙŠ Ù†Ø·Ø§Ù‚ Ø§Ù„ØªØ§Ø±ÙŠØ®
        dateRangeSelector.style.display = 'block';
        
        // ØªØ¹ÙŠÙŠÙ† ØªÙˆØ§Ø±ÙŠØ® Ø§ÙØªØ±Ø§Ø¶ÙŠØ© Ø¥Ø°Ø§ Ù„Ù… ÙŠØªÙ… ØªØ­Ø¯ÙŠØ¯Ù‡Ø§ Ø¨Ø¹Ø¯
        const today = new Date();
        const lastMonth = new Date();
        lastMonth.setMonth(lastMonth.getMonth() - 1);
        
        const startDateInput = document.getElementById('startDate');
        const endDateInput = document.getElementById('endDate');
        
        if (!startDateInput.value) {
          startDateInput.value = formatDateForInput(lastMonth);
        }
        
        if (!endDateInput.value) {
          endDateInput.value = formatDateForInput(today);
        }
      } else {
        // Ø¥Ø®ÙØ§Ø¡ Ù…Ù†ØªÙ‚ÙŠ Ù†Ø·Ø§Ù‚ Ø§Ù„ØªØ§Ø±ÙŠØ® Ù„Ù„Ø®ÙŠØ§Ø±Ø§Øª Ø§Ù„Ø£Ø®Ø±Ù‰
        dateRangeSelector.style.display = 'none';
      }
      
      // Ø¥Ø¹Ø§Ø¯Ø© ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ø±Ø³Ù… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠ
      initOrdersChart();
    }
    
    // ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„ØªØ§Ø±ÙŠØ® Ù„Ù„Ù…Ø¯Ø®Ù„Ø§Øª Ù…Ù† Ù†ÙˆØ¹ ØªØ§Ø±ÙŠØ® (YYYY-MM-DD)
    function formatDateForInput(date) {
      const year = date.getFullYear();
      const month = String(date.getMonth() + 1).padStart(2, '0');
      const day = String(date.getDate()).padStart(2, '0');
      return `${year}-${month}-${day}`;
    }
    
    // Ø¥Ù†Ø´Ø§Ø¡ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø±Ø³Ù… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠ
    function generateChartData() {
      const period = document.getElementById('chartPeriod').value;
      let labels = [];
      
      // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„ØªÙˆØ§Ø±ÙŠØ® Ø§Ù„Ø­Ø§Ù„ÙŠØ©
      const today = new Date();
      const startOfWeek = new Date(today);
      const startOfMonth = new Date(today.getFullYear(), today.getMonth(), 1);
      
      // ØªØ¹Ø¯ÙŠÙ„ Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ù„ØªÙƒÙˆÙ† Ø§Ù„Ø³Ø¨Øª (adjusting for Arabic calendar where Saturday is first day)
      const currentDay = today.getDay(); // 0 = Ø§Ù„Ø£Ø­Ø¯ØŒ 6 = Ø§Ù„Ø³Ø¨Øª
      const diff = currentDay === 6 ? 0 : currentDay + 1; // Ø§Ù„ÙŠÙˆÙ… - Ø§Ù„Ø³Ø¨Øª
      startOfWeek.setDate(today.getDate() - diff);
      
      // ØªØ­Ø¯ÙŠØ¯ Ø§Ù„ØªØ³Ù…ÙŠØ§Øª Ø­Ø³Ø¨ Ø§Ù„ÙØªØ±Ø©
      switch(period) {
        case 'thisWeek':
          // Ø§Ù„Ø£ÙŠØ§Ù… Ù…Ù† Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø­Ø§Ù„ÙŠ Ø­ØªÙ‰ Ø§Ù„ÙŠÙˆÙ…
          labels = ['Ø§Ù„Ø³Ø¨Øª', 'Ø§Ù„Ø£Ø­Ø¯', 'Ø§Ù„Ø¥Ø«Ù†ÙŠÙ†', 'Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡', 'Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡', 'Ø§Ù„Ø®Ù…ÙŠØ³', 'Ø§Ù„Ø¬Ù…Ø¹Ø©'];
          break;
        case 'thisMonth':
          // Ø§Ù„Ø£ÙŠØ§Ù… Ù…Ù† Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„Ø´Ù‡Ø± Ø§Ù„Ø­Ø§Ù„ÙŠ Ø­ØªÙ‰ Ø§Ù„ÙŠÙˆÙ…
          const daysInMonth = new Date(today.getFullYear(), today.getMonth() + 1, 0).getDate();
          labels = Array.from({length: daysInMonth}, (_, i) => (i + 1).toString());
          break;
        case 'week':
          labels = ['Ø§Ù„Ø³Ø¨Øª', 'Ø§Ù„Ø£Ø­Ø¯', 'Ø§Ù„Ø¥Ø«Ù†ÙŠÙ†', 'Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡', 'Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡', 'Ø§Ù„Ø®Ù…ÙŠØ³', 'Ø§Ù„Ø¬Ù…Ø¹Ø©'];
          break;
        case 'month':
          labels = Array.from({length: 30}, (_, i) => (i + 1).toString());
          break;
        case 'year':
          labels = ['ÙŠÙ†Ø§ÙŠØ±', 'ÙØ¨Ø±Ø§ÙŠØ±', 'Ù…Ø§Ø±Ø³', 'Ø£Ø¨Ø±ÙŠÙ„', 'Ù…Ø§ÙŠÙˆ', 'ÙŠÙˆÙ†ÙŠÙˆ', 'ÙŠÙˆÙ„ÙŠÙˆ', 'Ø£ØºØ³Ø·Ø³', 'Ø³Ø¨ØªÙ…Ø¨Ø±', 'Ø£ÙƒØªÙˆØ¨Ø±', 'Ù†ÙˆÙÙ…Ø¨Ø±', 'Ø¯ÙŠØ³Ù…Ø¨Ø±'];
          break;
        case 'custom':
          // Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù†Ø·Ø§Ù‚ Ø§Ù„ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…Ø®ØµØµ
          const startDate = new Date(document.getElementById('startDate').value);
          const endDate = new Date(document.getElementById('endDate').value);
          
          // Ø­Ø³Ø§Ø¨ Ø¹Ø¯Ø¯ Ø§Ù„Ø£ÙŠØ§Ù… Ø¨ÙŠÙ† Ø§Ù„ØªØ§Ø±ÙŠØ®ÙŠÙ†
          const timeDiff = endDate.getTime() - startDate.getTime();
          const daysDiff = Math.ceil(timeDiff / (1000 * 3600 * 24)) + 1;
          
          // Ø¥Ù†Ø´Ø§Ø¡ ØªØ³Ù…ÙŠØ§Øª Ù„ÙƒÙ„ ÙŠÙˆÙ… ÙÙŠ Ø§Ù„Ù†Ø·Ø§Ù‚
          labels = [];
          for (let i = 0; i < daysDiff; i++) {
            const date = new Date(startDate);
            date.setDate(startDate.getDate() + i);
            labels.push(formatDate(date));
          }
          break;
      }
      
      // Ø§Ø³ØªØ±Ø¬Ø§Ø¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† localStorage
      const orders = JSON.parse(localStorage.getItem('orders') || '[]');
      
      // ØªØ¬Ù‡ÙŠØ² Ù…ØµÙÙˆÙØ§Øª Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙØ§Ø±ØºØ©
      const completedData = Array(labels.length).fill(0);
      const pendingData = Array(labels.length).fill(0);
      const canceledData = Array(labels.length).fill(0);
      
      // ØªØ­Ø¯ÙŠØ¯ Ù†Ø·Ø§Ù‚ Ø§Ù„ÙÙ„ØªØ±Ø© Ø­Ø³Ø¨ Ø§Ù„ÙØªØ±Ø© Ø§Ù„Ù…Ø­Ø¯Ø¯Ø©
      let filterStartDate, filterEndDate;
      
      switch(period) {
        case 'thisWeek':
          filterStartDate = startOfWeek;
          filterEndDate = new Date();
          break;
        case 'thisMonth':
          filterStartDate = startOfMonth;
          filterEndDate = new Date();
          break;
        case 'custom':
          filterStartDate = new Date(document.getElementById('startDate').value);
          filterEndDate = new Date(document.getElementById('endDate').value);
          // ØªØ¹ÙŠÙŠÙ† ÙˆÙ‚Øª Ù†Ù‡Ø§ÙŠØ© Ø§Ù„ÙŠÙˆÙ… Ù„Ù„ØªØ§Ø±ÙŠØ® Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ
          filterEndDate.setHours(23, 59, 59, 999);
          break;
        default:
          // Ù„Ù„ÙØªØ±Ø§Øª Ø§Ù„Ø£Ø®Ø±Ù‰ØŒ Ù„Ø§ Ù†Ø³ØªØ®Ø¯Ù… ÙÙ„ØªØ± ØªØ§Ø±ÙŠØ® Ù…Ø­Ø¯Ø¯
          filterStartDate = null;
          filterEndDate = null;
      }
      
      // Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø­Ø³Ø¨ Ø§Ù„ÙØªØ±Ø© Ø§Ù„Ù…Ø­Ø¯Ø¯Ø©
      orders.forEach(order => {
        if (!order.date) return; // ØªØ®Ø·ÙŠ Ø§Ù„Ø³Ø¬Ù„Ø§Øª Ø¨Ø¯ÙˆÙ† ØªØ§Ø±ÙŠØ®
        
        const orderDate = new Date(order.date);
        
        // ØªØ·Ø¨ÙŠÙ‚ ÙÙ„ØªØ± Ø§Ù„ØªØ§Ø±ÙŠØ® Ø¥Ø°Ø§ ÙƒØ§Ù† Ù…Ø­Ø¯Ø¯Ø§Ù‹
        if (filterStartDate && filterEndDate) {
          if (orderDate < filterStartDate || orderDate > filterEndDate) {
            return; // ØªØ®Ø·ÙŠ Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø®Ø§Ø±Ø¬ Ù†Ø·Ø§Ù‚ Ø§Ù„ØªØ§Ø±ÙŠØ®
          }
        }
        
        let index = 0;
        
        // ØªØ­Ø¯ÙŠØ¯ ÙÙ‡Ø±Ø³ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø­Ø³Ø¨ Ø§Ù„ÙØªØ±Ø©
        switch(period) {
          case 'thisWeek':
          case 'week':
            // Ø§Ù„ÙŠÙˆÙ… ÙÙŠ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ (0-6)ØŒ ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ø¤Ø´Ø± Ù„ÙŠØªÙˆØ§ÙÙ‚ Ù…Ø¹ ØªØ±ØªÙŠØ¨ Ø§Ù„Ø£ÙŠØ§Ù… ÙÙŠ labels
            index = (orderDate.getDay() + 1) % 7; // Ù„Ø¬Ø¹Ù„ Ø§Ù„Ø³Ø¨Øª Ù‡Ùˆ Ø§Ù„ÙŠÙˆÙ… Ø§Ù„Ø£ÙˆÙ„ ÙÙŠ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹
            break;
          case 'thisMonth':
          case 'month':
            // Ø§Ù„ÙŠÙˆÙ… ÙÙŠ Ø§Ù„Ø´Ù‡Ø± (1-31)
            index = orderDate.getDate() - 1;
            if (index >= labels.length) index = labels.length - 1; // Ù„Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø¹Ø¯Ù… ØªØ¬Ø§ÙˆØ² Ø§Ù„Ø­Ø¯
            break;
          case 'year':
            // Ø§Ù„Ø´Ù‡Ø± ÙÙŠ Ø§Ù„Ø³Ù†Ø© (0-11)
            index = orderDate.getMonth();
            break;
          case 'custom':
            // Ø­Ø³Ø§Ø¨ Ø§Ù„ÙØ±Ù‚ Ø¨Ø§Ù„Ø£ÙŠØ§Ù… Ø¨ÙŠÙ† ØªØ§Ø±ÙŠØ® Ø§Ù„Ø·Ù„Ø¨ ÙˆØªØ§Ø±ÙŠØ® Ø§Ù„Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„Ù…Ø­Ø¯Ø¯
            const startDate = new Date(document.getElementById('startDate').value);
            const timeDiff = orderDate.getTime() - startDate.getTime();
            index = Math.floor(timeDiff / (1000 * 3600 * 24));
            if (index < 0) index = 0; // Ù„Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø¹Ø¯Ù… Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ ÙÙ‡Ø±Ø³ Ø³Ø§Ù„Ø¨
            if (index >= labels.length) index = labels.length - 1; // Ù„Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø¹Ø¯Ù… ØªØ¬Ø§ÙˆØ² Ø§Ù„Ø­Ø¯
            break;
        }
        
        // ØªØµÙ†ÙŠÙ Ø§Ù„Ø·Ù„Ø¨ Ø­Ø³Ø¨ Ø­Ø§Ù„ØªÙ‡
        switch(order.status) {
          case 'ØªÙ… Ø§Ù„ØªÙˆØµÙŠÙ„':
            completedData[index]++;
            break;
          case 'Ù‚ÙŠØ¯ Ø§Ù„ØªÙ†ÙÙŠØ°':
            pendingData[index]++;
            break;
          case 'Ù…Ù„ØºÙŠ':
            canceledData[index]++;
            break;
        }
      });
      
      // ØªÙƒÙˆÙŠÙ† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø­Ø³Ø¨ Ù†ÙˆØ¹ Ø§Ù„Ø±Ø³Ù… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠ
      if (currentChartType === 'doughnut') {
        // Ø­Ø³Ø§Ø¨ Ø¥Ø¬Ù…Ø§Ù„ÙŠØ§Øª ÙƒÙ„ Ø­Ø§Ù„Ø©
        const totalCompleted = completedData.reduce((a, b) => a + b, 0);
        const totalPending = pendingData.reduce((a, b) => a + b, 0);
        const totalCanceled = canceledData.reduce((a, b) => a + b, 0);
        
        return {
          labels: ['ØªÙ… Ø§Ù„ØªÙˆØµÙŠÙ„', 'Ù‚ÙŠØ¯ Ø§Ù„ØªÙ†ÙÙŠØ°', 'Ù…Ù„ØºÙŠ'],
          datasets: [{
            data: [totalCompleted, totalPending, totalCanceled],
            backgroundColor: [
              'rgba(75, 192, 192, 0.7)',
              'rgba(255, 193, 7, 0.7)',
              'rgba(255, 99, 132, 0.7)'
            ],
            borderColor: [
              'rgba(75, 192, 192, 1)',
              'rgba(255, 193, 7, 1)',
              'rgba(255, 99, 132, 1)'
            ],
            borderWidth: 1
          }]
        };
      } else {
        return {
          labels: labels,
          datasets: [
            {
              label: 'ØªÙ… Ø§Ù„ØªÙˆØµÙŠÙ„',
              data: completedData,
              backgroundColor: 'rgba(75, 192, 192, 0.2)',
              borderColor: 'rgba(75, 192, 192, 1)',
              borderWidth: 2,
              tension: 0.3
            },
            {
              label: 'Ù‚ÙŠØ¯ Ø§Ù„ØªÙ†ÙÙŠØ°',
              data: pendingData,
              backgroundColor: 'rgba(255, 193, 7, 0.2)',
              borderColor: 'rgba(255, 193, 7, 1)',
              borderWidth: 2,
              tension: 0.3
            },
            {
              label: 'Ù…Ù„ØºÙŠ',
              data: canceledData,
              backgroundColor: 'rgba(255, 99, 132, 0.2)',
              borderColor: 'rgba(255, 99, 132, 1)',
              borderWidth: 2,
              tension: 0.3
            }
          ]
        };
      }
    }
    
    // ØªØ­Ø¯ÙŠØ« ÙˆØ³ÙŠÙ„Ø© Ø§Ù„Ø¥ÙŠØ¶Ø§Ø­
    function updateChartLegend(chartData) {
      const legendContainer = document.getElementById('chartLegend');
      legendContainer.innerHTML = '';
      
      if (currentChartType === 'doughnut') {
        return; // Chart.js ÙŠØ¹Ø±Ø¶ ÙˆØ³ÙŠÙ„Ø© Ø§Ù„Ø¥ÙŠØ¶Ø§Ø­ ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§ Ù„Ù„Ø±Ø³Ù… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠ Ø§Ù„Ø¯Ø§Ø¦Ø±ÙŠ
      }
      
      chartData.datasets.forEach((dataset, index) => {
        const legendItem = document.createElement('div');
        legendItem.className = 'chart-legend-item';
        
        const colorBox = document.createElement('div');
        colorBox.className = 'chart-legend-color';
        colorBox.style.backgroundColor = dataset.borderColor;
        
        const label = document.createElement('span');
        label.textContent = dataset.label;
        
        legendItem.appendChild(colorBox);
        legendItem.appendChild(label);
        legendContainer.appendChild(legendItem);
      });
    }
    
    // ØªØ­Ø¯ÙŠØ« Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø·Ø§Ø¹Ù… ÙÙŠ Ù†Ù…ÙˆØ°Ø¬ Ø¥Ø¶Ø§ÙØ© Ø§Ù„ØµÙ†Ù
    function updateRestaurantsDropdown() {
      const restaurants = JSON.parse(localStorage.getItem('restaurants') || '[]');
      const dropdown = document.getElementById('itemRestaurantInput');
      dropdown.innerHTML = '';
      
      if (restaurants.length === 0) {
        dropdown.innerHTML = '<option value="">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø·Ø§Ø¹Ù…</option>';
        return;
      }
      
      restaurants.forEach(restaurant => {
        const option = document.createElement('option');
        option.value = restaurant.id;
        option.textContent = restaurant.name;
        dropdown.appendChild(option);
      });
    }
    
    // ØªØ­Ø¯ÙŠØ« Ù‚Ø§Ø¦Ù…Ø© Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ø®Ø¯Ù…Ø§Øª ÙÙŠ Ù†Ù…ÙˆØ°Ø¬ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø·Ù„Ø¨
    function updateServiceTypesDropdown() {
      const dropdown = document.getElementById('orderServiceTypeInput');
      dropdown.innerHTML = '<option value="">Ø§Ø®ØªØ± Ù†ÙˆØ¹ Ø§Ù„Ø®Ø¯Ù…Ø©</option>';
      
      const serviceTypes = [
        { id: 'ac', name: 'ØªÙƒÙŠÙŠÙ' },
        { id: 'plumbing', name: 'Ø³Ø¨Ø§Ùƒ' },
        { id: 'carpenter', name: 'Ù†Ø¬Ø§Ø±' },
        { id: 'electrician', name: 'ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠ' },
        { id: 'hometools', name: 'Ø§Ø¯ÙˆØ§Øª Ù…Ù†Ø²Ù„ÙŠØ©' },
        { id: 'dish', name: 'Ø¯Ø´' },
        { id: 'delivery', name: 'Ø¯Ù„ÙŠÙØ±ÙŠ' },
        { id: 'glass', name: 'Ø²Ø¬Ø§Ø¬' },
        { id: 'hadad', name: 'Ø­Ø¯Ø§Ø¯' },
        { id: 'painter', name: 'Ù†Ù‚Ø§Ø´' },
        { id: 'ceramic', name: 'Ø³ÙŠØ±Ø§Ù…ÙŠÙƒ' }
      ];
      
      serviceTypes.forEach(type => {
        const option = document.createElement('option');
        option.value = type.id;
        option.textContent = type.name;
        dropdown.appendChild(option);
      });
    }
    
    // ØªØ­Ø¯ÙŠØ« Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ÙÙ†ÙŠÙŠÙ†/Ø§Ù„Ù…Ù†Ø§Ø¯ÙŠØ¨ ÙÙŠ Ù†Ù…ÙˆØ°Ø¬ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø·Ù„Ø¨ Ø­Ø³Ø¨ Ù†ÙˆØ¹ Ø§Ù„Ø®Ø¯Ù…Ø©
    function updateOrderTechniciansDropdown() {
      const serviceType = document.getElementById('orderServiceTypeInput').value;
      const dropdown = document.getElementById('orderAssignedInput');
      dropdown.innerHTML = '';
      
      if (serviceType === 'delivery') {
        // Ø¥Ø°Ø§ ÙƒØ§Ù† Ø¯Ù„ÙŠÙØ±ÙŠØŒ Ù†Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù†Ø§Ø¯ÙŠØ¨
        const deliverymen = JSON.parse(localStorage.getItem('deliverymen') || '[]');
        
        if (deliverymen.length === 0) {
          dropdown.innerHTML = '<option value="">Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ù†Ø§Ø¯ÙŠØ¨</option>';
          return;
        }
        
        deliverymen.forEach(deliveryman => {
          const option = document.createElement('option');
          option.value = deliveryman.id;
          option.textContent = `${deliveryman.name} - ${deliveryman.phone}`;
          dropdown.appendChild(option);
        });
      } else {
        // Ø¥Ø°Ø§ ÙƒØ§Ù† Ø®Ø¯Ù…Ø© ÙÙ†ÙŠØ©ØŒ Ù†Ø¹Ø±Ø¶ Ø§Ù„ÙÙ†ÙŠÙŠÙ† Ø§Ù„Ù…Ø·Ø§Ø¨Ù‚ÙŠÙ† Ù„Ù„ØªØ®ØµØµ
        const technicians = JSON.parse(localStorage.getItem('technicians') || '[]');
        
        if (technicians.length === 0) {
          dropdown.innerHTML = '<option value="">Ù„Ø§ ÙŠÙˆØ¬Ø¯ ÙÙ†ÙŠÙŠÙ†</option>';
          return;
        }
        
        // ØªØ¹ÙŠÙŠÙ† ØªØ®ØµØµ Ø§Ù„ÙÙ†ÙŠ Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ù†ÙˆØ¹ Ø§Ù„Ø®Ø¯Ù…Ø©
        const specialtyMapping = {
          'ac': 'ØªÙƒÙŠÙŠÙ',
          'plumbing': 'Ø³Ø¨Ø§ÙƒØ©',
          'carpenter': 'Ù†Ø¬Ø§Ø±Ø©',
          'electrician': 'ÙƒÙ‡Ø±Ø¨Ø§Ø¡',
          'hometools': 'Ø§Ø¯ÙˆØ§Øª Ù…Ù†Ø²Ù„ÙŠØ©',
          'dish': 'Ø¯Ø´',
          'hadad': 'Ø­Ø¯Ø§Ø¯',
          'glass': 'Ø²Ø¬Ø§Ø¬',
          'painter': 'Ù†Ù‚Ø§Ø´',
          'ceramic': 'Ø³ÙŠØ±Ø§Ù…ÙŠÙƒ'
        };
        
        const requiredSpecialty = specialtyMapping[serviceType];
        
        // ØªØµÙÙŠØ© Ø§Ù„ÙÙ†ÙŠÙŠÙ† Ø­Ø³Ø¨ Ø§Ù„ØªØ®ØµØµ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨
        const filteredTechnicians = technicians.filter(technician => 
          !requiredSpecialty || technician.specialty === requiredSpecialty
        );
        
        if (filteredTechnicians.length === 0) {
          dropdown.innerHTML = '<option value="">Ù„Ø§ ÙŠÙˆØ¬Ø¯ ÙÙ†ÙŠÙŠÙ† Ù„Ù‡Ø°Ø§ Ø§Ù„ØªØ®ØµØµ</option>';
          return;
        }
        
        // ØªØ±ØªÙŠØ¨ Ø§Ù„ÙÙ†ÙŠÙŠÙ† Ø­Ø³Ø¨ Ø±Ù‚Ù… Ø§Ù„ØªØ±ØªÙŠØ¨
        filteredTechnicians.sort((a, b) => (a.order || 999) - (b.order || 999));
        
        filteredTechnicians.forEach(technician => {
          const option = document.createElement('option');
          option.value = technician.id;
          
          // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ Ù„Ù„ÙÙ†ÙŠ
          const isLimitReached = !checkTechnicianLimit(technician.id);
          const limitText = isLimitReached ? ' (Ù…Ù…Ù†ÙˆØ¹ Ø§Ù„ØªØ¹Ø§Ù…Ù„)' : '';
          
          option.textContent = `${technician.order || 'ØŸ'} - ${technician.name} - ${technician.phone}${limitText}`;
          
          // Ø¥Ø¶Ø§ÙØ© ÙØ¦Ø© Ù„Ù„ÙÙ†ÙŠÙŠÙ† Ø§Ù„Ù…Ù…Ù†ÙˆØ¹ Ø§Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹Ù‡Ù…
          if (isLimitReached) {
            option.className = 'text-danger';
            option.disabled = true;
          }
          
          dropdown.appendChild(option);
        });
      }
    }
    
    // Ø¹Ø±Ø¶ Ø¥Ø´Ø¹Ø§Ø±
    function showNotification(message, type = 'warning') {
      // Ø¥Ù†Ø´Ø§Ø¡ Ø¹Ù†ØµØ± Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±
      const notification = document.createElement('div');
      notification.className = `alert alert-${type} alert-dismissible fade show position-fixed`;
      notification.style.cssText = `
        top: 20px;
        right: 20px;
        z-index: 9999;
        min-width: 300px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        border: none;
        border-radius: 8px;
      `;
      
      notification.innerHTML = `
        <div class="d-flex align-items-center">
          <i class="bi ${type === 'danger' ? 'bi-exclamation-triangle-fill' : type === 'success' ? 'bi-check-circle-fill' : 'bi-exclamation-circle-fill'} me-2"></i>
          <span>${message}</span>
        </div>
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Ø¥ØºÙ„Ø§Ù‚"></button>
      `;
      
      // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¥Ø´Ø¹Ø§Ø± Ù„Ù„ØµÙØ­Ø©
      document.body.appendChild(notification);
      
      // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ø¥Ø´Ø¹Ø§Ø± ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø¨Ø¹Ø¯ 5 Ø«ÙˆØ§Ù†ÙŠ
      setTimeout(() => {
        if (notification.parentNode) {
          notification.remove();
        }
      }, 5000);
    }
    
    // Ø¹Ø±Ø¶ Ø¥Ø´Ø¹Ø§Ø± Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰
    function showLimitNotification(technicianName) {
      showNotification(`Ù…Ù…Ù†ÙˆØ¹ Ø§Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ ${technicianName} Ø­ØªÙ‰ ÙŠØªÙ… ØªØµÙÙŠØ© Ø§Ù„Ø­Ø³Ø§Ø¨`, 'danger');
    }
    
    // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ Ù„Ù„ÙÙ†ÙŠ
    function checkTechnicianLimit(technicianId) {
      const orders = JSON.parse(localStorage.getItem('orders') || '[]');
      const MAX_COMPANY_SHARE = 300; // Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ Ù„Ø­ØµØ© Ø§Ù„Ø´Ø±ÙƒØ© Ø¨Ø§Ù„Ø¬Ù†ÙŠÙ‡
      
      // Ø­Ø³Ø§Ø¨ Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù…ÙƒØªÙ…Ù„Ø© Ù„Ù„ÙÙ†ÙŠ
      const completedOrders = orders.filter(order => 
        order.assignedId == technicianId && 
        order.status === 'ØªÙ… Ø§Ù„ØªÙˆØµÙŠÙ„' &&
        !order.isHidden
      );
      
      // Ø­Ø³Ø§Ø¨ Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø­ØµØ© Ø§Ù„Ø´Ø±ÙƒØ© (25% Ù…Ù† ÙƒÙ„ Ø·Ù„Ø¨)
      const totalCompanyShare = completedOrders.reduce((sum, order) => {
        return sum + (parseFloat(order.amount) * 0.25);
      }, 0);
      
      // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰
      return totalCompanyShare < MAX_COMPANY_SHARE;
    }
    
    // Ø¥Ø¶Ø§ÙØ© Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯
    function addOrder(event) {
      event.preventDefault();
      
      const orders = JSON.parse(localStorage.getItem('orders') || '[]');
      const newOrderId = orders.length > 0 ? Math.max(...orders.map(o => o.id)) + 1 : 1;
      
      const serviceType = document.getElementById('orderServiceTypeInput').value;
      const assignedId = document.getElementById('orderAssignedInput').value;
      
      // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ Ù„Ù„ÙÙ†ÙŠ (ÙÙ‚Ø· Ù„Ù„ÙÙ†ÙŠÙŠÙ†ØŒ ÙˆÙ„ÙŠØ³ Ø§Ù„Ù…Ù†Ø§Ø¯ÙŠØ¨)
      if (serviceType !== 'delivery' && assignedId && !checkTechnicianLimit(assignedId)) {
        // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ø³Ù… Ø§Ù„ÙÙ†ÙŠ Ù„Ø¹Ø±Ø¶Ù‡ ÙÙŠ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±
        const technicians = JSON.parse(localStorage.getItem('technicians') || '[]');
        const technician = technicians.find(t => t.id == assignedId);
        const technicianName = technician ? technician.name : 'Ø§Ù„ÙÙ†ÙŠ';
        
        showNotification(`Ù…Ù…Ù†ÙˆØ¹ Ø§Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ ${technicianName} Ø­ØªÙ‰ ÙŠØªÙ… ØªØµÙÙŠØ© Ø§Ù„Ø­Ø³Ø§Ø¨`, 'danger');
        return;
      }
      
      // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ø³Ù… Ø§Ù„ÙÙ†ÙŠ/Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨
      let assignedName = '';
      if (serviceType === 'delivery') {
        const deliverymen = JSON.parse(localStorage.getItem('deliverymen') || '[]');
        const deliveryman = deliverymen.find(d => d.id == assignedId);
        assignedName = deliveryman ? deliveryman.name : '';
      } else {
        const technicians = JSON.parse(localStorage.getItem('technicians') || '[]');
        const technician = technicians.find(t => t.id == assignedId);
        assignedName = technician ? technician.name : '';
      }
      
      // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„ Ù…Ù† Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
      const customerName = document.getElementById('orderCustomerInput').value;
      const customerPhone = document.getElementById('orderPhoneInput').value;
      const customerAddress = document.getElementById('orderAddressInput').value;
      
      // Ø¥Ø¶Ø§ÙØ© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„ Ø¥Ù„Ù‰ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ Ø¥Ø°Ø§ Ù„Ù… ÙŠÙƒÙ† Ù…ÙˆØ¬ÙˆØ¯Ù‹Ø§ Ø¨Ø§Ù„ÙØ¹Ù„
      addCustomerIfNotExists(customerName, customerPhone, customerAddress);
      
      // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø­Ø§Ù„ÙŠ
      const currentUser = localStorage.getItem('currentUser') || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯';
      
      const newOrder = {
        id: newOrderId,
        customer: customerName,
        phone: customerPhone,
        address: customerAddress,
        serviceType: serviceType,
        assigned: assignedName,
        assignedId: assignedId,
        count: document.getElementById('orderCountInput').value,
        amount: document.getElementById('orderAmountInput').value,
        status: document.getElementById('orderStatusInput').value,
        notes: document.getElementById('orderNotesInput').value,
        date: new Date().toISOString(),
        createdBy: currentUser,
        lastModifiedBy: currentUser, // ØªÙ… Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ Ù‡Ù†Ø§ Ù„ÙŠÙƒÙˆÙ† Ù†ÙØ³ Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ Ø¹Ù†Ø¯ Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡
        rated: false // Ø¥Ø¶Ø§ÙØ© Ø­Ø§Ù„Ø© Ø§Ù„ØªÙ‚ÙŠÙŠÙ…
      };
      
      orders.push(newOrder);
      localStorage.setItem('orders', JSON.stringify(orders));
      
      // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø·Ù„Ø¨ Ø¥Ù„Ù‰ Ø§Ù„Ø£Ø±Ø´ÙŠÙ
      addOrderToArchive(newOrder);
      
      // ØªØ­Ø¯ÙŠØ« ÙˆÙ‚Øª Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ« Ù„Ù„Ø·Ù„Ø¨Ø§Øª
      updateLastUpdateTime('orders');
      
      // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª ÙˆÙ‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø·Ù„Ø¨Ø§Øª
      updateStats(); // Ø³ØªÙ‚ÙˆÙ… Ø¨ØªØ­Ø¯ÙŠØ« updateFixedStats Ø£ÙŠØ¶Ù‹Ø§
      loadOrders();
      loadOrdersPage();
      
      // ØªØ­Ø¯ÙŠØ« ØµÙØ­Ø© Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡
      loadCustomersPage();
      
      // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø©
      const modal = bootstrap.Modal.getInstance(document.getElementById('addOrderModal'));
      modal.hide();
      
      // Ø¹Ø±Ø¶ Ø¥Ø´Ø¹Ø§Ø± Ø§Ù„Ù†Ø¬Ø§Ø­
      showNotification('ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø·Ù„Ø¨ Ø¨Ù†Ø¬Ø§Ø­', 'success');
    }
    
    // ÙˆØ¸ÙŠÙØ© Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¹Ù…ÙŠÙ„ Ø¥Ù„Ù‰ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ Ø¥Ø°Ø§ Ù„Ù… ÙŠÙƒÙ† Ù…ÙˆØ¬ÙˆØ¯Ù‹Ø§ Ø¨Ø§Ù„ÙØ¹Ù„
    function addCustomerIfNotExists(name, phone, address) {
      if (!name || !phone) {
        return; // Ù„Ø§ Ù†Ø¶ÙŠÙ Ø¹Ù…ÙŠÙ„Ù‹Ø§ Ø¨Ø¯ÙˆÙ† Ø§Ø³Ù… Ø£Ùˆ Ø±Ù‚Ù… Ù‡Ø§ØªÙ
      }
      
      const customers = JSON.parse(localStorage.getItem('customers') || '[]');
      
      // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ø¹Ù…ÙŠÙ„ Ø¨Ø§Ù„Ø§Ø³Ù… ÙˆØ±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ
      const existingCustomer = customers.find(c => c.phone === phone);
      
      if (existingCustomer) {
        // ØªØ­Ø¯ÙŠØ« Ø¹Ø¯Ø¯ Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ù„Ù„Ø¹Ù…ÙŠÙ„ Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯
        existingCustomer.orders = (existingCustomer.orders || 0) + 1;
        
        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ø¥Ø°Ø§ ÙƒØ§Ù† Ù…Ø®ØªÙ„ÙÙ‹Ø§
        if (address && existingCustomer.address !== address) {
          existingCustomer.address = address;
        }
        
        localStorage.setItem('customers', JSON.stringify(customers));
        // ØªØ­Ø¯ÙŠØ« ÙˆÙ‚Øª Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ« Ù„Ù„Ø¹Ù…Ù„Ø§Ø¡
        updateLastUpdateTime('customers');
      } else {
        // Ø¥Ø¶Ø§ÙØ© Ø¹Ù…ÙŠÙ„ Ø¬Ø¯ÙŠØ¯
        const newCustomerId = customers.length > 0 ? Math.max(...customers.map(c => c.id)) + 1 : 1;
        
        const newCustomer = {
          id: newCustomerId,
          name: name,
          phone: phone,
          address: address || '',
          orders: 1
        };
        
        customers.push(newCustomer);
        localStorage.setItem('customers', JSON.stringify(customers));
        // ØªØ­Ø¯ÙŠØ« ÙˆÙ‚Øª Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ« Ù„Ù„Ø¹Ù…Ù„Ø§Ø¡
        updateLastUpdateTime('customers');
      }
    }
    
    // Ø¹Ø±Ø¶ Ù†Ø§ÙØ°Ø© Ø¥Ø¶Ø§ÙØ© Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯
    function showAddOrderModal() {
      // ØªØ¹ÙŠÙŠÙ† Ø±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨ Ø§Ù„Ø¬Ø¯ÙŠØ¯
      const orders = JSON.parse(localStorage.getItem('orders') || '[]');
      const newOrderId = orders.length > 0 ? Math.max(...orders.map(o => o.id)) + 1 : 1;
      document.getElementById('orderIdInput').value = newOrderId;
      
      // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
      document.getElementById('addOrderForm').reset();
      document.getElementById('orderIdInput').value = newOrderId;
      
      // ØªØ­Ø¯ÙŠØ« Ù‚Ø§Ø¦Ù…Ø© Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ø®Ø¯Ù…Ø§Øª
      updateServiceTypesDropdown();
      
      // Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªÙ…Ø¹ Ø­Ø¯Ø« Ù„ØªØºÙŠÙŠØ± Ù†ÙˆØ¹ Ø§Ù„Ø®Ø¯Ù…Ø©
      document.getElementById('orderServiceTypeInput').addEventListener('change', function() {
        updateOrderTechniciansDropdown();
      });
      
      // ØªØ­Ø¯ÙŠØ« Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ÙÙ†ÙŠÙŠÙ† Ø¹Ù†Ø¯ ÙØªØ­ Ø§Ù„Ù†Ø§ÙØ°Ø©
      updateOrderTechniciansDropdown();
      
      // ØªØºÙŠÙŠØ± Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø© ÙˆØ²Ø± Ø§Ù„Ø­ÙØ¸
      document.getElementById('addOrderModalLabel').textContent = 'Ø¥Ø¶Ø§ÙØ© Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯';
      document.querySelector('#addOrderForm button[type="submit"]').textContent = 'Ø­ÙØ¸';
      
      // ØªØºÙŠÙŠØ± ÙˆØ¸ÙŠÙØ© Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ Ù„Ø¥Ø¶Ø§ÙØ© Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯
      document.getElementById('addOrderForm').onsubmit = function(event) {
        addOrder(event);
      };
      
      // Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªÙ…Ø¹ Ø­Ø¯Ø« Ù„ØªØºÙŠÙŠØ± Ø§Ù„ÙÙ†ÙŠ
      document.getElementById('orderAssignedInput').addEventListener('change', function() {
        const selectedTechnicianId = this.value;
        const serviceType = document.getElementById('orderServiceTypeInput').value;
        
        // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ Ù„Ù„ÙÙ†ÙŠ (ÙÙ‚Ø· Ù„Ù„ÙÙ†ÙŠÙŠÙ†ØŒ ÙˆÙ„ÙŠØ³ Ø§Ù„Ù…Ù†Ø§Ø¯ÙŠØ¨)
        if (serviceType !== 'delivery' && selectedTechnicianId && !checkTechnicianLimit(selectedTechnicianId)) {
          // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ø³Ù… Ø§Ù„ÙÙ†ÙŠ Ù„Ø¹Ø±Ø¶Ù‡ ÙÙŠ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±
          const technicians = JSON.parse(localStorage.getItem('technicians') || '[]');
          const technician = technicians.find(t => t.id == selectedTechnicianId);
          const technicianName = technician ? technician.name : 'Ø§Ù„ÙÙ†ÙŠ';
          
          showNotification(`Ù…Ù…Ù†ÙˆØ¹ Ø§Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ ${technicianName} Ø­ØªÙ‰ ÙŠØªÙ… ØªØµÙÙŠØ© Ø§Ù„Ø­Ø³Ø§Ø¨`, 'danger');
          
          // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø§Ø®ØªÙŠØ§Ø±
          this.value = '';
        }
      });
      
      // ÙØªØ­ Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø©
      const modal = new bootstrap.Modal(document.getElementById('addOrderModal'));
      modal.show();
    }
    
    // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø© Ù„Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
    function updateOldOrders() {
      const orders = JSON.parse(localStorage.getItem('orders') || '[]');
      let updated = false;
      
      orders.forEach(order => {
        if (!order.hasOwnProperty('createdBy') || order.createdBy === undefined) {
          order.createdBy = 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯';
          updated = true;
        }
        if (!order.hasOwnProperty('lastModifiedBy') || order.lastModifiedBy === undefined) {
          order.lastModifiedBy = null;
          updated = true;
        }
      });
      
      if (updated) {
        localStorage.setItem('orders', JSON.stringify(orders));
        console.log('ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø©');
      }
    }
    
    // Ø¹Ø±Ø¶ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø·Ù„Ø¨
    function showOrderDetails(orderId) {
      // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø© Ø£ÙˆÙ„Ø§Ù‹
      updateOldOrders();
      
      const orders = JSON.parse(localStorage.getItem('orders') || '[]');
      const order = orders.find(o => o.id === orderId);
      
      // ØªØ´Ø®ÙŠØµ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
      console.log('Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø·Ù„Ø¨:', order);
      console.log('createdBy:', order?.createdBy);
      console.log('lastModifiedBy:', order?.lastModifiedBy);
      
      if (order) {
        const detailsBody = document.getElementById('orderDetailsBody');
        detailsBody.innerHTML = `
          <div class="row mb-2">
            <div class="col-4 fw-bold">Ø±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨:</div>
            <div class="col-8">${order.id}</div>
          </div>
          <div class="row mb-2">
            <div class="col-4 fw-bold">Ø§Ù„Ø¹Ù…ÙŠÙ„:</div>
            <div class="col-8">${order.customer} <span class="text-muted small">(${order.phone})</span></div>
          </div>
          <div class="row mb-2">
            <div class="col-4 fw-bold">Ø§Ù„Ø¹Ù†ÙˆØ§Ù†:</div>
            <div class="col-8">${order.address}</div>
          </div>
          <div class="row mb-2">
            <div class="col-4 fw-bold">Ù†ÙˆØ¹ Ø§Ù„Ø®Ø¯Ù…Ø©:</div>
            <div class="col-8">${getServiceTypeName(order.serviceType)}</div>
          </div>
          <div class="row mb-2">
            <div class="col-4 fw-bold">Ø§Ù„ÙÙ†ÙŠ/Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨:</div>
            <div class="col-8">${order.assigned}</div>
          </div>
          <div class="row mb-2">
            <div class="col-4 fw-bold">Ø§Ù„Ø¹Ø¯Ø¯:</div>
            <div class="col-8">${order.count}</div>
          </div>
          <div class="row mb-2">
            <div class="col-4 fw-bold">Ø§Ù„Ù…Ø¨Ù„Øº:</div>
            <div class="col-8">${order.amount} Ø¬</div>
          </div>
          <div class="row mb-2">
            <div class="col-4 fw-bold">Ø§Ù„Ø­Ø§Ù„Ø©:</div>
            <div class="col-8"><span class="badge ${getStatusBadgeClass(order.status)}">${order.status}</span></div>
          </div>
          <div class="row mb-2">
            <div class="col-4 fw-bold">Ø§Ù„ØªØ§Ø±ÙŠØ®:</div>
            <div class="col-8">${formatDate(order.date)}</div>
          </div>
          <div class="row mb-2">
            <div class="col-4 fw-bold">Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„:</div>
            <div class="col-8">${order.createdBy && order.createdBy !== 'undefined' ? order.createdBy : 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</div>
          </div>
          <div class="row mb-2">
            <div class="col-4 fw-bold">Ù…Ù† Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ Ø¹Ù† Ø§Ù„ØªØ¹Ø¯ÙŠÙ„:</div>
            <div class="col-8">
              ${(() => {
                const modifier = order.lastModifiedBy;
                console.log('Ù‚ÙŠÙ…Ø© lastModifiedBy:', modifier, 'Ù†ÙˆØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:', typeof modifier);
                if (modifier && modifier !== 'undefined' && modifier !== null && modifier !== '') {
                  return modifier;
                } else {
                  return 'Ù„Ù… ÙŠØªÙ… Ø§Ù„ØªØ¹Ø¯ÙŠÙ„';
                }
              })()}
            </div>
          </div>
          <div class="row mb-2">
            <div class="col-4 fw-bold">Ù…Ù„Ø§Ø­Ø¸Ø§Øª:</div>
            <div class="col-8">${order.notes || 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù„Ø§Ø­Ø¸Ø§Øª'}</div>
          </div>
        `;
        
        const modal = new bootstrap.Modal(document.getElementById('orderDetailsModal'));
        modal.show();
      }
    }
    
    // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ø³Ù… Ù†ÙˆØ¹ Ø§Ù„Ø®Ø¯Ù…Ø©
    function getServiceTypeName(serviceTypeId) {
      const serviceTypes = {
        'ac': 'ØªÙƒÙŠÙŠÙ',
        'plumbing': 'Ø³Ø¨Ø§Ùƒ',
        'carpenter': 'Ù†Ø¬Ø§Ø±',
        'electrician': 'ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠ',
        'hometools': 'Ø§Ø¯ÙˆØ§Øª Ù…Ù†Ø²Ù„ÙŠØ©',
        'dish': 'Ø¯Ø´',
        'delivery': 'Ø¯Ù„ÙŠÙØ±ÙŠ',
        'hadad': 'Ø­Ø¯Ø§Ø¯',
        'glass': 'Ø²Ø¬Ø§Ø¬'
      };
      
      return serviceTypes[serviceTypeId] || serviceTypeId;
    }
    
    // Ø­Ø°Ù Ø·Ù„Ø¨
    function deleteOrder(orderId) {
      if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ø·Ù„Ø¨ØŸ Ø³ÙŠØªÙ… Ù†Ù‚Ù„Ù‡ Ø¥Ù„Ù‰ Ø§Ù„Ø£Ø±Ø´ÙŠÙ.')) {
        const success = deleteOrderToArchive(orderId);
        
        if (success) {
          // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª ÙˆÙ‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø·Ù„Ø¨Ø§Øª
          updateStats(); // Ø³ØªÙ‚ÙˆÙ… Ø¨ØªØ­Ø¯ÙŠØ« updateFixedStats Ø£ÙŠØ¶Ù‹Ø§
          loadOrders();
          loadOrdersPage();
          
          // ØªØ­Ø¯ÙŠØ« ØµÙØ­Ø© ÙƒÙ„ Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ù…ÙØªÙˆØ­Ø©
          if (document.getElementById('allOrdersPage').classList.contains('active')) {
            loadAllOrdersPage();
          }
          
          showToast('ØªÙ… Ø­Ø°Ù Ø§Ù„Ø·Ù„Ø¨ Ø¨Ù†Ø¬Ø§Ø­');
        } else {
          alert('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø­Ø°Ù Ø§Ù„Ø·Ù„Ø¨');
        }
      }
    }
    
    // Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø·Ù„Ø¨Ø§Øª
    function deleteAllOrders() {
      if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø·Ù„Ø¨Ø§ØªØŸ')) {
        localStorage.setItem('orders', JSON.stringify([]));
        
        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª ÙˆÙ‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø·Ù„Ø¨Ø§Øª
        updateStats(); // Ø³ØªÙ‚ÙˆÙ… Ø¨ØªØ­Ø¯ÙŠØ« updateFixedStats Ø£ÙŠØ¶Ù‹Ø§
        loadOrders();
        loadOrdersPage();
      }
    }
    
    // ØªØµÙÙŠØ© Ø§Ù„Ø·Ù„Ø¨Ø§Øª ÙÙŠ Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
    function filterOrders() {
      const searchTerm = document.getElementById('orderSearchInput').value.toLowerCase();
      const statusFilter = document.getElementById('orderStatusFilter').value;
      
      const orders = JSON.parse(localStorage.getItem('orders') || '[]');
      // ØªØµÙÙŠØ© Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù…Ø®ÙÙŠØ© Ø£ÙˆÙ„Ø§Ù‹
      const visibleOrders = orders.filter(order => !order.isHidden);
      const filteredOrders = visibleOrders.filter(order => {
        const matchesSearch = order.customer.toLowerCase().includes(searchTerm) || 
                             order.id.toString().includes(searchTerm) ||
                             order.phone.includes(searchTerm);
        const matchesStatus = statusFilter === '' || order.status === statusFilter;
        
        return matchesSearch && matchesStatus;
      });
      
      const tableBody = document.getElementById('ordersTableBodyMain');
      tableBody.innerHTML = '';
      
      if (filteredOrders.length === 0) {
        tableBody.innerHTML = `<tr><td colspan="7" class="text-center">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø·Ù„Ø¨Ø§Øª Ù…Ø·Ø§Ø¨Ù‚Ø©</td></tr>`;
        return;
      }
      
      // Ø¹Ø±Ø¶ Ø¢Ø®Ø± 5 Ø·Ù„Ø¨Ø§Øª ÙÙ‚Ø·
      filteredOrders.slice(-5).reverse().forEach(order => {
        const row = document.createElement('tr');
        row.innerHTML = `
          <td>${order.id}</td>
          <td>${order.customer} <span class="text-muted small">(${order.phone})</span></td>
          <td class="d-none d-md-table-cell">${order.address}</td>
          <td><span class="badge ${getStatusBadgeClass(order.status)}">${order.status}</span></td>
          <td class="d-none d-md-table-cell">${order.assigned}</td>
          <td class="d-none d-md-table-cell">${formatDate(order.date)}</td>
          <td>
            <button class="btn btn-sm btn-outline-primary" onclick="showOrderDetails(${order.id})"><i class="bi bi-eye"></i></button>
            <button class="btn btn-sm btn-outline-warning" onclick="showEditOrderModal(${order.id})"><i class="bi bi-pencil"></i></button>
            <button class="btn btn-sm btn-outline-success" onclick="contactViaWhatsApp(${order.id})"><i class="bi bi-whatsapp"></i></button>
          </td>
        `;
        tableBody.appendChild(row);
      });
    }
    
    // ØªØµÙÙŠØ© Ø§Ù„Ø·Ù„Ø¨Ø§Øª ÙÙŠ ØµÙØ­Ø© Ø§Ù„Ø·Ù„Ø¨Ø§Øª
    function filterOrdersPage() {
      const searchTerm = document.getElementById('orderPageSearchInput').value.toLowerCase();
      const statusFilter = document.getElementById('orderPageStatusFilter').value;
      const monthFilter = document.getElementById('orderMonthFilter').value;
      const dayFilter = document.getElementById('orderDayFilter').value;
      
      const orders = JSON.parse(localStorage.getItem('orders') || '[]');
      // ØªØµÙÙŠØ© Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù…Ø®ÙÙŠØ© Ø£ÙˆÙ„Ø§Ù‹
      const visibleOrders = orders.filter(order => !order.isHidden);
      const filteredOrders = visibleOrders.filter(order => {
        const matchesSearch = order.customer.toLowerCase().includes(searchTerm) || 
                              order.id.toString().includes(searchTerm) ||
                              order.phone.includes(searchTerm);
        const matchesStatus = statusFilter === '' || order.status === statusFilter;
        
        // ÙÙ„ØªØ±Ø© Ø­Ø³Ø¨ Ø§Ù„Ø´Ù‡Ø±
        let matchesMonth = true;
        if (monthFilter !== '') {
          const orderDate = new Date(order.date);
          matchesMonth = orderDate.getMonth() === parseInt(monthFilter);
        }
        
        // ÙÙ„ØªØ±Ø© Ø­Ø³Ø¨ Ø§Ù„ÙŠÙˆÙ…
        let matchesDay = true;
        if (dayFilter !== '') {
          const orderDate = new Date(order.date);
          matchesDay = orderDate.getDay() === parseInt(dayFilter);
        }
        
        return matchesSearch && matchesStatus && matchesMonth && matchesDay;
      });
      
      const tableBody = document.getElementById('ordersTableBody');
      tableBody.innerHTML = '';
      
      if (filteredOrders.length === 0) {
        tableBody.innerHTML = `<tr><td colspan="8" class="text-center">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø·Ù„Ø¨Ø§Øª Ù…Ø·Ø§Ø¨Ù‚Ø©</td></tr>`;
        return;
      }
      
      // ØªÙ†Ø¸ÙŠÙ… Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø­Ø³Ø¨ Ø§Ù„ØªØ§Ø±ÙŠØ® (Ø§Ù„Ø£Ø­Ø¯Ø« Ø£ÙˆÙ„Ø§Ù‹)
      filteredOrders.sort((a, b) => new Date(b.date) - new Date(a.date));
      
      filteredOrders.forEach(order => {
        const row = document.createElement('tr');
        row.innerHTML = `
          <td>${order.id}</td>
          <td>${order.customer} <span class="text-muted small">(${order.phone})</span></td>
          <td>${order.address}</td>
          <td><span class="badge ${getStatusBadgeClass(order.status)}">${order.status}</span></td>
          <td>${order.assigned}</td>
          <td>${order.amount} Ø¬</td>
          <td>${formatDate(order.date)}</td>
          <td>
            <button class="btn btn-sm btn-outline-primary" onclick="showOrderDetails(${order.id})"><i class="bi bi-eye"></i></button>
            <button class="btn btn-sm btn-outline-warning" onclick="showEditOrderModal(${order.id})"><i class="bi bi-pencil"></i></button>
            <button class="btn btn-sm btn-outline-success" onclick="contactViaWhatsApp(${order.id})"><i class="bi bi-whatsapp"></i></button>
          </td>
        `;
        tableBody.appendChild(row);
      });
      
      // Ø¹Ø±Ø¶ Ø¥Ø­ØµØ§Ø¡Ø§Øª Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù…ØµÙØ§Ø©
      showFilteredStats(filteredOrders);
    }
    
    // Ø¹Ø±Ø¶ Ø¥Ø­ØµØ§Ø¡Ø§Øª Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù…ØµÙØ§Ø©
    function showFilteredStats(filteredOrders) {
      // Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø¹Ø¯Ø¯ Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù…ØµÙØ§Ø©
      const totalOrders = filteredOrders.length;
      
      // Ø¹Ø¯Ø¯ Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø­Ø³Ø¨ Ø§Ù„Ø­Ø§Ù„Ø©
      const pendingOrders = filteredOrders.filter(order => order.status === 'Ù‚ÙŠØ¯ Ø§Ù„ØªÙ†ÙÙŠØ°').length;
      const deliveredOrders = filteredOrders.filter(order => order.status === 'ØªÙ… Ø§Ù„ØªÙˆØµÙŠÙ„').length;
      const canceledOrders = filteredOrders.filter(order => order.status === 'Ù…Ù„ØºÙŠ').length;
      
      // Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª
      const totalSales = filteredOrders.reduce((sum, order) => sum + parseFloat(order.amount), 0);
      
      // Ø¥Ø¶Ø§ÙØ© HTML Ù„Ø¹Ø±Ø¶ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø£Ø¹Ù„Ù‰ Ø§Ù„Ø¬Ø¯ÙˆÙ„
      const statsHTML = `
        <div class="mb-3 p-3 bg-light rounded">
          <div class="row">
            <div class="col-md-3 col-6 mb-2">
              <div class="small text-muted">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø·Ù„Ø¨Ø§Øª</div>
              <div class="fw-bold">${totalOrders}</div>
            </div>
            <div class="col-md-3 col-6 mb-2">
              <div class="small text-muted">Ù‚ÙŠØ¯ Ø§Ù„ØªÙ†ÙÙŠØ°</div>
              <div class="fw-bold text-warning">${pendingOrders}</div>
            </div>
            <div class="col-md-3 col-6 mb-2">
              <div class="small text-muted">ØªÙ… Ø§Ù„ØªÙˆØµÙŠÙ„</div>
              <div class="fw-bold text-success">${deliveredOrders}</div>
            </div>
          </div>
        </div>
      `;
      
      // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¥Ø­ØµØ§Ø¡Ø§Øª Ø¥Ù„Ù‰ Ø§Ù„ØµÙØ­Ø©
      const statsContainer = document.getElementById('ordersStatsContainer');
      if (statsContainer) {
        statsContainer.innerHTML = statsHTML;
      } else {
        // Ø¥Ø°Ø§ Ù„Ù… ÙŠÙƒÙ† Ø§Ù„Ø¹Ù†ØµØ± Ù…ÙˆØ¬ÙˆØ¯Ù‹Ø§ØŒ Ù‚Ù… Ø¨Ø¥Ù†Ø´Ø§Ø¦Ù‡
        const tableContainer = document.querySelector('.table-responsive').parentNode;
        const newStatsContainer = document.createElement('div');
        newStatsContainer.id = 'ordersStatsContainer';
        newStatsContainer.innerHTML = statsHTML;
        tableContainer.insertBefore(newStatsContainer, document.querySelector('.table-responsive'));
      }
    }
    
    // Ø¥Ø¶Ø§ÙØ© Ù…Ø·Ø¹Ù… Ø¬Ø¯ÙŠØ¯
    function addRestaurant(event) {
      event.preventDefault();
      
      const restaurants = JSON.parse(localStorage.getItem('restaurants') || '[]');
      const newRestaurantId = restaurants.length > 0 ? Math.max(...restaurants.map(r => r.id)) + 1 : 1;
      
      const newRestaurant = {
        id: newRestaurantId,
        name: document.getElementById('restaurantNameInput').value,
        address: document.getElementById('restaurantAddressInput').value,
        phone: document.getElementById('restaurantPhoneInput').value,
        type: document.getElementById('restaurantTypeInput').value
      };
      
      restaurants.push(newRestaurant);
      localStorage.setItem('restaurants', JSON.stringify(restaurants));
      
      // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª ÙˆÙ‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø·Ø§Ø¹Ù…
      updateStats();
      updateRestaurantsDropdown();
      loadRestaurantsPage();
      
      // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø©
      const modal = bootstrap.Modal.getInstance(document.getElementById('addRestaurantModal'));
      modal.hide();
    }
    
    // Ø¹Ø±Ø¶ Ù†Ø§ÙØ°Ø© Ø¥Ø¶Ø§ÙØ© Ù…Ø·Ø¹Ù… Ø¬Ø¯ÙŠØ¯
    function showAddRestaurantModal() {
      // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
      document.getElementById('addRestaurantForm').reset();
      
      // ÙØªØ­ Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø©
      const modal = new bootstrap.Modal(document.getElementById('addRestaurantModal'));
      modal.show();
    }
    
    // Ø¥Ø¶Ø§ÙØ© ØµÙ†Ù Ø¬Ø¯ÙŠØ¯
    function addItem(event) {
      event.preventDefault();
      
      const items = JSON.parse(localStorage.getItem('items') || '[]');
      const newItemId = items.length > 0 ? Math.max(...items.map(i => i.id)) + 1 : 1;
      
      const newItem = {
        id: newItemId,
        name: document.getElementById('itemNameInput').value,
        description: document.getElementById('itemDescriptionInput').value,
        price: parseFloat(document.getElementById('itemPriceInput').value),
        restaurantId: parseInt(document.getElementById('itemRestaurantInput').value)
      };
      
      items.push(newItem);
      localStorage.setItem('items', JSON.stringify(items));
      
      // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
      updateStats();
      
      // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø©
      const modal = bootstrap.Modal.getInstance(document.getElementById('addItemModal'));
      modal.hide();
    }
    
    // Ø¹Ø±Ø¶ Ù†Ø§ÙØ°Ø© Ø¥Ø¶Ø§ÙØ© ØµÙ†Ù Ø¬Ø¯ÙŠØ¯
    function showAddItemModal() {
      // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
      document.getElementById('addItemForm').reset();
      
      // ØªØ­Ø¯ÙŠØ« Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø·Ø§Ø¹Ù…
      updateRestaurantsDropdown();
      
      // ÙØªØ­ Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø©
      const modal = new bootstrap.Modal(document.getElementById('addItemModal'));
      modal.show();
    }
    
    // ØªØ­Ù…ÙŠÙ„ ØµÙØ­Ø© Ø§Ù„ÙÙ†ÙŠÙŠÙ†
    function loadTechniciansPage() {
      const technicians = JSON.parse(localStorage.getItem('technicians') || '[]');
      populateTechnicianSpecialtyFilter();
      renderTechniciansList(technicians);
    }
    
    // Ø¹Ø±Ø¶ Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„ÙÙ†ÙŠ
    function showTechnicianStats(technicianId) {
      const technicians = JSON.parse(localStorage.getItem('technicians') || '[]');
      const technician = technicians.find(t => t.id === technicianId);
      if (!technician) {
        alert('Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„ÙÙ†ÙŠ');
        return;
      }
      const orders = JSON.parse(localStorage.getItem('orders') || '[]');
      // Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù…Ø±ØªØ¨Ø·Ø© Ø¨Ø§Ù„ÙÙ†ÙŠ (Ø¨Ø§Ø³ØªØ«Ù†Ø§Ø¡ Ø§Ù„Ù…Ø®ÙÙŠØ©)
      const allOrders = orders.filter(order => order.assignedId == technicianId && !order.isHidden);
      
      // Ø­Ø³Ø§Ø¨ Ø­ØµØ© Ø§Ù„Ø´Ø±ÙƒØ© ÙˆØ§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰
      const completedOrders = allOrders.filter(order => order.status === 'ØªÙ… Ø§Ù„ØªÙˆØµÙŠÙ„');
      const totalCompanyShare = completedOrders.reduce((sum, order) => {
        return sum + (parseFloat(order.amount) * 0.25);
      }, 0);
      const MAX_COMPANY_SHARE = 300;
      const remainingShare = MAX_COMPANY_SHARE - totalCompanyShare;
      const isLimitReached = totalCompanyShare >= MAX_COMPANY_SHARE;
      
      // Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø­Ø³Ø¨ Ø§Ù„Ø­Ø§Ù„Ø©
      const statusCounts = {
        'Ø¬Ø¯ÙŠØ¯': 0,
        'Ù‚ÙŠØ¯ Ø§Ù„ØªÙ†ÙÙŠØ°': 0,
        'Ù…Ø¤Ø¬Ù„': 0,
        'ØªÙ… Ø§Ù„ØªÙˆØµÙŠÙ„': 0,
        'Ù…Ù„ØºÙŠ': 0
      };
      allOrders.forEach(order => {
        if (statusCounts.hasOwnProperty(order.status)) {
          statusCounts[order.status]++;
        }
      });
      
      const totalOrdersCount = allOrders.length;
      const totalAmount = completedOrders.reduce((sum, order) => sum + parseFloat(order.amount || 0), 0);
      const companyShare = totalAmount / 4; // Ø­ØµØ© Ø§Ù„Ø´Ø±ÙƒØ© (25%)
      const technicianShare = totalAmount - companyShare; // Ø­ØµØ© Ø§Ù„ÙÙ†ÙŠ (75%)
      // Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø©
      const statsHTML = `
        <div class="mb-3">
          <h6 class="fw-bold mb-3 text-center">Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„ÙÙ†ÙŠ: ${technician.name}</h6>
          <div class="mb-2 text-end">
            <button class="btn btn-sm btn-success" onclick="filterAndExportTechnicianOrders(${technician.id})"><i class="bi bi-funnel"></i> ØªØµÙÙŠØ© ÙˆØªØµØ¯ÙŠØ±</button>
          </div>
          <div class="table-responsive mb-3">
            <table class="table table-bordered table-sm text-center">
              <thead class="bg-light">
                <tr>
                  <th>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø·Ù„Ø¨Ø§Øª</th>
                  <th>Ø¬Ø¯ÙŠØ¯</th>
                  <th>Ù‚ÙŠØ¯ Ø§Ù„ØªÙ†ÙÙŠØ°</th>
                  <th>Ù…Ø¤Ø¬Ù„</th>
                  <th>ØªÙ… Ø§Ù„ØªÙˆØµÙŠÙ„</th>
                  <th>Ù…Ù„ØºÙŠ</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td class="fw-bold">${totalOrdersCount}</td>
                  <td>${statusCounts['Ø¬Ø¯ÙŠØ¯']}</td>
                  <td>${statusCounts['Ù‚ÙŠØ¯ Ø§Ù„ØªÙ†ÙÙŠØ°']}</td>
                  <td>${statusCounts['Ù…Ø¤Ø¬Ù„']}</td>
                  <td>${statusCounts['ØªÙ… Ø§Ù„ØªÙˆØµÙŠÙ„']}</td>
                  <td>${statusCounts['Ù…Ù„ØºÙŠ']}</td>
                </tr>
              </tbody>
            </table>
          </div>
          <div class="table-responsive">
            <table class="table table-bordered">
              <tr>
                <th class="bg-light">Ø¹Ø¯Ø¯ Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù…ÙƒØªÙ…Ù„Ø©</th>
                <td class="text-center fw-bold">${completedOrders.length}</td>
              </tr>
              <tr>
                <th class="bg-light">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø¨Ù„Øº</th>
                <td class="text-center fw-bold">${totalAmount} Ø¬</td>
              </tr>
              <tr>
                <th class="bg-light">Ø­ØµØ© Ø§Ù„Ø´Ø±ÙƒØ© (25%)</th>
                <td class="text-center fw-bold">${companyShare.toFixed(2)} Ø¬</td>
              </tr>
              <tr>
                <th class="bg-light">Ø­ØµØ© Ø§Ù„ÙÙ†ÙŠ (75%)</th>
                <td class="text-center fw-bold">${technicianShare.toFixed(2)} Ø¬</td>
              </tr>
              <tr class="${isLimitReached ? 'table-danger' : 'table-success'}">
                <th class="bg-light">Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ Ù„Ù„Ø´Ø±ÙƒØ©</th>
                <td class="text-center fw-bold">${totalCompanyShare.toFixed(2)} Ø¬ / ${MAX_COMPANY_SHARE} Ø¬</td>
              </tr>
              <tr class="${isLimitReached ? 'table-danger' : 'table-success'}">
                <th class="bg-light">Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ</th>
                <td class="text-center fw-bold">${remainingShare.toFixed(2)} Ø¬</td>
              </tr>
              <tr class="${isLimitReached ? 'table-danger' : 'table-success'}">
                <th class="bg-light">Ø§Ù„Ø­Ø§Ù„Ø©</th>
                <td class="text-center fw-bold">${isLimitReached ? 'Ù…Ù…Ù†ÙˆØ¹ Ø§Ù„ØªØ¹Ø§Ù…Ù„' : 'Ù…Ø³Ù…ÙˆØ­ Ø§Ù„ØªØ¹Ø§Ù…Ù„'}</td>
              </tr>
            </table>
          </div>
          <div class="mt-3">
            <h6 class="mb-2">ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø·Ù„Ø¨Ø§Øª:</h6>
            <div class="table-responsive" style="max-height: 300px; overflow-y: auto;">
              <table class="table table-sm table-striped">
                <thead>
                  <tr>
                    <th>Ø±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨</th>
                    <th>Ø§Ù„Ø¹Ù…ÙŠÙ„</th>
                    <th>Ø§Ù„ØªØ§Ø±ÙŠØ®</th>
                    <th>Ø§Ù„Ø­Ø§Ù„Ø©</th>
                    <th>Ø§Ù„Ù…Ø¨Ù„Øº</th>
                  </tr>
                </thead>
                <tbody>
                  ${allOrders.map(order => `
                    <tr>
                      <td>${order.id}</td>
                      <td>${order.customer}</td>
                      <td>${formatDate(order.date)}</td>
                      <td>${order.status}</td>
                      <td>${order.amount} Ø¬</td>
                    </tr>
                  `).join('')}
                </tbody>
              </table>
            </div>
          </div>
        </div>
      `;
      // Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø©
      const modalId = 'technicianStatsModal';
      let modal = document.getElementById(modalId);
      if (!modal) {
        modal = document.createElement('div');
        modal.className = 'modal fade';
        modal.id = modalId;
        modal.tabIndex = '-1';
        modal.innerHTML = `
          <div class="modal-dialog modal-lg">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title">Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„ÙÙ†ÙŠ</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Ø¥ØºÙ„Ø§Ù‚"></button>
              </div>
              <div class="modal-body" id="${modalId}Body">
                <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¡ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ§Ù‹ -->
              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Ø¥ØºÙ„Ø§Ù‚</button>
              </div>
            </div>
          </div>
        `;
        document.body.appendChild(modal);
      }
      document.getElementById(`${modalId}Body`).innerHTML = statsHTML;
      const bsModal = new bootstrap.Modal(modal);
      bsModal.show();
    }
    
    // ØªØµØ¯ÙŠØ± Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙÙ†ÙŠ Ø¥Ù„Ù‰ Ù…Ù„Ù Excel
    function exportTechnicianData(technicianId) {
      const technicians = JSON.parse(localStorage.getItem('technicians') || '[]');
      const technician = technicians.find(t => t.id === technicianId);
      
      if (!technician) {
        alert('Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„ÙÙ†ÙŠ');
        return;
      }
      
      const orders = JSON.parse(localStorage.getItem('orders') || '[]');
      
      // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ ØªØ§Ø±ÙŠØ® Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ (Ù…Ù† Ø§Ù„Ø¬Ù…Ø¹Ø© Ø§Ù„Ù…Ø§Ø¶ÙŠØ©)
      const today = new Date();
      const dayOfWeek = today.getDay(); // 0 Ù„Ù„Ø£Ø­Ø¯ØŒ 5 Ù„Ù„Ø¬Ù…Ø¹Ø©
      const daysToFriday = dayOfWeek >= 5 ? dayOfWeek - 5 : dayOfWeek + 2;
      const lastFriday = new Date(today);
      lastFriday.setDate(today.getDate() - daysToFriday);
      lastFriday.setHours(0, 0, 0, 0);
      
      // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ ØªØ§Ø±ÙŠØ® Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ (Ø§Ù„Ø®Ù…ÙŠØ³ Ø§Ù„Ù…Ù‚Ø¨Ù„)
      const nextThursday = new Date(lastFriday);
      nextThursday.setDate(lastFriday.getDate() + 6);
      nextThursday.setHours(23, 59, 59, 999);
      
      // ØªØµÙÙŠØ© Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø­Ø³Ø¨ Ø§Ù„ÙÙ†ÙŠ ÙˆØ§Ù„Ø£Ø³Ø¨ÙˆØ¹ (Ø¨Ø§Ø³ØªØ«Ù†Ø§Ø¡ Ø§Ù„Ù…Ø®ÙÙŠØ©)
      const weeklyOrders = orders.filter(order => {
        const orderDate = new Date(order.date);
        return order.assignedId == technicianId && 
               orderDate >= lastFriday && 
               orderDate <= nextThursday &&
               !order.isHidden;
      });
      
      // Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ§Øª
      const totalAmount = weeklyOrders.reduce((sum, order) => sum + parseFloat(order.amount || 0), 0);
      const companyShare = totalAmount / 4; // Ø­ØµØ© Ø§Ù„Ø´Ø±ÙƒØ© (25%)
      const technicianShare = totalAmount - companyShare; // Ø­ØµØ© Ø§Ù„ÙÙ†ÙŠ (75%)
      
      try {
        // Ø¥Ù†Ø´Ø§Ø¡ workbook Ø¬Ø¯ÙŠØ¯
        const wb = XLSX.utils.book_new();
        
        // Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„ØªØµØ¯ÙŠØ± Ø¨ØªÙ†Ø³ÙŠÙ‚ ÙŠÙÙ‡Ù…Ù‡ Excel
        const wsData = [
          ['ØªÙ‚Ø±ÙŠØ± Ø§Ù„ÙÙ†ÙŠ:', technician.name, '', '', 'Ø§Ù„ÙØªØ±Ø©:', `${formatDate(lastFriday)} - ${formatDate(nextThursday)}`],
          ['Ø§Ù„ØªØ®ØµØµ:', technician.specialty, '', '', 'Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ:', technician.phone],
          ['', '', '', '', '', ''],
          ['Ø±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨', 'Ø§Ù„Ø¹Ù…ÙŠÙ„', 'Ø§Ù„Ø¹Ù†ÙˆØ§Ù†', 'Ø§Ù„ØªØ§Ø±ÙŠØ®', 'Ø§Ù„Ø­Ø§Ù„Ø©', 'Ø§Ù„Ù…Ø¨Ù„Øº (Ø¬)']
        ];
        
        // Ø¥Ø¶Ø§ÙØ© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø·Ù„Ø¨Ø§Øª
        weeklyOrders.forEach(order => {
          wsData.push([
            order.id,
            order.customer,
            order.address,
            formatDate(order.date),
            order.status,
            order.amount
          ]);
        });
        
        // Ø¥Ø¶Ø§ÙØ© Ø³Ø·ÙˆØ± ÙØ§Ø±ØºØ© ÙˆØ¥Ø¬Ù…Ø§Ù„ÙŠØ§Øª
        wsData.push(['', '', '', '', '', '']);
        wsData.push(['Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ§Øª:', '', '', '', 'Ø¹Ø¯Ø¯ Ø§Ù„Ø·Ù„Ø¨Ø§Øª:', weeklyOrders.length]);
        wsData.push(['Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø¨Ù„Øº:', totalAmount + ' Ø¬', '', '', '', '']);
        wsData.push(['Ø­ØµØ© Ø§Ù„Ø´Ø±ÙƒØ© (25%):', companyShare.toFixed(2) + ' Ø¬', '', '', '', '']);
        wsData.push(['Ø­ØµØ© Ø§Ù„ÙÙ†ÙŠ (75%):', technicianShare.toFixed(2) + ' Ø¬', '', '', '', '']);
        
        // Ø¥Ù†Ø´Ø§Ø¡ ÙˆØ±Ù‚Ø© Ø¹Ù…Ù„ ÙˆØ¥Ø¶Ø§ÙØªÙ‡Ø§ Ù„Ù„Ù…ØµÙ†Ù
        const ws = XLSX.utils.aoa_to_sheet(wsData);
        
        // ØªØ·Ø¨ÙŠÙ‚ ØªÙ†Ø³ÙŠÙ‚ Ù„Ù„Ø¹Ù†Ø§ÙˆÙŠÙ†
        const headerStyle = { font: { bold: true }, alignment: { horizontal: 'center' } };
        for (let i = 0; i <= 5; i++) {
          const cellRef = XLSX.utils.encode_cell({ r: 3, c: i });
          if (!ws[cellRef]) ws[cellRef] = {};
          ws[cellRef].s = headerStyle;
        }
        
        // Ø¥Ø¶Ø§ÙØ© Ø§Ù„ÙˆØ±Ù‚Ø© Ù„Ù„Ù…ØµÙ†Ù
        XLSX.utils.book_append_sheet(wb, ws, 'ØªÙ‚Ø±ÙŠØ± Ø§Ù„ÙÙ†ÙŠ');
        
        // ØªØµØ¯ÙŠØ± Ø§Ù„Ù…ØµÙ†Ù ÙƒÙ…Ù„Ù Excel
        const filename = `ØªÙ‚Ø±ÙŠØ±_Ø§Ù„ÙÙ†ÙŠ_${technician.name}_${formatDate(lastFriday)}.xlsx`;
        XLSX.writeFile(wb, filename);
        
        alert(`ØªÙ… ØªØµØ¯ÙŠØ± Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø¨Ù†Ø¬Ø§Ø­ Ø¨Ø§Ø³Ù… "${filename}"`);
        
      } catch (error) {
        // Ø¥Ø°Ø§ Ù„Ù… ØªÙƒÙ† Ù…ÙƒØªØ¨Ø© xlsx Ù…ÙˆØ¬ÙˆØ¯Ø©ØŒ Ø§Ø³ØªØ®Ø¯Ù… Ø·Ø±ÙŠÙ‚Ø© CSV Ø§Ù„Ø¨Ø¯ÙŠÙ„Ø©
        exportToCSV(weeklyOrders, technician, totalAmount, companyShare, technicianShare, lastFriday, nextThursday, 'ÙÙ†ÙŠ');
      }
    }
    
    // Ø¥Ø¶Ø§ÙØ© ÙÙ†ÙŠ Ø¬Ø¯ÙŠØ¯
    function addTechnician(event) {
      event.preventDefault();
      
      const technicianPhone = document.getElementById('technicianPhoneInput').value;
      
      // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ
      if (!technicianPhone) {
        alert('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ù‡Ø§ØªÙ Ù„Ù„ÙÙ†ÙŠ');
        return;
      }
      
      const technicians = JSON.parse(localStorage.getItem('technicians') || '[]');
      const newTechnicianId = technicians.length > 0 ? Math.max(...technicians.map(t => t.id)) + 1 : 1;
      
      // Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø±Ù‚Ù… Ø§Ù„ØªØ±ØªÙŠØ¨ Ù…Ù† Ø§Ù„Ø­Ù‚Ù„ØŒ Ø£Ùˆ ØªØ¹ÙŠÙŠÙ† Ø§Ù„ØªØ±ØªÙŠØ¨ Ø§Ù„ØªØ§Ù„ÙŠ Ø¥Ø°Ø§ Ù„Ù… ÙŠØªÙ… ØªØ­Ø¯ÙŠØ¯Ù‡
      let orderNumber = parseInt(document.getElementById('technicianOrderInput').value) || 0;
      if (orderNumber <= 0) {
        orderNumber = technicians.length > 0 ? Math.max(...technicians.map(t => t.order || 0)) + 1 : 1;
      }
      
      const newTechnician = {
        id: newTechnicianId,
        name: document.getElementById('technicianNameInput').value,
        phone: technicianPhone,
        specialty: document.getElementById('technicianSpecialtyInput').value,
        rating: (Math.random() * 2 + 3).toFixed(1), // ØªÙ‚ÙŠÙŠÙ… Ø¹Ø´ÙˆØ§Ø¦ÙŠ Ø¨ÙŠÙ† 3 Ùˆ 5
        order: orderNumber, // Ø¥Ø¶Ø§ÙØ© Ø±Ù‚Ù… Ø§Ù„ØªØ±ØªÙŠØ¨
        notes: document.getElementById('technicianNotesInput').value // Ø¥Ø¶Ø§ÙØ© Ù…Ù„Ø§Ø­Ø¸Ø§Øª
      };
      
      technicians.push(newTechnician);
      localStorage.setItem('technicians', JSON.stringify(technicians));
      
      // ØªØ­Ø¯ÙŠØ« ØµÙØ­Ø© Ø§Ù„ÙÙ†ÙŠÙŠÙ†
      loadTechniciansPage();
      loadTopLists();
      
      // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø©
      const modal = bootstrap.Modal.getInstance(document.getElementById('addTechnicianModal'));
      modal.hide();
    }
    
    // Ø¹Ø±Ø¶ Ù†Ø§ÙØ°Ø© ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„ÙÙ†ÙŠ
    function showEditTechnicianModal(technicianId) {
      const technicians = JSON.parse(localStorage.getItem('technicians') || '[]');
      const technician = technicians.find(t => t.id === technicianId);
      
      if (!technician) {
        alert('Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„ÙÙ†ÙŠ');
        return;
      }
      
      // ØªØ¹Ø¨Ø¦Ø© Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ Ø¨Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙÙ†ÙŠ
      document.getElementById('editTechnicianId').value = technician.id;
      document.getElementById('editTechnicianNameInput').value = technician.name;
      document.getElementById('editTechnicianPhoneInput').value = technician.phone;
      document.getElementById('editTechnicianSpecialtyInput').value = technician.specialty;
      document.getElementById('editTechnicianOrderInput').value = technician.order || 1;
      document.getElementById('editTechnicianNotesInput').value = technician.notes || '';
      
      // ÙØªØ­ Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø©
      const modal = new bootstrap.Modal(document.getElementById('editTechnicianModal'));
      modal.show();
    }
    
    // ØªØ­Ø¯ÙŠØ« Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙÙ†ÙŠ
    function updateTechnician(event) {
      event.preventDefault();
      
      const technicianId = parseInt(document.getElementById('editTechnicianId').value);
      const technicianPhone = document.getElementById('editTechnicianPhoneInput').value;
      
      // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ
      if (!technicianPhone) {
        alert('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ù‡Ø§ØªÙ Ù„Ù„ÙÙ†ÙŠ');
        return;
      }
      
      const technicians = JSON.parse(localStorage.getItem('technicians') || '[]');
      const technicianIndex = technicians.findIndex(t => t.id === technicianId);
      
      if (technicianIndex === -1) {
        alert('Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„ÙÙ†ÙŠ');
        return;
      }
      
      // ØªØ­Ø¯ÙŠØ« Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙÙ†ÙŠ
      technicians[technicianIndex].name = document.getElementById('editTechnicianNameInput').value;
      technicians[technicianIndex].phone = technicianPhone;
      technicians[technicianIndex].specialty = document.getElementById('editTechnicianSpecialtyInput').value;
      technicians[technicianIndex].order = parseInt(document.getElementById('editTechnicianOrderInput').value) || technicians[technicianIndex].order || 1;
      technicians[technicianIndex].notes = document.getElementById('editTechnicianNotesInput').value;
      
      localStorage.setItem('technicians', JSON.stringify(technicians));
      
      // ØªØ­Ø¯ÙŠØ« ØµÙØ­Ø© Ø§Ù„ÙÙ†ÙŠÙŠÙ†
      loadTechniciansPage();
      loadTopLists();
      
      // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø©
      const modal = bootstrap.Modal.getInstance(document.getElementById('editTechnicianModal'));
      modal.hide();
    }
    
    // Ø¹Ø±Ø¶ Ù†Ø§ÙØ°Ø© Ø¥Ø¶Ø§ÙØ© ÙÙ†ÙŠ Ø¬Ø¯ÙŠØ¯
    function showAddTechnicianModal() {
      // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
      document.getElementById('addTechnicianForm').reset();
      
      // ØªØ­Ø¯ÙŠØ¯ Ø§Ù„ØªØ±ØªÙŠØ¨ Ø§Ù„ØªØ§Ù„ÙŠ Ø§ÙØªØ±Ø§Ø¶ÙŠÙ‹Ø§
      const technicians = JSON.parse(localStorage.getItem('technicians') || '[]');
      const nextOrder = technicians.length > 0 ? Math.max(...technicians.map(t => t.order || 0)) + 1 : 1;
      document.getElementById('technicianOrderInput').value = nextOrder;
      
      // ÙØªØ­ Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø©
      const modal = new bootstrap.Modal(document.getElementById('addTechnicianModal'));
      modal.show();
    }
    
    // Ø­Ø°Ù ÙÙ†ÙŠ
    function deleteTechnician(technicianId) {
      if (!checkSession()) {
        showAdminLoginModal();
        return;
      }
      
      if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„ÙÙ†ÙŠØŸ')) {
        const technicians = JSON.parse(localStorage.getItem('technicians') || '[]');
        const updatedTechnicians = technicians.filter(t => t.id !== technicianId);
        localStorage.setItem('technicians', JSON.stringify(updatedTechnicians));
        
        // ØªØ­Ø¯ÙŠØ« ØµÙØ­Ø© Ø§Ù„ÙÙ†ÙŠÙŠÙ†
        loadTechniciansPage();
        loadTopLists();
      }
    }
    
    // ØªØ­Ù…ÙŠÙ„ ØµÙØ­Ø© Ø§Ù„Ù…Ø·Ø§Ø¹Ù…
    function loadRestaurantsPage() {
      const restaurants = JSON.parse(localStorage.getItem('restaurants') || '[]');
      const restaurantsList = document.getElementById('restaurantsList');
      restaurantsList.innerHTML = '';
      
      if (restaurants.length === 0) {
        restaurantsList.innerHTML = '<div class="col-12 text-center py-5">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø·Ø§Ø¹Ù…</div>';
        return;
      }
      
      restaurants.forEach((restaurant, index) => {
        const card = document.createElement('div');
        card.className = 'col-md-4 col-sm-6';
        card.innerHTML = `
          <div class="card card-hover shadow-sm">
            <div class="card-body">
              <h5 class="card-title fw-bold">${restaurant.name}</h5>
              <p class="card-text text-muted mb-1">${restaurant.type}</p>
              <p class="card-text mb-1"><i class="bi bi-geo-alt me-2"></i>${restaurant.address}</p>
              <p class="card-text mb-3"><i class="bi bi-telephone me-2"></i>${restaurant.phone}</p>
              <div class="d-flex justify-content-end">
                <button class="btn btn-sm btn-outline-danger" onclick="deleteRestaurant(${restaurant.id})"><i class="bi bi-trash"></i></button>
              </div>
            </div>
          </div>
        `;
        restaurantsList.appendChild(card);
      });
    }
    
    // Ø­Ø°Ù Ù…Ø·Ø¹Ù…
    function deleteRestaurant(restaurantId) {
      if (!checkSession()) {
        showAdminLoginModal();
        return;
      }
      
      if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ù…Ø·Ø¹Ù…ØŸ')) {
        const restaurants = JSON.parse(localStorage.getItem('restaurants') || '[]');
        const updatedRestaurants = restaurants.filter(r => r.id !== restaurantId);
        localStorage.setItem('restaurants', JSON.stringify(updatedRestaurants));
        
        // ØªØ­Ø¯ÙŠØ« ØµÙØ­Ø© Ø§Ù„Ù…Ø·Ø§Ø¹Ù…
        loadRestaurantsPage();
      }
    }
    
    // ØªØ­Ù…ÙŠÙ„ ØµÙØ­Ø© Ø§Ù„Ù…Ù†Ø§Ø¯ÙŠØ¨
    function loadDeliverymenPage() {
      const deliverymen = JSON.parse(localStorage.getItem('deliverymen') || '[]');
      const deliverymenList = document.getElementById('deliverymenList');
      deliverymenList.innerHTML = '';
      
      if (deliverymen.length === 0) {
        deliverymenList.innerHTML = '<div class="col-12 text-center py-5">Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ù†Ø§Ø¯ÙŠØ¨</div>';
        return;
      }
      
      deliverymen.forEach((deliveryman, index) => {
        const card = document.createElement('div');
        card.className = 'col-md-4 col-sm-6';
        card.innerHTML = `
          <div class="card card-hover shadow-sm mb-3">
            <div class="card-body">
              <div class="d-flex align-items-center mb-3">
                <img src="https://randomuser.me/api/portraits/men/${13 + index}.jpg" class="user-avatar me-3" alt="deliveryman" style="width: 50px; height: 50px;">
                <div>
                  <h6 class="mb-0 fw-bold">${deliveryman.name}</h6>
                  <small class="text-muted">${deliveryman.vehicle}</small>
                </div>
              </div>
              <div class="d-flex justify-content-between align-items-center">
                <div>
                  <p class="mb-0"><i class="bi bi-telephone me-2"></i>${deliveryman.phone}</p>
                  <p class="mb-0"><i class="bi bi-star-fill me-2 text-warning"></i>${deliveryman.rating || 0}</p>
                </div>
                <div>
                  <button class="btn btn-sm btn-outline-info mb-1" onclick="showDeliverymanStats(${deliveryman.id})"><i class="bi bi-graph-up"></i> Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª</button>
                  <button class="btn btn-sm btn-outline-success mb-1" onclick="exportDeliverymanData(${deliveryman.id})"><i class="bi bi-file-excel"></i> ØªØµØ¯ÙŠØ±</button>
                  <button class="btn btn-sm btn-outline-danger" onclick="deleteDeliveryman(${deliveryman.id})"><i class="bi bi-trash"></i></button>
                </div>
              </div>
            </div>
          </div>
        `;
        deliverymenList.appendChild(card);
      });
    }
    
    // Ø¹Ø±Ø¶ Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨
    function showDeliverymanStats(deliverymanId) {
      const deliverymen = JSON.parse(localStorage.getItem('deliverymen') || '[]');
      const deliveryman = deliverymen.find(d => d.id === deliverymanId);
      
      if (!deliveryman) {
        alert('Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨');
        return;
      }
      
      const orders = JSON.parse(localStorage.getItem('orders') || '[]');
      const completedOrders = orders.filter(order => 
        order.assignedId == deliverymanId && 
        order.status === 'ØªÙ… Ø§Ù„ØªÙˆØµÙŠÙ„'
      );
      
      const totalOrdersCount = completedOrders.length;
      const totalAmount = completedOrders.reduce((sum, order) => sum + parseFloat(order.amount || 0), 0);
      const companyShare = totalAmount / 4; // Ø­ØµØ© Ø§Ù„Ø´Ø±ÙƒØ© (25%)
      const deliverymanShare = totalAmount - companyShare; // Ø­ØµØ© Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨ (75%)
      
      // Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø©
      const statsHTML = `
        <div class="mb-3">
          <h6 class="fw-bold mb-3 text-center">Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨: ${deliveryman.name}</h6>
          
          <div class="table-responsive">
            <table class="table table-bordered">
              <tr>
                <th class="bg-light">Ø¹Ø¯Ø¯ Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù…ÙƒØªÙ…Ù„Ø©</th>
                <td class="text-center fw-bold">${totalOrdersCount}</td>
              </tr>
              <tr>
                <th class="bg-light">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø¨Ù„Øº</th>
                <td class="text-center fw-bold">${totalAmount} Ø¬</td>
              </tr>
              <tr>
                <th class="bg-light">Ø­ØµØ© Ø§Ù„Ø´Ø±ÙƒØ© (25%)</th>
                <td class="text-center fw-bold">${companyShare.toFixed(2)} Ø¬</td>
              </tr>
              <tr>
                <th class="bg-light">Ø­ØµØ© Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨ (75%)</th>
                <td class="text-center fw-bold">${deliverymanShare.toFixed(2)} Ø¬</td>
              </tr>
            </table>
          </div>
          
          <div class="mt-3">
            <h6 class="mb-2">ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø·Ù„Ø¨Ø§Øª:</h6>
            <div class="table-responsive" style="max-height: 300px; overflow-y: auto;">
              <table class="table table-sm table-striped">
                <thead>
                  <tr>
                    <th>Ø±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨</th>
                    <th>Ø§Ù„Ø¹Ù…ÙŠÙ„</th>
                    <th>Ø§Ù„ØªØ§Ø±ÙŠØ®</th>
                    <th>Ø§Ù„Ù…Ø¨Ù„Øº</th>
                  </tr>
                </thead>
                <tbody>
                  ${completedOrders.map(order => `
                    <tr>
                      <td>${order.id}</td>
                      <td>${order.customer}</td>
                      <td>${formatDate(order.date)}</td>
                      <td>${order.amount} Ø¬</td>
                    </tr>
                  `).join('')}
                </tbody>
              </table>
            </div>
          </div>
        </div>
      `;
      
      // Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø©
      const modalId = 'deliverymanStatsModal';
      let modal = document.getElementById(modalId);
      
      if (!modal) {
        // Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø© Ø¥Ø°Ø§ Ù„Ù… ØªÙƒÙ† Ù…ÙˆØ¬ÙˆØ¯Ø©
        modal = document.createElement('div');
        modal.className = 'modal fade';
        modal.id = modalId;
        modal.tabIndex = '-1';
        modal.innerHTML = `
          <div class="modal-dialog modal-lg">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title">Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Ø¥ØºÙ„Ø§Ù‚"></button>
              </div>
              <div class="modal-body" id="${modalId}Body">
                <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¡ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ§Ù‹ -->
              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Ø¥ØºÙ„Ø§Ù‚</button>
              </div>
            </div>
          </div>
        `;
        document.body.appendChild(modal);
      }
      
      // Ù…Ù„Ø¡ Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø©
      document.getElementById(`${modalId}Body`).innerHTML = statsHTML;
      
      // Ø¹Ø±Ø¶ Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø©
      const bsModal = new bootstrap.Modal(modal);
      bsModal.show();
    }
    
    // ØªØµØ¯ÙŠØ± Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨ Ø¥Ù„Ù‰ Ù…Ù„Ù Excel
    function exportDeliverymanData(deliverymanId) {
      const deliverymen = JSON.parse(localStorage.getItem('deliverymen') || '[]');
      const deliveryman = deliverymen.find(d => d.id === deliverymanId);
      
      if (!deliveryman) {
        alert('Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨');
        return;
      }
      
      const orders = JSON.parse(localStorage.getItem('orders') || '[]');
      
      // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ ØªØ§Ø±ÙŠØ® Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ (Ù…Ù† Ø§Ù„Ø¬Ù…Ø¹Ø© Ø§Ù„Ù…Ø§Ø¶ÙŠØ©)
      const today = new Date();
      const dayOfWeek = today.getDay(); // 0 Ù„Ù„Ø£Ø­Ø¯ØŒ 5 Ù„Ù„Ø¬Ù…Ø¹Ø©
      const daysToFriday = dayOfWeek >= 5 ? dayOfWeek - 5 : dayOfWeek + 2;
      const lastFriday = new Date(today);
      lastFriday.setDate(today.getDate() - daysToFriday);
      lastFriday.setHours(0, 0, 0, 0);
      
      // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ ØªØ§Ø±ÙŠØ® Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ (Ø§Ù„Ø®Ù…ÙŠØ³ Ø§Ù„Ù…Ù‚Ø¨Ù„)
      const nextThursday = new Date(lastFriday);
      nextThursday.setDate(lastFriday.getDate() + 6);
      nextThursday.setHours(23, 59, 59, 999);
      
      // ØªØµÙÙŠØ© Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø­Ø³Ø¨ Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨ ÙˆØ§Ù„Ø£Ø³Ø¨ÙˆØ¹
      const weeklyOrders = orders.filter(order => {
        const orderDate = new Date(order.date);
        return order.assignedId == deliverymanId && 
               orderDate >= lastFriday && 
               orderDate <= nextThursday;
      });
      
      // Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ§Øª
      const totalAmount = weeklyOrders.reduce((sum, order) => sum + parseFloat(order.amount || 0), 0);
      const companyShare = totalAmount / 4; // Ø­ØµØ© Ø§Ù„Ø´Ø±ÙƒØ© (25%)
      const deliverymanShare = totalAmount - companyShare; // Ø­ØµØ© Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨ (75%)
      
      try {
        // Ø¥Ù†Ø´Ø§Ø¡ workbook Ø¬Ø¯ÙŠØ¯
        const wb = XLSX.utils.book_new();
        
        // Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„ØªØµØ¯ÙŠØ± Ø¨ØªÙ†Ø³ÙŠÙ‚ ÙŠÙÙ‡Ù…Ù‡ Excel
        const wsData = [
          ['ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨:', deliveryman.name, '', '', 'Ø§Ù„ÙØªØ±Ø©:', `${formatDate(lastFriday)} - ${formatDate(nextThursday)}`],
          ['ÙˆØ³ÙŠÙ„Ø© Ø§Ù„Ù†Ù‚Ù„:', deliveryman.vehicle, '', '', 'Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ:', deliveryman.phone],
          ['', '', '', '', '', ''],
          ['Ø±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨', 'Ø§Ù„Ø¹Ù…ÙŠÙ„', 'Ø§Ù„Ø¹Ù†ÙˆØ§Ù†', 'Ø§Ù„ØªØ§Ø±ÙŠØ®', 'Ø§Ù„Ø­Ø§Ù„Ø©', 'Ø§Ù„Ù…Ø¨Ù„Øº (Ø¬)']
        ];
        
        // Ø¥Ø¶Ø§ÙØ© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø·Ù„Ø¨Ø§Øª
        weeklyOrders.forEach(order => {
          wsData.push([
            order.id,
            order.customer,
            order.address,
            formatDate(order.date),
            order.status,
            order.amount
          ]);
        });
        
        // Ø¥Ø¶Ø§ÙØ© Ø³Ø·ÙˆØ± ÙØ§Ø±ØºØ© ÙˆØ¥Ø¬Ù…Ø§Ù„ÙŠØ§Øª
        wsData.push(['', '', '', '', '', '']);
        wsData.push(['Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ§Øª:', '', '', '', 'Ø¹Ø¯Ø¯ Ø§Ù„Ø·Ù„Ø¨Ø§Øª:', weeklyOrders.length]);
        wsData.push(['Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø¨Ù„Øº:', totalAmount + ' Ø¬', '', '', '', '']);
        wsData.push(['Ø­ØµØ© Ø§Ù„Ø´Ø±ÙƒØ© (25%):', companyShare.toFixed(2) + ' Ø¬', '', '', '', '']);
        wsData.push(['Ø­ØµØ© Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨ (75%):', deliverymanShare.toFixed(2) + ' Ø¬', '', '', '', '']);
        
        // Ø¥Ù†Ø´Ø§Ø¡ ÙˆØ±Ù‚Ø© Ø¹Ù…Ù„ ÙˆØ¥Ø¶Ø§ÙØªÙ‡Ø§ Ù„Ù„Ù…ØµÙ†Ù
        const ws = XLSX.utils.aoa_to_sheet(wsData);
        
        // ØªØ·Ø¨ÙŠÙ‚ ØªÙ†Ø³ÙŠÙ‚ Ù„Ù„Ø¹Ù†Ø§ÙˆÙŠÙ†
        const headerStyle = { font: { bold: true }, alignment: { horizontal: 'center' } };
        for (let i = 0; i <= 5; i++) {
          const cellRef = XLSX.utils.encode_cell({ r: 3, c: i });
          if (!ws[cellRef]) ws[cellRef] = {};
          ws[cellRef].s = headerStyle;
        }
        
        // Ø¥Ø¶Ø§ÙØ© Ø§Ù„ÙˆØ±Ù‚Ø© Ù„Ù„Ù…ØµÙ†Ù
        XLSX.utils.book_append_sheet(wb, ws, 'ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨');
        
        // ØªØµØ¯ÙŠØ± Ø§Ù„Ù…ØµÙ†Ù ÙƒÙ…Ù„Ù Excel
        const filename = `ØªÙ‚Ø±ÙŠØ±_Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨_${deliveryman.name}_${formatDate(lastFriday)}.xlsx`;
        XLSX.writeFile(wb, filename);
        
        alert(`ØªÙ… ØªØµØ¯ÙŠØ± Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø¨Ù†Ø¬Ø§Ø­ Ø¨Ø§Ø³Ù… "${filename}"`);
        
      } catch (error) {
        // Ø¥Ø°Ø§ Ù„Ù… ØªÙƒÙ† Ù…ÙƒØªØ¨Ø© xlsx Ù…ÙˆØ¬ÙˆØ¯Ø©ØŒ Ø§Ø³ØªØ®Ø¯Ù… Ø·Ø±ÙŠÙ‚Ø© CSV Ø§Ù„Ø¨Ø¯ÙŠÙ„Ø©
        exportToCSV(weeklyOrders, deliveryman, totalAmount, companyShare, deliverymanShare, lastFriday, nextThursday, 'Ù…Ù†Ø¯ÙˆØ¨');
      }
    }
    
    // Ø¥Ø¶Ø§ÙØ© Ù…Ù†Ø¯ÙˆØ¨ Ø¬Ø¯ÙŠØ¯
    function addDeliveryman(event) {
      event.preventDefault();
      
      const deliverymanPhone = document.getElementById('deliverymanPhoneInput').value;
      
      // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ
      if (!deliverymanPhone) {
        alert('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ù‡Ø§ØªÙ Ù„Ù„Ù…Ù†Ø¯ÙˆØ¨');
        return;
      }
      
      const deliverymen = JSON.parse(localStorage.getItem('deliverymen') || '[]');
      const newDeliverymanId = deliverymen.length > 0 ? Math.max(...deliverymen.map(d => d.id)) + 1 : 1;
      
      const newDeliveryman = {
        id: newDeliverymanId,
        name: document.getElementById('deliverymanNameInput').value,
        phone: deliverymanPhone,
        vehicle: document.getElementById('deliverymanVehicleInput').value,
        rating: (Math.random() * 2 + 3).toFixed(1) // ØªÙ‚ÙŠÙŠÙ… Ø¹Ø´ÙˆØ§Ø¦ÙŠ Ø¨ÙŠÙ† 3 Ùˆ 5
      };
      
      deliverymen.push(newDeliveryman);
      localStorage.setItem('deliverymen', JSON.stringify(deliverymen));
      
      // ØªØ­Ø¯ÙŠØ« ØµÙØ­Ø© Ø§Ù„Ù…Ù†Ø§Ø¯ÙŠØ¨
      loadDeliverymenPage();
      loadTopLists();
      
      // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø©
      const modal = bootstrap.Modal.getInstance(document.getElementById('addDeliverymanModal'));
      modal.hide();
    }
    
    // Ø¹Ø±Ø¶ Ù†Ø§ÙØ°Ø© Ø¥Ø¶Ø§ÙØ© Ù…Ù†Ø¯ÙˆØ¨ Ø¬Ø¯ÙŠØ¯
    function showAddDeliverymanModal() {
      // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
      document.getElementById('addDeliverymanForm').reset();
      
      // ÙØªØ­ Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø©
      const modal = new bootstrap.Modal(document.getElementById('addDeliverymanModal'));
      modal.show();
    }
    
    // Ø­Ø°Ù Ù…Ù†Ø¯ÙˆØ¨
    function deleteDeliveryman(deliverymanId) {
      if (!checkSession()) {
        showAdminLoginModal();
        return;
      }
      
      if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨ØŸ')) {
        const deliverymen = JSON.parse(localStorage.getItem('deliverymen') || '[]');
        const updatedDeliverymen = deliverymen.filter(d => d.id !== deliverymanId);
        localStorage.setItem('deliverymen', JSON.stringify(updatedDeliverymen));
        
        // ØªØ­Ø¯ÙŠØ« ØµÙØ­Ø© Ø§Ù„Ù…Ù†Ø§Ø¯ÙŠØ¨
        loadDeliverymenPage();
        loadTopLists();
      }
    }
    
    // ØªØ­Ù…ÙŠÙ„ ØµÙØ­Ø© Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡
    function loadCustomersPage() {
      const customers = JSON.parse(localStorage.getItem('customers') || '[]');
      const customersTableBody = document.getElementById('customersTableBody');
      customersTableBody.innerHTML = '';
      
      if (customers.length === 0) {
        customersTableBody.innerHTML = '<tr><td colspan="5" class="text-center">Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø¹Ù…Ù„Ø§Ø¡</td></tr>';
        return;
      }
      
      customers.forEach(customer => {
        const row = document.createElement('tr');
        row.innerHTML = `
          <td>${customer.name}</td>
          <td>${customer.phone}</td>
          <td>${customer.address}</td>
          <td>${customer.orders || 0}</td>
          <td>
            <button class="btn btn-sm btn-outline-info" onclick="showCustomerTransactions(${customer.id})"><i class="bi bi-list"></i> Ù…Ø¹Ø§Ù…Ù„Ø§Øª</button>
            <button class="btn btn-sm btn-outline-danger" onclick="deleteCustomer(${customer.id})"><i class="bi bi-trash"></i></button>
          </td>
        `;
        customersTableBody.appendChild(row);
      });
    }
    
    // Ø¥Ø¶Ø§ÙØ© Ø¹Ù…ÙŠÙ„ Ø¬Ø¯ÙŠØ¯
    function addCustomer(event) {
      event.preventDefault();
      
      const customers = JSON.parse(localStorage.getItem('customers') || '[]');
      const newCustomerId = customers.length > 0 ? Math.max(...customers.map(c => c.id)) + 1 : 1;
      
      const newCustomer = {
        id: newCustomerId,
        name: document.getElementById('customerNameInput').value,
        phone: document.getElementById('customerPhoneInput').value,
        address: document.getElementById('customerAddressInput').value,
        orders: 0
      };
      
      customers.push(newCustomer);
      localStorage.setItem('customers', JSON.stringify(customers));
      
      // ØªØ­Ø¯ÙŠØ« ØµÙØ­Ø© Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡
      loadCustomersPage();
      updateStats();
      loadTopLists();
      
      // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø©
      const modal = bootstrap.Modal.getInstance(document.getElementById('addCustomerModal'));
      modal.hide();
    }
    
    // Ø¹Ø±Ø¶ Ù†Ø§ÙØ°Ø© Ø¥Ø¶Ø§ÙØ© Ø¹Ù…ÙŠÙ„ Ø¬Ø¯ÙŠØ¯
    function showAddCustomerModal() {
      // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
      document.getElementById('addCustomerForm').reset();
      
      // ÙØªØ­ Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø©
      const modal = new bootstrap.Modal(document.getElementById('addCustomerModal'));
      modal.show();
    }
    
    // Ø­Ø°Ù Ø¹Ù…ÙŠÙ„
    function deleteCustomer(customerId) {
      if (!checkSession()) {
        showAdminLoginModal();
        return;
      }
      
      if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ø¹Ù…ÙŠÙ„ØŸ')) {
        const customers = JSON.parse(localStorage.getItem('customers') || '[]');
        const updatedCustomers = customers.filter(c => c.id !== customerId);
        localStorage.setItem('customers', JSON.stringify(updatedCustomers));
        
        // ØªØ­Ø¯ÙŠØ« ØµÙØ­Ø© Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡
        loadCustomersPage();
        updateStats();
        loadTopLists();
      }
    }
    
    // ØªØµÙÙŠØ© Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡
    function filterCustomers() {
      const searchTerm = document.getElementById('customerSearchInput').value.toLowerCase();
      
      const customers = JSON.parse(localStorage.getItem('customers') || '[]');
      const filteredCustomers = customers.filter(customer => {
        return customer.name.toLowerCase().includes(searchTerm) || 
               customer.phone.includes(searchTerm) ||
               customer.address.toLowerCase().includes(searchTerm);
      });
      
      const customersTableBody = document.getElementById('customersTableBody');
      customersTableBody.innerHTML = '';
      
      if (filteredCustomers.length === 0) {
        customersTableBody.innerHTML = '<tr><td colspan="5" class="text-center">Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø¹Ù…Ù„Ø§Ø¡ Ù…Ø·Ø§Ø¨Ù‚ÙŠÙ†</td></tr>';
        return;
      }
      
      filteredCustomers.forEach(customer => {
        const row = document.createElement('tr');
        row.innerHTML = `
          <td>${customer.name}</td>
          <td>${customer.phone}</td>
          <td>${customer.address}</td>
          <td>${customer.orders || 0}</td>
          <td>
            <button class="btn btn-sm btn-outline-info" onclick="showCustomerTransactions(${customer.id})"><i class="bi bi-list"></i> Ù…Ø¹Ø§Ù…Ù„Ø§Øª</button>
            <button class="btn btn-sm btn-outline-danger" onclick="deleteCustomer(${customer.id})"><i class="bi bi-trash"></i></button>
          </td>
        `;
        customersTableBody.appendChild(row);
      });
    }
    
    // Ø§Ø¶Ø§ÙØ© ÙˆØ¸ÙŠÙØ© Ø¹Ø±Ø¶ Ù†Ù…ÙˆØ°Ø¬ ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø·Ù„Ø¨
    function showEditOrderModal(orderId) {
      const orders = JSON.parse(localStorage.getItem('orders') || '[]');
      const order = orders.find(o => o.id === orderId);
      
      if (order) {
        // ØªØ­Ø¯ÙŠØ« Ù‚Ø§Ø¦Ù…Ø© Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ø®Ø¯Ù…Ø§Øª Ø£ÙˆÙ„Ø§Ù‹
        updateServiceTypesDropdown();
        
        // Ù…Ù„Ø¡ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ Ø¨Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø·Ù„Ø¨
        document.getElementById('orderIdInput').value = order.id;
        document.getElementById('orderCustomerInput').value = order.customer;
        document.getElementById('orderPhoneInput').value = order.phone;
        document.getElementById('orderAddressInput').value = order.address;
        document.getElementById('orderServiceTypeInput').value = order.serviceType;
        
        // ØªØ­Ø¯ÙŠØ« Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ÙÙ†ÙŠÙŠÙ† Ø£Ùˆ Ø§Ù„Ù…Ù†Ø§Ø¯ÙŠØ¨
        updateOrderTechniciansDropdown();
        
        // ØªØ¹ÙŠÙŠÙ† Ø§Ù„ÙÙ†ÙŠ Ø£Ùˆ Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨ Ø§Ù„Ù…Ø®ØªØ§Ø±
        setTimeout(() => {
          document.getElementById('orderAssignedInput').value = order.assignedId;
        }, 100);
        
        document.getElementById('orderCountInput').value = order.count;
        document.getElementById('orderAmountInput').value = order.amount;
        document.getElementById('orderStatusInput').value = order.status;
        document.getElementById('orderNotesInput').value = order.notes || '';
        
        // ØªØºÙŠÙŠØ± Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø© ÙˆØ²Ø± Ø§Ù„Ø­ÙØ¸
        document.getElementById('addOrderModalLabel').textContent = 'ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø·Ù„Ø¨';
        document.querySelector('#addOrderForm button[type="submit"]').textContent = 'Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª';
        
        // ØªØºÙŠÙŠØ± ÙˆØ¸ÙŠÙØ© Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ Ù„ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø·Ù„Ø¨ Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† Ø¥Ø¶Ø§ÙØ© Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯
        document.getElementById('addOrderForm').onsubmit = function(event) {
          updateOrder(event, orderId);
        };
        
        // ÙØªØ­ Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø©
        const modal = new bootstrap.Modal(document.getElementById('addOrderModal'));
        modal.show();
      }
    }
    
    // Ø¯Ø§Ù„Ø© Ø§Ù„ØªÙˆØ§ØµÙ„ Ø¹Ø¨Ø± Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨ Ù…Ø¹ Ø§Ù„ÙÙ†ÙŠ Ø£Ùˆ Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨ Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ Ø¹Ù† Ø§Ù„Ø·Ù„Ø¨
    function contactViaWhatsApp(orderId) {
      const orders = JSON.parse(localStorage.getItem('orders') || '[]');
      const order = orders.find(o => o.id === orderId);
      
      if (!order) {
        alert('Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„Ø·Ù„Ø¨');
        return;
      }
      
      let phone = '';
      let name = '';
      
      // Ø¬Ù„Ø¨ Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ Ù„Ù„ÙÙ†ÙŠ Ø£Ùˆ Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨ Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ assignedId
      // Ø£ÙˆÙ„Ø§Ù‹ Ø§Ø¨Ø­Ø« ÙÙŠ Ø§Ù„ÙÙ†ÙŠÙŠÙ†
      const technicians = JSON.parse(localStorage.getItem('technicians') || '[]');
      let person = technicians.find(t => t.id == order.assignedId);
      if (person) {
        phone = person.phone;
        name = person.name;
      } else {
        // Ø¥Ø°Ø§ Ù„Ù… ÙŠÙˆØ¬Ø¯ ÙÙŠ Ø§Ù„ÙÙ†ÙŠÙŠÙ†ØŒ Ø§Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ù…Ù†Ø§Ø¯ÙŠØ¨
        const deliverymen = JSON.parse(localStorage.getItem('deliverymen') || '[]');
        person = deliverymen.find(d => d.id == order.assignedId);
        if (person) {
          phone = person.phone;
          name = person.name;
        } else {
          // ÙƒØ®Ø·Ø© Ø¨Ø¯ÙŠÙ„Ø©: Ø§Ø¨Ø­Ø« Ø¨Ø§Ù„Ø§Ø³Ù… ÙÙŠ Ø§Ù„ÙÙ†ÙŠÙŠÙ† Ø£Ùˆ Ø§Ù„Ù…Ù†Ø§Ø¯ÙŠØ¨
          person = technicians.find(t => t.name === order.assigned);
          if (person) {
            phone = person.phone;
            name = person.name;
          } else {
            person = deliverymen.find(d => d.name === order.assigned);
            if (person) {
              phone = person.phone;
              name = person.name;
            }
          }
        }
      }
      
      if (!phone) {
        alert('Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ ØºÙŠØ± Ù…ØªÙˆÙØ± Ù„Ù„ÙÙ†ÙŠ Ø£Ùˆ Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨');
        return;
      }
      
      // ØªÙ†Ø³ÙŠÙ‚ Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ ÙˆØ¥Ø¶Ø§ÙØ© ÙƒÙˆØ¯ Ø§Ù„Ø¯ÙˆÙ„Ø©
      let phoneNumber = phone.replace(/\D/g, ''); // Ø¥Ø²Ø§Ù„Ø© Ø£ÙŠ Ø£Ø­Ø±Ù ØºÙŠØ± Ø±Ù‚Ù…ÙŠØ©
      
      // Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ø±Ù‚Ù… ÙŠØ¨Ø¯Ø£ Ø¨Ù€ 0ØŒ Ù†Ø­Ø°Ù Ø§Ù„ØµÙØ± ÙˆÙ†Ø¶ÙŠÙ 20
      if (phoneNumber.startsWith('0')) {
        phoneNumber = '20' + phoneNumber.substring(1);
      } 
      // Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ø±Ù‚Ù… Ù„Ø§ ÙŠØ¨Ø¯Ø£ Ø¨Ù€ 0 ÙˆÙ„Ø§ ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ ÙƒÙˆØ¯ Ø§Ù„Ø¯ÙˆÙ„Ø©ØŒ Ù†Ø¶ÙŠÙ 20
      else if (!phoneNumber.startsWith('+') && !phoneNumber.startsWith('20')) {
        phoneNumber = '20' + phoneNumber;
      }
      
      // Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ø±Ù‚Ù… ÙŠØ¨Ø¯Ø£ Ø¨Ù€ +ØŒ Ù†Ø­Ø°Ù Ø¹Ù„Ø§Ù…Ø© +
      if (phoneNumber.startsWith('+')) {
        phoneNumber = phoneNumber.substring(1);
      }
      
      // Ø¥Ù†Ø´Ø§Ø¡ Ø±Ø³Ø§Ù„Ø© Ø®Ø§ØµØ© Ø¨Ø§Ù„Ø·Ù„Ø¨
      const message =
        `Ø±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨: ${order.id}\n` +
        `Ø§Ù„Ø§Ø³Ù…: ${order.customer}\n` +
        `Ø§Ù„Ø±Ù‚Ù…: ${order.phone}\n` +
        `Ø§Ù„Ø¹Ù†ÙˆØ§Ù†: ${order.address}\n` +
        `Ø§Ù„Ø¹Ø¯Ø¯: ${order.count}\n` +
        `Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª: ${order.notes ? order.notes : 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù„Ø§Ø­Ø¸Ø§Øª'}`;
      
      // Ø¥Ù†Ø´Ø§Ø¡ Ø±Ø§Ø¨Ø· ÙˆØ§ØªØ³Ø§Ø¨ Ù„Ø¨Ø¯Ø¡ Ù…Ø­Ø§Ø¯Ø«Ø© Ø¬Ø¯ÙŠØ¯Ø©
      const whatsappURL = 'https://wa.me/' + phoneNumber + '?text=' + encodeURIComponent(message);
      
      // ÙØªØ­ Ù†Ø§ÙØ°Ø© Ø¬Ø¯ÙŠØ¯Ø© Ù…Ø¹ Ø±Ø§Ø¨Ø· Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨
      window.open(whatsappURL, '_blank');
    }
    
    // ÙˆØ¸ÙŠÙØ© ØªØ­Ø¯ÙŠØ« Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø·Ù„Ø¨
    function updateOrder(event, orderId) {
      event.preventDefault();
      
      const orders = JSON.parse(localStorage.getItem('orders') || '[]');
      const orderIndex = orders.findIndex(o => o.id === orderId);
      
      if (orderIndex !== -1) {
        const serviceType = document.getElementById('orderServiceTypeInput').value;
        const assignedId = document.getElementById('orderAssignedInput').value;
        
        // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ø³Ù… Ø§Ù„ÙÙ†ÙŠ/Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨
        let assignedName = '';
        if (serviceType === 'delivery') {
          const deliverymen = JSON.parse(localStorage.getItem('deliverymen') || '[]');
          const deliveryman = deliverymen.find(d => d.id == assignedId);
          assignedName = deliveryman ? deliveryman.name : '';
        } else {
          const technicians = JSON.parse(localStorage.getItem('technicians') || '[]');
          const technician = technicians.find(t => t.id == assignedId);
          assignedName = technician ? technician.name : '';
        }
        
        // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„ Ù…Ù† Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
        const customerName = document.getElementById('orderCustomerInput').value;
        const customerPhone = document.getElementById('orderPhoneInput').value;
        const customerAddress = document.getElementById('orderAddressInput').value;
        
        // ØªØ­Ø¯ÙŠØ« Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„
        updateCustomerData(orders[orderIndex].phone, customerName, customerPhone, customerAddress);
        
        // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø­Ø§Ù„ÙŠ
        const currentUser = localStorage.getItem('currentUser') || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯';
        
        console.log('ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø·Ù„Ø¨ - Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø­Ø§Ù„ÙŠ:', currentUser);
        console.log('Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø·Ù„Ø¨ Ù‚Ø¨Ù„ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„:', orders[orderIndex]);
        
        // ØªØ­Ø¯ÙŠØ« Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø·Ù„Ø¨
        orders[orderIndex] = {
          ...orders[orderIndex],
          customer: customerName,
          phone: customerPhone,
          address: customerAddress,
          serviceType: serviceType,
          assigned: assignedName,
          assignedId: assignedId,
          count: document.getElementById('orderCountInput').value,
          amount: document.getElementById('orderAmountInput').value,
          status: document.getElementById('orderStatusInput').value,
          notes: document.getElementById('orderNotesInput').value,
          lastModifiedBy: currentUser
        };
        
        console.log('Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø·Ù„Ø¨ Ø¨Ø¹Ø¯ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„:', orders[orderIndex]);
        console.log('lastModifiedBy Ø¨Ø¹Ø¯ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„:', orders[orderIndex].lastModifiedBy);
        
        localStorage.setItem('orders', JSON.stringify(orders));
        
        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø·Ù„Ø¨ ÙÙŠ Ø§Ù„Ø£Ø±Ø´ÙŠÙ
        updateOrderInArchive(orderId, orders[orderIndex]);
        
        // ØªØ­Ø¯ÙŠØ« ÙˆÙ‚Øª Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ« Ù„Ù„Ø·Ù„Ø¨Ø§Øª
        updateLastUpdateTime('orders');
        
        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª ÙˆÙ‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø·Ù„Ø¨Ø§Øª
        updateStats(); // Ø³ØªÙ‚ÙˆÙ… Ø¨ØªØ­Ø¯ÙŠØ« updateFixedStats Ø£ÙŠØ¶Ù‹Ø§
        loadOrders();
        loadOrdersPage();
        
        // ØªØ­Ø¯ÙŠØ« ØµÙØ­Ø© ÙƒÙ„ Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ù…ÙØªÙˆØ­Ø©
        if (document.getElementById('allOrdersPage').classList.contains('active')) {
          loadAllOrdersPage();
        }
        
        // ØªØ­Ø¯ÙŠØ« ØµÙØ­Ø© Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡
        loadCustomersPage();
        
        // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø©
        const modal = bootstrap.Modal.getInstance(document.getElementById('addOrderModal'));
        modal.hide();
        
        // Ø¹Ø±Ø¶ Ø¥Ø´Ø¹Ø§Ø± Ø§Ù„Ù†Ø¬Ø§Ø­
        showNotification('ØªÙ… ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø·Ù„Ø¨ Ø¨Ù†Ø¬Ø§Ø­', 'success');
      }
    }
    
    // ÙˆØ¸ÙŠÙØ© ØªØ­Ø¯ÙŠØ« Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„
    function updateCustomerData(oldPhone, newName, newPhone, newAddress) {
      if (!newName || !newPhone) {
        return; // Ù„Ø§ Ù†Ø­Ø¯Ø« Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„ Ø¨Ø¯ÙˆÙ† Ø§Ø³Ù… Ø£Ùˆ Ø±Ù‚Ù… Ù‡Ø§ØªÙ
      }
      
      const customers = JSON.parse(localStorage.getItem('customers') || '[]');
      
      // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ø¹Ù…ÙŠÙ„ Ø¨Ø§Ù„Ù‡Ø§ØªÙ Ø§Ù„Ù‚Ø¯ÙŠÙ…
      const existingCustomerIndex = customers.findIndex(customer => customer.phone === oldPhone);
      
      if (existingCustomerIndex !== -1) {
        // ØªØ­Ø¯ÙŠØ« Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„ Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯
        customers[existingCustomerIndex].name = newName;
        customers[existingCustomerIndex].phone = newPhone;
        customers[existingCustomerIndex].address = newAddress;
        
        localStorage.setItem('customers', JSON.stringify(customers));
        // ØªØ­Ø¯ÙŠØ« ÙˆÙ‚Øª Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ« Ù„Ù„Ø¹Ù…Ù„Ø§Ø¡
        updateLastUpdateTime('customers');
      } else {
        // Ø¥Ø°Ø§ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„Ø¹Ù…ÙŠÙ„ØŒ Ø£Ø¶Ù Ø¹Ù…ÙŠÙ„ Ø¬Ø¯ÙŠØ¯
        const newCustomerId = customers.length > 0 ? Math.max(...customers.map(c => c.id)) + 1 : 1;
        
        const newCustomer = {
          id: newCustomerId,
          name: newName,
          phone: newPhone,
          address: newAddress,
          orders: 1
        };
        
        customers.push(newCustomer);
        localStorage.setItem('customers', JSON.stringify(customers));
        // ØªØ­Ø¯ÙŠØ« ÙˆÙ‚Øª Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ« Ù„Ù„Ø¹Ù…Ù„Ø§Ø¡
        updateLastUpdateTime('customers');
      }
    }
    
    // =========== ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ù†Ø³Ø® Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠ ===========
    
    // ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª ØµÙØ­Ø© Ø§Ù„Ù†Ø³Ø® Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠ
    function loadBackupPageData() {
      loadCurrentDataTable();
      loadBackupHistoryTable();
    }
    
    // ØªØ­Ù…ÙŠÙ„ Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ø§Ù„ÙŠØ©
    function loadCurrentDataTable() {
      const tableBody = document.getElementById('backupTableBody');
      tableBody.innerHTML = '';
      
      // Ø§Ø³ØªØ±Ø¬Ø§Ø¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø®Ø²Ù†Ø© ÙˆØ¹Ø¯Ø¯Ù‡Ø§
      const orders = JSON.parse(localStorage.getItem('orders') || '[]');
      const technicians = JSON.parse(localStorage.getItem('technicians') || '[]');
      const deliverymen = JSON.parse(localStorage.getItem('deliverymen') || '[]');
      const customers = JSON.parse(localStorage.getItem('customers') || '[]');
      const restaurants = JSON.parse(localStorage.getItem('restaurants') || '[]');
      
      // Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ØµÙÙˆÙ
      const dataTypes = [
        { name: 'Ø§Ù„Ø·Ù„Ø¨Ø§Øª', data: orders, key: 'orders' },
        { name: 'Ø§Ù„ÙÙ†ÙŠÙŠÙ†', data: technicians, key: 'technicians' },
        { name: 'Ø§Ù„Ù…Ù†Ø§Ø¯ÙŠØ¨', data: deliverymen, key: 'deliverymen' },
        { name: 'Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡', data: customers, key: 'customers' },
        { name: 'Ø§Ù„Ù…Ø·Ø§Ø¹Ù…', data: restaurants, key: 'restaurants' }
      ];
      
      dataTypes.forEach(type => {
        const lastUpdate = getLastUpdate(type.key);
        const row = document.createElement('tr');
        row.innerHTML = `
          <td>${type.name}</td>
          <td>${type.data.length}</td>
          <td>${lastUpdate}</td>
          <td>
            <div class="btn-group btn-group-sm">
              <button class="btn btn-danger" onclick="deleteData('${type.key}')">
                <i class="bi bi-trash"></i> Ø­Ø°Ù
              </button>
              <button class="btn btn-primary" onclick="exportSingleDataJSON('${type.key}')">
                <i class="bi bi-filetype-json"></i> JSON
              </button>
              <button class="btn btn-success" onclick="exportSingleDataExcel('${type.key}')">
                <i class="bi bi-file-earmark-excel"></i> Excel
              </button>
            </div>
          </td>
        `;
        tableBody.appendChild(row);
      });
    }
    
    // ØªØ­Ù…ÙŠÙ„ Ø¬Ø¯ÙˆÙ„ Ø³Ø¬Ù„ Ø§Ù„Ù†Ø³Ø® Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠ
    function loadBackupHistoryTable() {
      const tableBody = document.getElementById('backupHistoryTableBody');
      tableBody.innerHTML = '';
      
      // Ø§Ø³ØªØ±Ø¬Ø§Ø¹ Ø³Ø¬Ù„ Ø§Ù„Ù†Ø³Ø® Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠ
      const backupHistory = JSON.parse(localStorage.getItem('backupHistory') || '[]');
      
      if (backupHistory.length === 0) {
        tableBody.innerHTML = '<tr><td colspan="4" class="text-center">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø³Ø¬Ù„Ø§Øª Ù„Ù„Ù†Ø³Ø® Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠ</td></tr>';
        return;
      }
      
      // Ø¹Ø±Ø¶ Ø§Ù„Ø³Ø¬Ù„Ø§ØªØŒ Ø§Ù„Ø£Ø­Ø¯Ø« Ø£ÙˆÙ„Ø§Ù‹
      backupHistory.slice().reverse().forEach(record => {
        const row = document.createElement('tr');
        row.innerHTML = `
          <td>${formatDate(record.date)}</td>
          <td>${getOperationTypeName(record.type)}</td>
          <td>${formatDataSize(record.size)}</td>
          <td>
            <button class="btn btn-sm btn-outline-danger" onclick="deleteHistoryRecord('${record.id}')">
              <i class="bi bi-trash"></i>
            </button>
          </td>
        `;
        tableBody.appendChild(row);
      });
    }
    
    // ØªÙ†Ø³ÙŠÙ‚ Ø­Ø¬Ù… Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
    function formatDataSize(bytes) {
      if (bytes < 1024) return bytes + ' Ø¨Ø§ÙŠØª';
      if (bytes < 1048576) return (bytes / 1024).toFixed(2) + ' ÙƒÙŠÙ„ÙˆØ¨Ø§ÙŠØª';
      return (bytes / 1048576).toFixed(2) + ' Ù…ÙŠØ¬Ø§Ø¨Ø§ÙŠØª';
    }
    
    // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ø³Ù… Ù†ÙˆØ¹ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©
    function getOperationTypeName(type) {
      const types = {
        'export_json': 'ØªØµØ¯ÙŠØ± (JSON)',
        'export_excel': 'ØªØµØ¯ÙŠØ± (Excel)',
        'import': 'Ø§Ø³ØªÙŠØ±Ø§Ø¯',
        'delete': 'Ø­Ø°Ù'
      };
      return types[type] || type;
    }
    
    // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ« Ù„Ù„Ø¨ÙŠØ§Ù†Ø§Øª
    function getLastUpdate(key) {
      const lastUpdates = JSON.parse(localStorage.getItem('dataLastUpdates') || '{}');
      const timestamp = lastUpdates[key];
      
      if (!timestamp) return 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ';
      
      // ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„ØªØ§Ø±ÙŠØ®
      return formatDateTime(new Date(timestamp));
    }
    
    // ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„ØªØ§Ø±ÙŠØ® ÙˆØ§Ù„ÙˆÙ‚Øª
    function formatDateTime(date) {
      return date.toLocaleString('ar-EG', {
        year: 'numeric',
        month: '2-digit',
        day: '2-digit',
        hour: '2-digit',
        minute: '2-digit'
      });
    }
    
    // ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙƒÙ…Ù„Ù JSON
    function exportDataJSON() {
      // Ø¬Ù…Ø¹ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
      const data = {
        orders: JSON.parse(localStorage.getItem('orders') || '[]'),
        technicians: JSON.parse(localStorage.getItem('technicians') || '[]'),
        deliverymen: JSON.parse(localStorage.getItem('deliverymen') || '[]'),
        customers: JSON.parse(localStorage.getItem('customers') || '[]'),
        restaurants: JSON.parse(localStorage.getItem('restaurants') || '[]'),
        items: JSON.parse(localStorage.getItem('items') || '[]')
      };
      
      // ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¥Ù„Ù‰ Ø³Ù„Ø³Ù„Ø© JSON
      const jsonString = JSON.stringify(data, null, 2);
      const blob = new Blob([jsonString], { type: 'application/json' });
      
      // Ø¥Ù†Ø´Ø§Ø¡ Ø±Ø§Ø¨Ø· Ø§Ù„ØªÙ†Ø²ÙŠÙ„
      const url = URL.createObjectURL(blob);
      const timestamp = new Date().toISOString().replace(/[:.]/g, '-');
      const filename = `ana_jay_backup_${timestamp}.json`;
      
      downloadFile(url, filename);
      
      // Ø¥Ø¶Ø§ÙØ© Ø³Ø¬Ù„ Ù„Ù„Ù†Ø³Ø® Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠ
      addBackupHistoryRecord('export_json', blob.size);
      
      alert('ØªÙ… ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­!');
    }
    
    // ØªØµØ¯ÙŠØ± Ù†ÙˆØ¹ ÙˆØ§Ø­Ø¯ Ù…Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙƒÙ…Ù„Ù JSON
    function exportSingleDataJSON(key) {
      const data = JSON.parse(localStorage.getItem(key) || '[]');
      const jsonString = JSON.stringify(data, null, 2);
      const blob = new Blob([jsonString], { type: 'application/json' });
      
      // Ø¥Ù†Ø´Ø§Ø¡ Ø±Ø§Ø¨Ø· Ø§Ù„ØªÙ†Ø²ÙŠÙ„
      const url = URL.createObjectURL(blob);
      const timestamp = new Date().toISOString().replace(/[:.]/g, '-');
      const filename = `ana_jay_${key}_${timestamp}.json`;
      
      downloadFile(url, filename);
      
      // Ø¥Ø¶Ø§ÙØ© Ø³Ø¬Ù„ Ù„Ù„Ù†Ø³Ø® Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠ
      addBackupHistoryRecord('export_json', blob.size);
      
      alert(`ØªÙ… ØªØµØ¯ÙŠØ± Ø¨ÙŠØ§Ù†Ø§Øª ${getDataTypeName(key)} Ø¨Ù†Ø¬Ø§Ø­!`);
    }
    
    // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ø³Ù… Ù†ÙˆØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
    function getDataTypeName(key) {
      const types = {
        'orders': 'Ø§Ù„Ø·Ù„Ø¨Ø§Øª',
        'technicians': 'Ø§Ù„ÙÙ†ÙŠÙŠÙ†',
        'deliverymen': 'Ø§Ù„Ù…Ù†Ø§Ø¯ÙŠØ¨',
        'customers': 'Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡',
        'restaurants': 'Ø§Ù„Ù…Ø·Ø§Ø¹Ù…',
        'items': 'Ø§Ù„Ø£ØµÙ†Ø§Ù'
      };
      return types[key] || key;
    }
    
    // ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙƒÙ…Ù„Ù Excel
    function exportDataExcel() {
      try {
        // Ø¬Ù…Ø¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
        const data = {
          orders: JSON.parse(localStorage.getItem('orders') || '[]'),
          technicians: JSON.parse(localStorage.getItem('technicians') || '[]'),
          deliverymen: JSON.parse(localStorage.getItem('deliverymen') || '[]'),
          customers: JSON.parse(localStorage.getItem('customers') || '[]'),
          restaurants: JSON.parse(localStorage.getItem('restaurants') || '[]')
        };
        
        // Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù…ØµÙ†Ù
        const wb = XLSX.utils.book_new();
        
        // Ø¥Ø¶Ø§ÙØ© ÙˆØ±Ù‚Ø© Ù„ÙƒÙ„ Ù†ÙˆØ¹ Ù…Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
        Object.keys(data).forEach(key => {
          if (data[key].length > 0) {
            const ws = XLSX.utils.json_to_sheet(data[key]);
            XLSX.utils.book_append_sheet(wb, ws, getDataTypeName(key));
          }
        });
        
        // Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ø³Ù… Ø§Ù„Ù…Ù„Ù
        const timestamp = new Date().toISOString().replace(/[:.]/g, '-');
        const filename = `ana_jay_backup_${timestamp}.xlsx`;
        
        // ØªØµØ¯ÙŠØ± Ø§Ù„Ù…Ù„Ù
        const excelData = XLSX.write(wb, { bookType: 'xlsx', type: 'array' });
        const blob = new Blob([excelData], { type: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet' });
        const url = URL.createObjectURL(blob);
        
        downloadFile(url, filename);
        
        // Ø¥Ø¶Ø§ÙØ© Ø³Ø¬Ù„ Ù„Ù„Ù†Ø³Ø® Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠ
        addBackupHistoryRecord('export_excel', blob.size);
        
        alert('ØªÙ… ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­!');
      } catch (error) {
        console.error('Error exporting Excel:', error);
        alert('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª: ' + error.message);
      }
    }
    
    // ØªØµØ¯ÙŠØ± Ù†ÙˆØ¹ ÙˆØ§Ø­Ø¯ Ù…Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙƒÙ…Ù„Ù Excel
    function exportSingleDataExcel(key) {
      try {
        const data = JSON.parse(localStorage.getItem(key) || '[]');
        
        // Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù…ØµÙ†Ù
        const wb = XLSX.utils.book_new();
        
        if (data.length > 0) {
          const ws = XLSX.utils.json_to_sheet(data);
          XLSX.utils.book_append_sheet(wb, ws, getDataTypeName(key));
          
          // Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ø³Ù… Ø§Ù„Ù…Ù„Ù
          const timestamp = new Date().toISOString().replace(/[:.]/g, '-');
          const filename = `ana_jay_${key}_${timestamp}.xlsx`;
          
          // ØªØµØ¯ÙŠØ± Ø§Ù„Ù…Ù„Ù
          const excelData = XLSX.write(wb, { bookType: 'xlsx', type: 'array' });
          const blob = new Blob([excelData], { type: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet' });
          const url = URL.createObjectURL(blob);
          
          downloadFile(url, filename);
          
          // Ø¥Ø¶Ø§ÙØ© Ø³Ø¬Ù„ Ù„Ù„Ù†Ø³Ø® Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠ
          addBackupHistoryRecord('export_excel', blob.size);
          
          alert(`ØªÙ… ØªØµØ¯ÙŠØ± Ø¨ÙŠØ§Ù†Ø§Øª ${getDataTypeName(key)} Ø¨Ù†Ø¬Ø§Ø­!`);
        } else {
          alert(`Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª ÙÙŠ ${getDataTypeName(key)} Ù„Ù„ØªØµØ¯ÙŠØ±!`);
        }
      } catch (error) {
        console.error('Error exporting Excel:', error);
        alert('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª: ' + error.message);
      }
    }
    
    // ÙˆØ¸ÙŠÙØ© Ù…Ø³Ø§Ø¹Ø¯Ø© Ù„ØªÙ†Ø²ÙŠÙ„ Ø§Ù„Ù…Ù„Ù
    function downloadFile(url, filename) {
      const link = document.createElement('a');
      link.href = url;
      link.download = filename;
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
      URL.revokeObjectURL(url);
    }
    
    // Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
    function importData() {
      const fileInput = document.getElementById('importFileInput');
      const file = fileInput.files[0];
      
      if (!file) {
        alert('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ø®ØªÙŠØ§Ø± Ù…Ù„Ù Ù„Ù„Ø§Ø³ØªÙŠØ±Ø§Ø¯');
        return;
      }
      
      if (!file.name.endsWith('.json')) {
        alert('ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ù…Ù„Ù Ø¨ØªÙ†Ø³ÙŠÙ‚ JSON');
        return;
      }
      
      const reader = new FileReader();
      reader.onload = function(event) {
        try {
          const data = JSON.parse(event.target.result);
          
          // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
          if (!data || typeof data !== 'object') {
            throw new Error('ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ØºÙŠØ± ØµØ§Ù„Ø­');
          }
          
          // Ø§Ù„Ø§Ø³ØªÙØ³Ø§Ø± Ø¹Ù† ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø§Ø³ØªÙŠØ±Ø§Ø¯
          if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ø£Ù†Ùƒ ØªØ±ÙŠØ¯ Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ù‡Ø°Ù‡ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§ØªØŸ Ø³ÙŠØªÙ… Ø§Ø³ØªØ¨Ø¯Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ø§Ù„ÙŠØ©!')) {
            // Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
            const keys = Object.keys(data);
            keys.forEach(key => {
              if (Array.isArray(data[key])) {
                localStorage.setItem(key, JSON.stringify(data[key]));
                
                // ØªØ­Ø¯ÙŠØ« ÙˆÙ‚Øª Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ«
                updateLastUpdateTime(key);
              }
            });
            
            // Ø¥Ø¶Ø§ÙØ© Ø³Ø¬Ù„ Ù„Ù„Ù†Ø³Ø® Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠ
            addBackupHistoryRecord('import', file.size);
            
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©
            loadBackupPageData();
            updateStats();
            
            alert('ØªÙ… Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­!');
            fileInput.value = '';
          }
        } catch (error) {
          console.error('Error importing data:', error);
          alert('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª: ' + error.message);
        }
      };
      reader.readAsText(file);
    }
    
    // Ø­Ø°Ù Ù†ÙˆØ¹ Ù…Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
    function deleteData(key) {
      if (confirm(`Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ø£Ù†Ùƒ ØªØ±ÙŠØ¯ Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø¨ÙŠØ§Ù†Ø§Øª ${getDataTypeName(key)}ØŸ`)) {
        // Ø­ÙØ¸ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø¹Ù† Ø­Ø¬Ù… Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù‚Ø¨Ù„ Ø§Ù„Ø­Ø°Ù
        const dataString = localStorage.getItem(key) || '[]';
        const dataSize = new Blob([dataString]).size;
        
        // Ø­Ø°Ù Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
        localStorage.setItem(key, '[]');
        
        // ØªØ­Ø¯ÙŠØ« ÙˆÙ‚Øª Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ«
        updateLastUpdateTime(key);
        
        // Ø¥Ø¶Ø§ÙØ© Ø³Ø¬Ù„ Ù„Ù„Ù†Ø³Ø® Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠ
        addBackupHistoryRecord('delete', dataSize);
        
        // ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©
        loadBackupPageData();
        updateStats();
        
        alert(`ØªÙ… Ø­Ø°Ù Ø¨ÙŠØ§Ù†Ø§Øª ${getDataTypeName(key)} Ø¨Ù†Ø¬Ø§Ø­!`);
      }
    }
    
    // ØªØ­Ø¯ÙŠØ« ÙˆÙ‚Øª Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ« Ù„Ù„Ø¨ÙŠØ§Ù†Ø§Øª
    function updateLastUpdateTime(key) {
      const lastUpdates = JSON.parse(localStorage.getItem('dataLastUpdates') || '{}');
      lastUpdates[key] = new Date().toISOString();
      localStorage.setItem('dataLastUpdates', JSON.stringify(lastUpdates));
    }
    
    // Ø¥Ø¶Ø§ÙØ© Ø³Ø¬Ù„ Ù„Ù„Ù†Ø³Ø® Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠ
    function addBackupHistoryRecord(type, size) {
      const backupHistory = JSON.parse(localStorage.getItem('backupHistory') || '[]');
      
      const record = {
        id: Date.now().toString(),
        date: new Date().toISOString(),
        type: type,
        size: size
      };
      
      backupHistory.push(record);
      
      // Ø§Ù„Ø§Ø­ØªÙØ§Ø¸ Ø¨Ø¢Ø®Ø± 20 Ø³Ø¬Ù„ ÙÙ‚Ø·
      if (backupHistory.length > 20) {
        backupHistory.shift();
      }
      
      localStorage.setItem('backupHistory', JSON.stringify(backupHistory));
      loadBackupHistoryTable();
    }
    
    // Ø­Ø°Ù Ø³Ø¬Ù„ Ù…Ù† Ø³Ø¬Ù„ Ø§Ù„Ù†Ø³Ø® Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠ
    function deleteHistoryRecord(id) {
      const backupHistory = JSON.parse(localStorage.getItem('backupHistory') || '[]');
      const updatedHistory = backupHistory.filter(record => record.id !== id);
      localStorage.setItem('backupHistory', JSON.stringify(updatedHistory));
      loadBackupHistoryTable();
    }
    
    // Ù…Ø³Ø­ Ø³Ø¬Ù„ Ø§Ù„Ù†Ø³Ø® Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠ
    function clearBackupHistory() {
      if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ø£Ù†Ùƒ ØªØ±ÙŠØ¯ Ù…Ø³Ø­ Ø³Ø¬Ù„ Ø§Ù„Ù†Ø³Ø® Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØŸ')) {
        localStorage.setItem('backupHistory', '[]');
        loadBackupHistoryTable();
        alert('ØªÙ… Ù…Ø³Ø­ Ø³Ø¬Ù„ Ø§Ù„Ù†Ø³Ø® Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠ Ø¨Ù†Ø¬Ø§Ø­!');
      }
    }
    
    // ØªØµØ¯ÙŠØ± Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø±Ø³Ù… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠ
    function exportChartData() {
      // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø±Ø³Ù… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠ
      const chartData = generateChartData();
      
      try {
        // Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù…ØµÙ†Ù
        const wb = XLSX.utils.book_new();
        
        // ØªØ¬Ù‡ÙŠØ² Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØµØ¯ÙŠØ±
        let exportData = [];
        
        // Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ø±Ø³Ù… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠ Ø¯Ø§Ø¦Ø±ÙŠÙ‹Ø§ØŒ Ù†ØµØ¯Ø± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ©
        if (currentChartType === 'doughnut') {
          exportData = [
            ['Ø§Ù„Ø­Ø§Ù„Ø©', 'Ø§Ù„Ø¹Ø¯Ø¯'],
            ['ØªÙ… Ø§Ù„ØªÙˆØµÙŠÙ„', chartData.datasets[0].data[0]],
            ['Ù‚ÙŠØ¯ Ø§Ù„ØªÙ†ÙÙŠØ°', chartData.datasets[0].data[1]],
            ['Ù…Ù„ØºÙŠ', chartData.datasets[0].data[2]]
          ];
        } else {
          // Ù†ØµØ¯Ø± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªÙØµÙŠÙ„ÙŠØ©
          const headerRow = ['Ø§Ù„ÙØªØ±Ø©', 'ØªÙ… Ø§Ù„ØªÙˆØµÙŠÙ„', 'Ù‚ÙŠØ¯ Ø§Ù„ØªÙ†ÙÙŠØ°', 'Ù…Ù„ØºÙŠ', 'Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ'];
          exportData.push(headerRow);
          
          // Ø¥Ø¶Ø§ÙØ© Ø¨ÙŠØ§Ù†Ø§Øª ÙƒÙ„ ÙØªØ±Ø©
          for (let i = 0; i < chartData.labels.length; i++) {
            const completed = chartData.datasets[0].data[i] || 0;
            const pending = chartData.datasets[1].data[i] || 0;
            const canceled = chartData.datasets[2].data[i] || 0;
            const total = completed + pending + canceled;
            
            exportData.push([
              chartData.labels[i],
              completed,
              pending,
              canceled,
              total
            ]);
          }
          
          // Ø¥Ø¶Ø§ÙØ© ØµÙ Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ§Øª
          const totalCompleted = chartData.datasets[0].data.reduce((a, b) => a + b, 0);
          const totalPending = chartData.datasets[1].data.reduce((a, b) => a + b, 0);
          const totalCanceled = chartData.datasets[2].data.reduce((a, b) => a + b, 0);
          const grandTotal = totalCompleted + totalPending + totalCanceled;
          
          exportData.push([
            'Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ',
            totalCompleted,
            totalPending,
            totalCanceled,
            grandTotal
          ]);
        }
        
        // Ø¥Ù†Ø´Ø§Ø¡ ÙˆØ±Ù‚Ø© ÙˆØ¥Ø¶Ø§ÙØªÙ‡Ø§ Ù„Ù„Ù…ØµÙ†Ù
        const ws = XLSX.utils.aoa_to_sheet(exportData);
        
        // Ø¹Ù†ÙˆØ§Ù† Ù…Ù†Ø§Ø³Ø¨ Ù„Ù„ÙˆØ±Ù‚Ø© Ø­Ø³Ø¨ Ø§Ù„ÙØªØ±Ø©
        let sheetTitle = 'Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø·Ù„Ø¨Ø§Øª';
        const period = document.getElementById('chartPeriod').value;
        
        switch(period) {
          case 'thisWeek': sheetTitle += ' - Ù‡Ø°Ø§ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹'; break;
          case 'thisMonth': sheetTitle += ' - Ù‡Ø°Ø§ Ø§Ù„Ø´Ù‡Ø±'; break;
          case 'week': sheetTitle += ' - Ø£Ø³Ø¨ÙˆØ¹ÙŠ'; break;
          case 'month': sheetTitle += ' - Ø´Ù‡Ø±ÙŠ'; break;
          case 'year': sheetTitle += ' - Ø³Ù†ÙˆÙŠ'; break;
          case 'custom': sheetTitle += ' - ÙØªØ±Ø© Ù…Ø®ØµØµØ©'; break;
        }
        
        XLSX.utils.book_append_sheet(wb, ws, sheetTitle);
        
        // Ø¥Ù†Ø´Ø§Ø¡ Ø§Ø³Ù… Ø§Ù„Ù…Ù„Ù
        const timestamp = new Date().toISOString().replace(/[:.]/g, '-');
        const filename = `ana_jay_orders_stats_${timestamp}.xlsx`;
        
        // ØªÙ†Ø²ÙŠÙ„ Ø§Ù„Ù…Ù„Ù
        XLSX.writeFile(wb, filename);
        
      } catch (error) {
        console.error('Error exporting chart data:', error);
        alert('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª: ' + error.message);
        
        // Ù…Ø­Ø§ÙˆÙ„Ø© ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙƒÙ€ CSV ÙÙŠ Ø­Ø§Ù„Ø© ÙØ´Ù„ ØªØµØ¯ÙŠØ± Excel
        exportToCSV(chartData);
      }
    }
    
    // ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙƒÙ…Ù„Ù CSV (ÙƒØ®Ø·Ø© Ø¨Ø¯ÙŠÙ„Ø©)
    function exportToCSV(chartData) {
      try {
        let csvContent = 'data:text/csv;charset=utf-8,';
        
        // Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ø±Ø³Ù… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠ Ø¯Ø§Ø¦Ø±ÙŠÙ‹Ø§ØŒ Ù†ØµØ¯Ø± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ©
        if (currentChartType === 'doughnut') {
          csvContent += 'Ø§Ù„Ø­Ø§Ù„Ø©,Ø§Ù„Ø¹Ø¯Ø¯\n';
          csvContent += `ØªÙ… Ø§Ù„ØªÙˆØµÙŠÙ„,${chartData.datasets[0].data[0]}\n`;
          csvContent += `Ù‚ÙŠØ¯ Ø§Ù„ØªÙ†ÙÙŠØ°,${chartData.datasets[0].data[1]}\n`;
          csvContent += `Ù…Ù„ØºÙŠ,${chartData.datasets[0].data[2]}\n`;
        } else {
          // Ù†ØµØ¯Ø± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªÙØµÙŠÙ„ÙŠØ©
          csvContent += 'Ø§Ù„ÙØªØ±Ø©,ØªÙ… Ø§Ù„ØªÙˆØµÙŠÙ„,Ù‚ÙŠØ¯ Ø§Ù„ØªÙ†ÙÙŠØ°,Ù…Ù„ØºÙŠ,Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ\n';
          
          // Ø¥Ø¶Ø§ÙØ© Ø¨ÙŠØ§Ù†Ø§Øª ÙƒÙ„ ÙØªØ±Ø©
          for (let i = 0; i < chartData.labels.length; i++) {
            const completed = chartData.datasets[0].data[i] || 0;
            const pending = chartData.datasets[1].data[i] || 0;
            const canceled = chartData.datasets[2].data[i] || 0;
            const total = completed + pending + canceled;
            
            csvContent += `${chartData.labels[i]},${completed},${pending},${canceled},${total}\n`;
          }
          
          // Ø¥Ø¶Ø§ÙØ© ØµÙ Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ§Øª
          const totalCompleted = chartData.datasets[0].data.reduce((a, b) => a + b, 0);
          const totalPending = chartData.datasets[1].data.reduce((a, b) => a + b, 0);
          const totalCanceled = chartData.datasets[2].data.reduce((a, b) => a + b, 0);
          const grandTotal = totalCompleted + totalPending + totalCanceled;
          
          csvContent += `Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ,${totalCompleted},${totalPending},${totalCanceled},${grandTotal}\n`;
        }
        
        // ØªÙ†Ø²ÙŠÙ„ Ø§Ù„Ù…Ù„Ù
        const encodedUri = encodeURI(csvContent);
        const link = document.createElement('a');
        link.setAttribute('href', encodedUri);
        
        // Ø¥Ù†Ø´Ø§Ø¡ Ø§Ø³Ù… Ø§Ù„Ù…Ù„Ù
        const timestamp = new Date().toISOString().replace(/[:.]/g, '-');
        link.setAttribute('download', `ana_jay_orders_stats_${timestamp}.csv`);
        
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
        
      } catch (error) {
        console.error('Error exporting chart data to CSV:', error);
        alert('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª: ' + error.message);
      }
    }
  </script>

  // ... existing code ...
  </script>
  <!-- Ù†Ø§ÙØ°Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù„Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠÙ† -->
  <div class="modal fade" id="adminLoginModal" tabindex="-1" aria-labelledby="adminLoginModalLabel" aria-hidden="true" data-bs-backdrop="static" data-bs-keyboard="false">
    <div class="modal-dialog">
      <div class="modal-content">
        <form id="adminLoginForm" onsubmit="adminLogin(event)">
          <div class="modal-header">
            <h5 class="modal-title" id="adminLoginModalLabel">ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„</h5>
            <!-- Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø²Ø± X - Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù†Ø§ÙØ°Ø© Ø¥Ù„Ø§ Ø¨ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ -->
          </div>
          <div class="modal-body">
            <div class="mb-3">
              <label class="form-label">ÙƒÙˆØ¯ Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„</label>
              <input type="text" class="form-control" id="adminCodeInput" required autocomplete="username">
            </div>
            <div class="mb-3">
              <label class="form-label">ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø±</label>
              <input type="password" class="form-control" id="adminPasswordInput" required autocomplete="current-password">
            </div>
            <div class="alert alert-danger d-none" id="adminLoginError">Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„ ØºÙŠØ± ØµØ­ÙŠØ­Ø©!</div>
          </div>
          <div class="modal-footer">
            <button type="submit" class="btn btn-primary">Ø¯Ø®ÙˆÙ„</button>
          </div>
        </form>
      </div>
    </div>
  </div>
  <!-- Ø²Ø± ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬ ÙÙŠ Ø£Ø¹Ù„Ù‰ Ø§Ù„ØµÙØ­Ø© -->
  <button id="logoutBtn" class="btn btn-danger position-fixed" style="top:10px;left:10px;z-index:2000;display:none" onclick="adminLogout()">ØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬</button>
  <script>
  // ========== ÙˆØ¸Ø§Ø¦Ù ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ ÙˆØ§Ù„Ø®Ø±ÙˆØ¬ Ù„Ù„Ù…Ø³Ø¤ÙˆÙ„ =============
  // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ù…Ø³Ø¤ÙˆÙ„ Ù…Ø³Ø¬Ù„ Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
  window.addEventListener('DOMContentLoaded', function() {
    checkAdminLogin();
  });

  function checkAdminLogin() {
    const admin = sessionStorage.getItem('currentAdmin');
    if (!admin) {
      showAdminLoginModal();
      document.getElementById('logoutBtn').style.display = 'none';
    } else {
      document.getElementById('logoutBtn').style.display = 'block';
    }
  }

  function showAdminLoginModal() {
    // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ ÙˆØ±Ø³Ø§Ù„Ø© Ø§Ù„Ø®Ø·Ø£
    document.getElementById('adminLoginForm').reset();
    document.getElementById('adminLoginError').classList.add('d-none');
    
    // Ø¹Ø±Ø¶ Ø§Ù„Ù†Ø§ÙØ°Ø© Ù…Ø¹ Ù…Ù†Ø¹ Ø§Ù„Ø¥ØºÙ„Ø§Ù‚
    const modal = new bootstrap.Modal(document.getElementById('adminLoginModal'), {
      backdrop: 'static', 
      keyboard: false
    });
    
    // Ù…Ù†Ø¹ Ø¥ØºÙ„Ø§Ù‚ modal Ø¨Ø§Ù„Ø¶ØºØ· Ø®Ø§Ø±Ø¬ Ø§Ù„Ù†Ø§ÙØ°Ø©
    document.getElementById('adminLoginModal').addEventListener('click', function(e) {
      if (e.target === this) {
        e.preventDefault();
        e.stopPropagation();
        return false;
      }
    });
    
    modal.show();
  }

  

  function adminLogout() {
    sessionStorage.removeItem('currentAdmin');
    checkAdminLogin();
  }
  // ... existing code ...
  // Ø¹Ù†Ø¯ Ø¥Ø¶Ø§ÙØ© Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯ØŒ Ø£Ø¶Ù Ø§Ø³Ù… Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ Ø§Ù„Ø­Ø§Ù„ÙŠ Ù„Ù„Ø·Ù„Ø¨
  function addOrder(event) {
    event.preventDefault();
    const orders = JSON.parse(localStorage.getItem('orders') || '[]');
    const newOrderId = orders.length > 0 ? Math.max(...orders.map(o => o.id)) + 1 : 1;
    const serviceType = document.getElementById('orderServiceTypeInput').value;
    const assignedId = document.getElementById('orderAssignedInput').value;
    let assignedName = '';
    if (serviceType === 'delivery') {
      const deliverymen = JSON.parse(localStorage.getItem('deliverymen') || '[]');
      const deliveryman = deliverymen.find(d => d.id == assignedId);
      assignedName = deliveryman ? deliveryman.name : '';
    } else {
      const technicians = JSON.parse(localStorage.getItem('technicians') || '[]');
      const technician = technicians.find(t => t.id == assignedId);
      assignedName = technician ? technician.name : '';
    }
    const customerName = document.getElementById('orderCustomerInput').value;
    const customerPhone = document.getElementById('orderPhoneInput').value;
    const customerAddress = document.getElementById('orderAddressInput').value;
    addCustomerIfNotExists(customerName, customerPhone, customerAddress);
    // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ø³Ù… Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ Ø§Ù„Ø­Ø§Ù„ÙŠ
    let adminName = '';
    const admin = sessionStorage.getItem('currentAdmin');
    if (admin) {
      adminName = JSON.parse(admin).name;
    }
    const newOrder = {
      id: newOrderId,
      customer: customerName,
      phone: customerPhone,
      address: customerAddress,
      serviceType: serviceType,
      assigned: assignedName,
      assignedId: assignedId,
      count: document.getElementById('orderCountInput').value,
      amount: document.getElementById('orderAmountInput').value,
      status: document.getElementById('orderStatusInput').value,
      notes: document.getElementById('orderNotesInput').value,
      date: new Date().toISOString(),
      createdBy: adminName,
      lastModifiedBy: adminName,
      rated: false
    };
    orders.push(newOrder);
    localStorage.setItem('orders', JSON.stringify(orders));
    updateLastUpdateTime('orders');
    updateStats();
    loadOrders();
    loadOrdersPage();
    loadCustomersPage();
    const modal = bootstrap.Modal.getInstance(document.getElementById('addOrderModal'));
    modal.hide();
  }
  // ... existing code ...
  // Ø¹Ù†Ø¯ Ø¹Ø±Ø¶ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø·Ù„Ø¨ØŒ Ø£Ø¸Ù‡Ø± Ø§Ø³Ù… Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„
  function showOrderDetails(orderId) {
    const orders = JSON.parse(localStorage.getItem('orders') || '[]');
    const order = orders.find(o => o.id === orderId);
    if (order) {
      const detailsBody = document.getElementById('orderDetailsBody');
      detailsBody.innerHTML = `
        <div class="row mb-2">
          <div class="col-4 fw-bold">Ø±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨:</div>
          <div class="col-8">${order.id}</div>
        </div>
        <div class="row mb-2">
          <div class="col-4 fw-bold">Ø§Ù„Ø¹Ù…ÙŠÙ„:</div>
          <div class="col-8">${order.customer} <span class="text-muted small">(${order.phone})</span></div>
        </div>
        <div class="row mb-2">
          <div class="col-4 fw-bold">Ø§Ù„Ø¹Ù†ÙˆØ§Ù†:</div>
          <div class="col-8">${order.address}</div>
        </div>
        <div class="row mb-2">
          <div class="col-4 fw-bold">Ù†ÙˆØ¹ Ø§Ù„Ø®Ø¯Ù…Ø©:</div>
          <div class="col-8">${getServiceTypeName(order.serviceType)}</div>
        </div>
        <div class="row mb-2">
          <div class="col-4 fw-bold">Ø§Ù„ÙÙ†ÙŠ/Ø§Ù„Ù…Ù†Ø¯ÙˆØ¨:</div>
          <div class="col-8">${order.assigned}</div>
        </div>
        <div class="row mb-2">
          <div class="col-4 fw-bold">Ø§Ù„Ø¹Ø¯Ø¯:</div>
          <div class="col-8">${order.count}</div>
        </div>
        <div class="row mb-2">
          <div class="col-4 fw-bold">Ø§Ù„Ù…Ø¨Ù„Øº:</div>
          <div class="col-8">${order.amount} Ø¬</div>
        </div>
        <div class="row mb-2">
          <div class="col-4 fw-bold">Ø§Ù„Ø­Ø§Ù„Ø©:</div>
          <div class="col-8"><span class="badge ${getStatusBadgeClass(order.status)}">${order.status}</span></div>
        </div>
        <div class="row mb-2">
          <div class="col-4 fw-bold">ØªØ§Ø±ÙŠØ® ÙˆÙˆÙ‚Øª Ø§Ù„Ø·Ù„Ø¨:</div>
          <div class="col-8">${formatDate(order.date)}</div>
        </div>
        <div class="row mb-2">
          <div class="col-4 fw-bold">Ù…Ù†Ø´Ø¦ Ø§Ù„Ø·Ù„Ø¨:</div>
          <div class="col-8">${order.createdBy || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</div>
        </div>
        <div class="row mb-2">
          <div class="col-4 fw-bold">Ø¢Ø®Ø± Ù…Ù† Ø¹Ø¯Ù‘Ù„ Ø§Ù„Ø·Ù„Ø¨:</div>
          <div class="col-8">${order.lastModifiedBy || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</div>
        </div>
        <div class="row mb-2">
          <div class="col-4 fw-bold">Ù…Ù„Ø§Ø­Ø¸Ø§Øª:</div>
          <div class="col-8">${order.notes || 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù„Ø§Ø­Ø¸Ø§Øª'}</div>
        </div>
      `;
      const modal = new bootstrap.Modal(document.getElementById('orderDetailsModal'));
      modal.show();
    }
  }
  // ... existing code ...
  </script>
  <!-- ========== Ù…ØµÙÙˆÙØ© Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠÙ† ============= -->
  <script>
  </script>
  <script>
  // ... existing code ...
  function populateTechnicianSpecialtyFilter() {
    const technicians = JSON.parse(localStorage.getItem('technicians') || '[]');
    const specialties = Array.from(new Set(technicians.map(t => t.specialty)));
    const filter = document.getElementById('technicianSpecialtyFilter');
    filter.innerHTML = '<option value="">ÙƒÙ„ Ø§Ù„ØªØ®ØµØµØ§Øª</option>';
    specialties.forEach(specialty => {
      if (specialty) {
        const option = document.createElement('option');
        option.value = specialty;
        option.textContent = specialty;
        filter.appendChild(option);
      }
    });
  }
  function filterTechniciansBySpecialty() {
    const selected = document.getElementById('technicianSpecialtyFilter').value;
    const technicians = JSON.parse(localStorage.getItem('technicians') || '[]');
    let filtered = technicians;
    if (selected) {
      filtered = technicians.filter(t => t.specialty === selected);
    }
    renderTechniciansList(filtered);
  }
  function renderTechniciansList(techs) {
    const techniciansList = document.getElementById('techniciansList');
    techniciansList.innerHTML = '';
    if (techs.length === 0) {
      techniciansList.innerHTML = '<div class="col-12 text-center py-5">Ù„Ø§ ÙŠÙˆØ¬Ø¯ ÙÙ†ÙŠÙŠÙ†</div>';
      return;
    }
    
    // ØªØ±ØªÙŠØ¨ Ø§Ù„ÙÙ†ÙŠÙŠÙ† Ø­Ø³Ø¨ Ø±Ù‚Ù… Ø§Ù„ØªØ±ØªÙŠØ¨
    techs.sort((a, b) => (a.order || 999) - (b.order || 999));
    
    techs.forEach((technician, index) => {
      // Ø­Ø³Ø§Ø¨ Ø­ØµØ© Ø§Ù„Ø´Ø±ÙƒØ© Ù„Ù„ÙÙ†ÙŠ
      const orders = JSON.parse(localStorage.getItem('orders') || '[]');
      const completedOrders = orders.filter(order => 
        order.assignedId == technician.id && 
        order.status === 'ØªÙ… Ø§Ù„ØªÙˆØµÙŠÙ„' &&
        !order.isHidden
      );
      const totalCompanyShare = completedOrders.reduce((sum, order) => {
        return sum + (parseFloat(order.amount) * 0.25);
      }, 0);
      const MAX_COMPANY_SHARE = 300;
      const remainingShare = MAX_COMPANY_SHARE - totalCompanyShare;
      const isLimitReached = totalCompanyShare >= MAX_COMPANY_SHARE;
      
      const card = document.createElement('div');
      card.className = 'col-md-4 col-sm-6';
      card.innerHTML = `
        <div class="card card-hover shadow-sm mb-3 ${isLimitReached ? 'border-danger' : ''}">
          <div class="card-body">
            <div class="d-flex align-items-center mb-3">
              <div class="order-badge me-2">${technician.order || 'ØŸ'}</div>
              <img src="https://randomuser.me/api/portraits/men/${11 + index}.jpg" class="user-avatar me-3" alt="technician" style="width: 50px; height: 50px;">
              <div>
                <h6 class="mb-0 fw-bold">${technician.name}</h6>
                <small class="text-muted">${technician.specialty}</small>
              </div>
            </div>
            <div class="mb-3 p-2 rounded ${isLimitReached ? 'bg-danger text-white' : 'bg-light'}">
              <small>
                <strong>Ø­ØµØ© Ø§Ù„Ø´Ø±ÙƒØ©:</strong> ${totalCompanyShare.toFixed(2)} Ø¬ / ${MAX_COMPANY_SHARE} Ø¬<br>
                <strong>Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ:</strong> ${remainingShare.toFixed(2)} Ø¬<br>
                <strong>Ø§Ù„Ø­Ø§Ù„Ø©:</strong> ${isLimitReached ? 'Ù…Ù…Ù†ÙˆØ¹ Ø§Ù„ØªØ¹Ø§Ù…Ù„' : 'Ù…Ø³Ù…ÙˆØ­ Ø§Ù„ØªØ¹Ø§Ù…Ù„'}
              </small>
            </div>
                          <div class="d-flex justify-content-between align-items-center">
                <div>
                  <p class="mb-0"><i class="bi bi-telephone me-2"></i>${technician.phone}</p>
                  <p class="mb-0"><i class="bi bi-star-fill me-2 text-warning"></i>${technician.rating || 0}</p>
                </div>
                <div>
                  <button class="btn btn-sm btn-outline-info mb-1" onclick="showTechnicianStats(${technician.id})"><i class="bi bi-graph-up"></i> Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª</button>
                  <button class="btn btn-sm btn-outline-warning mb-1" onclick="showEditTechnicianModal(${technician.id})"><i class="bi bi-pencil"></i> ØªØ¹Ø¯ÙŠÙ„</button>
                  <button class="btn btn-sm btn-outline-success mb-1" onclick="exportTechnicianData(${technician.id})"><i class="bi bi-file-excel"></i> ØªØµØ¯ÙŠØ±</button>
                  ${isLimitReached ? `<button class="btn btn-sm btn-outline-danger mb-1" onclick="showLimitNotification('${technician.name}')"><i class="bi bi-exclamation-triangle"></i> ØªØ­Ø°ÙŠØ±</button>` : ''}
                  ${isLimitReached ? `<a class="btn btn-sm btn-success mb-1" target="_blank" href="https://wa.me/${technician.phone.replace(/^0/, '2')}
?text=${encodeURIComponent(`Ø§Ù„Ø³Ù„Ø§Ù… Ø¹Ù„ÙŠÙƒÙ… Ø§Ø³ØªØ§Ø° ${technician.name.split(' ')[0]}\nÙ„Ù‚Ø¯ ÙˆØµÙ„Øª Ù„Ù„Ø­Ø¯ Ø§Ù„Ø§Ù‚ØµÙŠ Ù„Ù„ØªØ¹Ø§Ù…Ù„ Ø§Ø±Ø¬Ø§Ø¡ ØªØµÙÙŠÙ‡ Ø§Ù„Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¨Ø§Ù„Øº ${totalCompanyShare.toFixed(2)} Ø¬ Ù…Ù† Ø®Ù„Ø§Ù„ ÙÙˆØ¯Ø§ÙÙˆÙ† ÙƒØ§Ø´ Ø±Ù‚Ù… 01062644606 Ø§Ùˆ Ø§Ù„ØªÙˆØ¬Ù‡ Ø§Ù„ÙŠ Ø§Ù„Ù…ÙƒØªØ¨ Ù„ØªØµÙÙŠÙ‡ Ø§Ù„Ø­Ø³Ø§Ø¨\nÙ…Ø¹ ØªØ­ÙŠØ§Øª Ø§Ø¯Ø§Ø±Ù‡ Ø§Ù†Ø§ Ø¬Ø§ÙŠ`)}"><i class='bi bi-whatsapp'></i> ÙˆØ§ØªØ³Ø§Ø¨</a>` : ''}
                  <button class="btn btn-sm btn-outline-danger" onclick="deleteTechnician(${technician.id})"><i class="bi bi-trash"></i></button>
                </div>
              </div>
          </div>
        </div>
      `;
      techniciansList.appendChild(card);
    });
  }
  // Ø¹Ø¯Ù„ Ø¯Ø§Ù„Ø© ØªØ­Ù…ÙŠÙ„ ØµÙØ­Ø© Ø§Ù„ÙÙ†ÙŠÙŠÙ† Ù„ØªÙØ¹ÙŠÙ„ Ø§Ù„ÙÙ„ØªØ±
  function loadTechniciansPage() {
    const technicians = JSON.parse(localStorage.getItem('technicians') || '[]');
    populateTechnicianSpecialtyFilter();
    renderTechniciansList(technicians);
  }
  // ... existing code ...
  </script>
  <script>
  // ... existing code ...
  // Ø£Ø¶Ù Ø¯Ø§Ù„Ø© Ø§Ù„ØªØµÙÙŠØ© ÙˆØ§Ù„ØªØµØ¯ÙŠØ±
  function filterAndExportTechnicianOrders(technicianId) {
    const orders = JSON.parse(localStorage.getItem('orders') || '[]');
    // Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„ØªÙŠ Ø³ÙŠØªÙ… ØªØµØ¯ÙŠØ±Ù‡Ø§ ÙˆØªØµÙÙŠØªÙ‡Ø§ (ØªÙ… Ø§Ù„ØªÙˆØµÙŠÙ„ Ø£Ùˆ Ù…Ù„ØºÙŠ)
    const filtered = orders.filter(order => order.assignedId == technicianId && (order.status === 'ØªÙ… Ø§Ù„ØªÙˆØµÙŠÙ„' || order.status === 'Ù…Ù„ØºÙŠ'));
    if (filtered.length === 0) {
      alert('Ù„Ø§ ØªÙˆØ¬Ø¯ Ø·Ù„Ø¨Ø§Øª Ù…ÙƒØªÙ…Ù„Ø© Ø£Ùˆ Ù…Ù„ØºÙŠØ© Ù„Ù‡Ø°Ø§ Ø§Ù„ÙÙ†ÙŠ Ù„Ù„ØªØµÙÙŠØ©.');
      return;
    }
    
    // ØªØ¬Ù‡ÙŠØ² Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØµØ¯ÙŠØ±
    const wsData = [
      ['Ø±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨', 'Ø§Ù„Ø¹Ù…ÙŠÙ„', 'Ø§Ù„Ø¹Ù†ÙˆØ§Ù†', 'Ø§Ù„ØªØ§Ø±ÙŠØ®', 'Ø§Ù„Ø­Ø§Ù„Ø©', 'Ø§Ù„Ù…Ø¨Ù„Øº (Ø¬)']
    ];
    filtered.forEach(order => {
      wsData.push([
        order.id,
        order.customer,
        order.address,
        formatDate(order.date),
        order.status,
        order.amount
      ]);
    });
    
    // Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù„Ù Excel
    const wb = XLSX.utils.book_new();
    const ws = XLSX.utils.aoa_to_sheet(wsData);
    XLSX.utils.book_append_sheet(wb, ws, 'ØªØµÙÙŠØ© Ø§Ù„ÙÙ†ÙŠ');
    const filename = `ØªØµÙÙŠØ©_Ø§Ù„ÙÙ†ÙŠ_${technicianId}_${new Date().toISOString().replace(/[:.]/g, '-')}.xlsx`;
    XLSX.writeFile(wb, filename);
    
    // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù…ØµØ¯Ø±Ø© Ø¥Ù„Ù‰ Ø§Ù„Ø£Ø±Ø´ÙŠÙ Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† Ø­Ø°ÙÙ‡Ø§
    const archive = JSON.parse(localStorage.getItem('allOrdersArchive') || '[]');
    const currentTime = new Date().toISOString();
    
    filtered.forEach(order => {
      const archivedOrder = {
        ...order,
        archivedAt: currentTime,
        filteredAt: currentTime,
        isFiltered: true,
        filteredBy: 'technician',
        technicianId: technicianId,
        originalStatus: order.status,
        filterReason: 'ØªØµÙÙŠØ© Ø§Ù„ÙÙ†ÙŠ - Ø·Ù„Ø¨Ø§Øª Ù…ÙƒØªÙ…Ù„Ø© Ø£Ùˆ Ù…Ù„ØºÙŠØ©'
      };
      archive.push(archivedOrder);
    });
    
    localStorage.setItem('allOrdersArchive', JSON.stringify(archive));
    
    // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù…ØµØ¯Ø±Ø© Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù†Ø´Ø·Ø© (Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† Ø­Ø°ÙÙ‡Ø§)
    const updatedOrders = orders.map(order => {
      if (order.assignedId == technicianId && (order.status === 'ØªÙ… Ø§Ù„ØªÙˆØµÙŠÙ„' || order.status === 'Ù…Ù„ØºÙŠ')) {
        return {
          ...order,
          isHidden: true,
          hiddenAt: currentTime,
          hiddenBy: 'technician',
          hiddenReason: 'ØªØµÙÙŠØ© Ø§Ù„ÙÙ†ÙŠ'
        };
      }
      return order;
    });
    
    localStorage.setItem('orders', JSON.stringify(updatedOrders));
    
    // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª ÙˆØ§Ù„ØµÙØ­Ø§Øª
    updateStats();
    loadOrders();
    loadOrdersPage();
    
    // ØªØ­Ø¯ÙŠØ« ØµÙØ­Ø© ÙƒÙ„ Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ù…ÙØªÙˆØ­Ø©
    if (document.getElementById('allOrdersPage').classList.contains('active')) {
      loadAllOrdersPage();
    }
    
    // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ø³Ù… Ø§Ù„ÙÙ†ÙŠ Ù„Ø¹Ø±Ø¶Ù‡ ÙÙŠ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±
    const technicians = JSON.parse(localStorage.getItem('technicians') || '[]');
    const technician = technicians.find(t => t.id == technicianId);
    const technicianName = technician ? technician.name : 'Ø§Ù„ÙÙ†ÙŠ';
    
    showNotification(`ØªÙ… ØªØµØ¯ÙŠØ± Ø·Ù„Ø¨Ø§Øª ${technicianName} ÙˆØªØµÙÙŠØªÙ‡Ø§ Ø¨Ù†Ø¬Ø§Ø­. ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ø¢Ù† Ø¨Ø¯Ø¡ Ø­Ø³Ø§Ø¨ Ø¬Ø¯ÙŠØ¯ Ù„Ù„ÙÙ†ÙŠ.`, 'success');
  }
  
  // Ø¯Ø§Ù„Ø© Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù†Ø¸Ø§Ù…
  function testOrderSystem() {
    console.log('=== Ø§Ø®ØªØ¨Ø§Ø± Ù†Ø¸Ø§Ù… Ø§Ù„Ø·Ù„Ø¨Ø§Øª ===');
    
    // Ø¥Ù†Ø´Ø§Ø¡ Ø·Ù„Ø¨ ØªØ¬Ø±ÙŠØ¨ÙŠ
    const testOrder = {
      id: 999,
      customer: 'Ø¹Ù…ÙŠÙ„ ØªØ¬Ø±ÙŠØ¨ÙŠ',
      phone: '01000000000',
      address: 'Ø¹Ù†ÙˆØ§Ù† ØªØ¬Ø±ÙŠØ¨ÙŠ',
      serviceType: 'ac',
      assigned: 'ÙÙ†ÙŠ ØªØ¬Ø±ÙŠØ¨ÙŠ',
      assignedId: '1',
      count: 1,
      amount: 100,
      status: 'Ø¬Ø¯ÙŠØ¯',
      notes: 'Ù…Ù„Ø§Ø­Ø¸Ø§Øª ØªØ¬Ø±ÙŠØ¨ÙŠØ©',
      date: new Date().toISOString(),
      createdBy: 'Ù…Ø³ØªØ®Ø¯Ù… ØªØ¬Ø±ÙŠØ¨ÙŠ',
      lastModifiedBy: null
    };
    
    console.log('Ø·Ù„Ø¨ ØªØ¬Ø±ÙŠØ¨ÙŠ:', testOrder);
    console.log('createdBy:', testOrder.createdBy);
    console.log('lastModifiedBy:', testOrder.lastModifiedBy);
    
    // Ù…Ø­Ø§ÙƒØ§Ø© ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø·Ù„Ø¨
    testOrder.lastModifiedBy = 'Ù…Ø¹Ø¯Ù„ ØªØ¬Ø±ÙŠØ¨ÙŠ';
    console.log('Ø¨Ø¹Ø¯ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ - lastModifiedBy:', testOrder.lastModifiedBy);
  }
  
  // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø© Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
  document.addEventListener('DOMContentLoaded', function() {
    updateOldOrders();
    // ØªØ´ØºÙŠÙ„ Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù†Ø¸Ø§Ù…
    testOrderSystem();
    
    // Ø¥Ø²Ø§Ù„Ø© Ø£ÙŠ overlays Ø³Ø§Ø¨Ù‚Ø©
    removeOverlays();
    
    // Ø¥Ø²Ø§Ù„Ø© Ø£ÙŠ toasts Ø³Ø§Ø¨Ù‚Ø©
    const existingToasts = document.querySelectorAll('[style*="z-index: 10001"]');
    existingToasts.forEach(toast => toast.remove());
    
    // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ù…ØªØºÙŠØ± Ù…Ù†Ø¹ ØªÙƒØ±Ø§Ø± Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±
    window.sessionExpiredShown = false;
    
    // ØªÙ‡ÙŠØ¦Ø© ÙƒØ±ÙˆØª VIP
    if (!localStorage.getItem('vipCards')) {
      localStorage.setItem('vipCards', JSON.stringify([]));
    }
    if (!localStorage.getItem('vipCardUsage')) {
      localStorage.setItem('vipCardUsage', JSON.stringify([]));
    }
  });
  
  // ========== Ø¯ÙˆØ§Ù„ Ø¥Ø¯Ø§Ø±Ø© ÙƒØ±ÙˆØª VIP ==========
  
  // Ø¥Ø¶Ø§ÙØ© ÙƒØ§Ø±Øª VIP Ø¬Ø¯ÙŠØ¯
  function addVipCard(event) {
    event.preventDefault();
    
    const cardNumber = document.getElementById('vipCardNumberInput').value.trim();
    const owner = document.getElementById('vipCardOwnerInput').value.trim();
    const type = document.getElementById('vipCardTypeInput').value;
    const usageLimit = parseInt(document.getElementById('vipCardUsageLimitInput').value);
    const expiryDate = document.getElementById('vipCardExpiryInput').value;
    const notes = document.getElementById('vipCardNotesInput').value.trim();
    
    // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
    if (cardNumber.length !== 6 || !/^\d{6}$/.test(cardNumber)) {
      alert('Ø±Ù‚Ù… Ø§Ù„ÙƒØ§Ø±Øª ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† 6 Ø£Ø±Ù‚Ø§Ù… ÙÙ‚Ø·');
      return;
    }
    
    // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø¹Ø¯Ù… ØªÙƒØ±Ø§Ø± Ø±Ù‚Ù… Ø§Ù„ÙƒØ§Ø±Øª
    const existingCards = JSON.parse(localStorage.getItem('vipCards') || '[]');
    if (existingCards.find(card => card.number === cardNumber)) {
      alert('Ø±Ù‚Ù… Ø§Ù„ÙƒØ§Ø±Øª Ù…ÙˆØ¬ÙˆØ¯ Ù…Ø³Ø¨Ù‚Ø§Ù‹');
      return;
    }
    
    // Ø¥Ù†Ø´Ø§Ø¡ ÙƒØ§Ø±Øª Ø¬Ø¯ÙŠØ¯
    const newCard = {
      id: Date.now(),
      number: cardNumber,
      owner: owner,
      type: type,
      usageLimit: usageLimit,
      usageCount: 0,
      expiryDate: expiryDate,
      notes: notes,
      createdAt: new Date().toISOString(),
      createdBy: localStorage.getItem('currentUser') || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯',
      status: 'Ù†Ø´Ø·'
    };
    
    // Ø­ÙØ¸ Ø§Ù„ÙƒØ§Ø±Øª
    existingCards.push(newCard);
    localStorage.setItem('vipCards', JSON.stringify(existingCards));
    
    // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù†Ø§ÙØ°Ø©
    const modal = bootstrap.Modal.getInstance(document.getElementById('addVipCardModal'));
    modal.hide();
    
    // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
    document.getElementById('addVipCardForm').reset();
    
    // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ø±Ø¶
    loadVipCardsPage();
    
    showToast('ØªÙ… Ø¥Ø¶Ø§ÙØ© ÙƒØ§Ø±Øª VIP Ø¨Ù†Ø¬Ø§Ø­', 'success');
  }
  
  // ØªØ­Ù…ÙŠÙ„ ØµÙØ­Ø© ÙƒØ±ÙˆØª VIP
  function loadVipCardsPage() {
    const cards = JSON.parse(localStorage.getItem('vipCards') || '[]');
    renderVipCardsTable(cards);
    updateVipCardsStats();
  }
  
  // Ø¹Ø±Ø¶ Ø¬Ø¯ÙˆÙ„ ÙƒØ±ÙˆØª VIP
  function renderVipCardsTable(cards) {
    const tbody = document.getElementById('vipCardsTableBody');
    tbody.innerHTML = '';
    
    cards.forEach(card => {
      const remainingUses = card.usageLimit - card.usageCount;
      const isExpired = new Date(card.expiryDate) < new Date();
      const isExhausted = remainingUses <= 0;
      
      let status = 'Ù†Ø´Ø·';
      let statusClass = 'text-success';
      
      if (isExpired) {
        status = 'Ù…Ù†ØªÙ‡ÙŠ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ©';
        statusClass = 'text-warning';
      } else if (isExhausted) {
        status = 'Ù…Ø³ØªÙ†ÙØ°';
        statusClass = 'text-danger';
      }
      
      const row = document.createElement('tr');
      row.innerHTML = `
        <td><strong>${card.number}</strong></td>
        <td>${card.owner}</td>
        <td>
          <span class="badge ${card.type.includes('Ø®ØµÙ… ÙÙ†ÙŠ') ? 'bg-primary' : 'bg-success'}">
            ${card.type}
          </span>
        </td>
        <td>${card.usageCount} / ${card.usageLimit}</td>
        <td>
          <span class="badge ${remainingUses > 0 ? 'bg-success' : 'bg-danger'}">
            ${remainingUses}
          </span>
        </td>
        <td>${formatDate(card.expiryDate)}</td>
        <td><span class="${statusClass}">${status}</span></td>
        <td>
          <div class="btn-group btn-group-sm">
            <button class="btn btn-outline-info" onclick="showVipCardDetails(${card.id})" title="ØªÙØ§ØµÙŠÙ„">
              <i class="bi bi-eye"></i>
            </button>
            <button class="btn btn-outline-warning" onclick="showEditVipCardModal(${card.id})" title="ØªØ¹Ø¯ÙŠÙ„">
              <i class="bi bi-pencil"></i>
            </button>
            <button class="btn btn-outline-danger" onclick="deleteVipCard(${card.id})" title="Ø­Ø°Ù">
              <i class="bi bi-trash"></i>
            </button>
          </div>
        </td>
      `;
      tbody.appendChild(row);
    });
  }
  
  // ØªØ­Ø¯ÙŠØ« Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª ÙƒØ±ÙˆØª VIP
  function updateVipCardsStats() {
    const cards = JSON.parse(localStorage.getItem('vipCards') || '[]');
    const now = new Date();
    
    const total = cards.length;
    const active = cards.filter(card => {
      const isExpired = new Date(card.expiryDate) < now;
      const isExhausted = (card.usageLimit - card.usageCount) <= 0;
      return !isExpired && !isExhausted;
    }).length;
    const expired = cards.filter(card => new Date(card.expiryDate) < now).length;
    const exhausted = cards.filter(card => (card.usageLimit - card.usageCount) <= 0).length;
    
    document.getElementById('totalVipCardsCount').textContent = total;
    document.getElementById('activeVipCardsCount').textContent = active;
    document.getElementById('expiredVipCardsCount').textContent = expired;
    document.getElementById('exhaustedVipCardsCount').textContent = exhausted;
  }
  
  // Ø§Ø³ØªØ®Ø¯Ø§Ù… ÙƒØ§Ø±Øª VIP
  function useVipCard() {
    const cardNumber = document.getElementById('useVipCardInput').value.trim();
    const resultDiv = document.getElementById('vipCardUsageResult');
    
    if (cardNumber.length !== 6 || !/^\d{6}$/.test(cardNumber)) {
      resultDiv.className = 'alert alert-danger';
      resultDiv.innerHTML = '<i class="bi bi-exclamation-triangle"></i> Ø±Ù‚Ù… Ø§Ù„ÙƒØ§Ø±Øª ØºÙŠØ± ØµØ­ÙŠØ­';
      resultDiv.style.display = 'block';
      return;
    }
    
    const cards = JSON.parse(localStorage.getItem('vipCards') || '[]');
    const card = cards.find(c => c.number === cardNumber);
    
    if (!card) {
      resultDiv.className = 'alert alert-danger';
      resultDiv.innerHTML = '<i class="bi bi-exclamation-triangle"></i> Ø§Ù„ÙƒØ§Ø±Øª ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯';
      resultDiv.style.display = 'block';
      return;
    }
    
    // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ©
    const isExpired = new Date(card.expiryDate) < new Date();
    if (isExpired) {
      resultDiv.className = 'alert alert-warning';
      resultDiv.innerHTML = '<i class="bi bi-exclamation-triangle"></i> Ø§Ù„ÙƒØ§Ø±Øª Ù…Ù†ØªÙ‡ÙŠ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ©';
      resultDiv.style.display = 'block';
      return;
    }
    
    // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…
    const remainingUses = card.usageLimit - card.usageCount;
    if (remainingUses <= 0) {
      resultDiv.className = 'alert alert-warning';
      resultDiv.innerHTML = '<i class="bi bi-exclamation-triangle"></i> Ø§Ù„ÙƒØ§Ø±Øª Ù…Ø³ØªÙ†ÙØ°';
      resultDiv.style.display = 'block';
      return;
    }
    
    // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„ÙŠÙˆÙ…ÙŠ
    const today = new Date().toDateString();
    const usage = JSON.parse(localStorage.getItem('vipCardUsage') || '[]');
    const todayUsage = usage.filter(u => 
      u.cardNumber === cardNumber && 
      new Date(u.usedAt).toDateString() === today
    );
    
    if (todayUsage.length > 0) {
      resultDiv.className = 'alert alert-warning';
      resultDiv.innerHTML = '<i class="bi bi-exclamation-triangle"></i> ØªÙ… Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù‡Ø°Ø§ Ø§Ù„ÙƒØ§Ø±Øª Ø§Ù„ÙŠÙˆÙ… Ù…Ø³Ø¨Ù‚Ø§Ù‹';
      resultDiv.style.display = 'block';
      return;
    }
    
    // ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…
    const usageRecord = {
      id: Date.now(),
      cardNumber: cardNumber,
      cardId: card.id,
      usedAt: new Date().toISOString(),
      usedBy: localStorage.getItem('currentUser') || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯',
      cardType: card.type
    };
    
    usage.push(usageRecord);
    localStorage.setItem('vipCardUsage', JSON.stringify(usage));
    
    // ØªØ­Ø¯ÙŠØ« Ø¹Ø¯Ø¯ Ù…Ø±Ø§Øª Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…
    card.usageCount++;
    const cardIndex = cards.findIndex(c => c.id === card.id);
    cards[cardIndex] = card;
    localStorage.setItem('vipCards', JSON.stringify(cards));
    
    // Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªÙŠØ¬Ø©
    resultDiv.className = 'alert alert-success';
    resultDiv.innerHTML = `
      <i class="bi bi-check-circle"></i> 
      <strong>ØªÙ… Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„ÙƒØ§Ø±Øª Ø¨Ù†Ø¬Ø§Ø­!</strong><br>
      Ù†ÙˆØ¹ Ø§Ù„ÙƒØ§Ø±Øª: ${card.type}<br>
      ${card.type.includes('Ø®ØµÙ… ÙÙ†ÙŠ') ? `Ù†Ø³Ø¨Ø© Ø§Ù„Ø®ØµÙ…: ${card.type.includes('25%') ? '25%' : '15%'}<br>` : ''}
      Ø§Ù„Ù…Ø±Ø§Øª Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ©: ${card.usageLimit - card.usageCount}<br>
      ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…: ${formatDate(new Date())}
    `;
    resultDiv.style.display = 'block';
    
    // Ù…Ø³Ø­ Ø§Ù„Ø­Ù‚Ù„
    document.getElementById('useVipCardInput').value = '';
    
    // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ø±Ø¶
    loadVipCardsPage();
    
    showToast('ØªÙ… Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„ÙƒØ§Ø±Øª Ø¨Ù†Ø¬Ø§Ø­', 'success');
  }
  
  // Ø¹Ø±Ø¶ ØªÙØ§ØµÙŠÙ„ ÙƒØ§Ø±Øª VIP
  function showVipCardDetails(cardId) {
    const cards = JSON.parse(localStorage.getItem('vipCards') || '[]');
    const card = cards.find(c => c.id === cardId);
    
    if (!card) {
      alert('Ø§Ù„ÙƒØ§Ø±Øª ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯');
      return;
    }
    
    const usage = JSON.parse(localStorage.getItem('vipCardUsage') || '[]');
    const cardUsage = usage.filter(u => u.cardId === cardId);
    
    const remainingUses = card.usageLimit - card.usageCount;
    const isExpired = new Date(card.expiryDate) < new Date();
    
    let status = 'Ù†Ø´Ø·';
    if (isExpired) {
      status = 'Ù…Ù†ØªÙ‡ÙŠ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ©';
    } else if (remainingUses <= 0) {
      status = 'Ù…Ø³ØªÙ†ÙØ°';
    }
    
    const details = `
      <div class="row">
        <div class="col-md-6">
          <h6>Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ÙƒØ§Ø±Øª</h6>
          <p><strong>Ø±Ù‚Ù… Ø§Ù„ÙƒØ§Ø±Øª:</strong> ${card.number}</p>
          <p><strong>Ø§Ù„Ù…Ø§Ù„Ùƒ:</strong> ${card.owner}</p>
          <p><strong>Ø§Ù„Ù†ÙˆØ¹:</strong> ${card.type}${card.type.includes('Ø®ØµÙ… ÙÙ†ÙŠ') ? ` (Ù†Ø³Ø¨Ø© Ø§Ù„Ø®ØµÙ…: ${card.type.includes('25%') ? '25%' : '15%'})` : ''}</p>
          <p><strong>Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…:</strong> ${card.usageCount} / ${card.usageLimit}</p>
          <p><strong>Ø§Ù„Ù…Ø±Ø§Øª Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ©:</strong> ${remainingUses}</p>
          <p><strong>ØªØ§Ø±ÙŠØ® Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ©:</strong> ${formatDate(card.expiryDate)}</p>
          <p><strong>Ø§Ù„Ø­Ø§Ù„Ø©:</strong> ${status}</p>
          <p><strong>Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª:</strong> ${card.notes || 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù„Ø§Ø­Ø¸Ø§Øª'}</p>
        </div>
        <div class="col-md-6">
          <h6>Ø³Ø¬Ù„ Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…</h6>
          ${cardUsage.length > 0 ? 
            `<div class="table-responsive">
              <table class="table table-sm">
                <thead>
                  <tr>
                    <th>Ø§Ù„ØªØ§Ø±ÙŠØ®</th>
                    <th>Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</th>
                  </tr>
                </thead>
                <tbody>
                  ${cardUsage.map(u => `
                    <tr>
                      <td>${formatDate(u.usedAt)}</td>
                      <td>${u.usedBy}</td>
                    </tr>
                  `).join('')}
                </tbody>
              </table>
            </div>` : 
            '<p class="text-muted">Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø³Ø¬Ù„ Ø§Ø³ØªØ®Ø¯Ø§Ù…</p>'
          }
        </div>
      </div>
    `;
    
    // Ø¥Ù†Ø´Ø§Ø¡ modal Ù„Ù„ØªÙØ§ØµÙŠÙ„
    const modal = document.createElement('div');
    modal.className = 'modal fade';
    modal.id = 'vipCardDetailsModal';
    modal.innerHTML = `
      <div class="modal-dialog modal-lg">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">ØªÙØ§ØµÙŠÙ„ ÙƒØ§Ø±Øª VIP</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
          </div>
          <div class="modal-body">
            ${details}
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Ø¥ØºÙ„Ø§Ù‚</button>
          </div>
        </div>
      </div>
    `;
    
    document.body.appendChild(modal);
    const bsModal = new bootstrap.Modal(modal);
    bsModal.show();
    
    modal.addEventListener('hidden.bs.modal', function() {
      document.body.removeChild(modal);
    });
  }
  
  // Ø¹Ø±Ø¶ Ù†Ø§ÙØ°Ø© Ø¥Ø¶Ø§ÙØ© ÙƒØ§Ø±Øª VIP
  function showAddVipCardModal() {
    // ØªØ¹ÙŠÙŠÙ† ØªØ§Ø±ÙŠØ® Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ© Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ (Ø´Ù‡Ø± Ù…Ù† Ø§Ù„ÙŠÙˆÙ…)
    const defaultExpiry = new Date();
    defaultExpiry.setMonth(defaultExpiry.getMonth() + 1);
    document.getElementById('vipCardExpiryInput').value = defaultExpiry.toISOString().split('T')[0];
    
    const modal = new bootstrap.Modal(document.getElementById('addVipCardModal'));
    modal.show();
  }
  
  // Ø¹Ø±Ø¶ Ù†Ø§ÙØ°Ø© ØªØ¹Ø¯ÙŠÙ„ ÙƒØ§Ø±Øª VIP
  function showEditVipCardModal(cardId) {
    const cards = JSON.parse(localStorage.getItem('vipCards') || '[]');
    const card = cards.find(c => c.id === cardId);
    
    if (!card) {
      alert('Ø§Ù„ÙƒØ§Ø±Øª ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯');
      return;
    }
    
    document.getElementById('editVipCardId').value = card.id;
    document.getElementById('editVipCardNumberInput').value = card.number;
    document.getElementById('editVipCardOwnerInput').value = card.owner;
    document.getElementById('editVipCardTypeInput').value = card.type;
    document.getElementById('editVipCardUsageCountInput').value = card.usageCount;
    document.getElementById('editVipCardExpiryInput').value = card.expiryDate;
    document.getElementById('editVipCardNotesInput').value = card.notes || '';
    
    const modal = new bootstrap.Modal(document.getElementById('editVipCardModal'));
    modal.show();
  }
  
  // ØªØ­Ø¯ÙŠØ« ÙƒØ§Ø±Øª VIP
  function updateVipCard(event) {
    event.preventDefault();
    
    const cardId = parseInt(document.getElementById('editVipCardId').value);
    const owner = document.getElementById('editVipCardOwnerInput').value.trim();
    const type = document.getElementById('editVipCardTypeInput').value;
    const usageCount = parseInt(document.getElementById('editVipCardUsageCountInput').value);
    const expiryDate = document.getElementById('editVipCardExpiryInput').value;
    const notes = document.getElementById('editVipCardNotesInput').value.trim();
    
    const cards = JSON.parse(localStorage.getItem('vipCards') || '[]');
    const cardIndex = cards.findIndex(c => c.id === cardId);
    
    if (cardIndex === -1) {
      alert('Ø§Ù„ÙƒØ§Ø±Øª ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯');
      return;
    }
    
    // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø¹Ø¯Ø¯ Ù…Ø±Ø§Øª Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…
    if (usageCount > cards[cardIndex].usageLimit) {
      alert('Ø¹Ø¯Ø¯ Ù…Ø±Ø§Øª Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø£Ù† ÙŠØªØ¬Ø§ÙˆØ² Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰');
      return;
    }
    
    // ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙƒØ§Ø±Øª
    cards[cardIndex] = {
      ...cards[cardIndex],
      owner: owner,
      type: type,
      usageCount: usageCount,
      expiryDate: expiryDate,
      notes: notes,
      lastModifiedBy: localStorage.getItem('currentUser') || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯',
      lastModifiedAt: new Date().toISOString()
    };
    
    localStorage.setItem('vipCards', JSON.stringify(cards));
    
    // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù†Ø§ÙØ°Ø©
    const modal = bootstrap.Modal.getInstance(document.getElementById('editVipCardModal'));
    modal.hide();
    
    // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ø±Ø¶
    loadVipCardsPage();
    
    showToast('ØªÙ… ØªØ­Ø¯ÙŠØ« ÙƒØ§Ø±Øª VIP Ø¨Ù†Ø¬Ø§Ø­', 'success');
  }
  
  // Ø­Ø°Ù ÙƒØ§Ø±Øª VIP
  function deleteVipCard(cardId) {
    if (!confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„ÙƒØ§Ø±ØªØŸ')) {
      return;
    }
    
    const cards = JSON.parse(localStorage.getItem('vipCards') || '[]');
    const filteredCards = cards.filter(c => c.id !== cardId);
    
    localStorage.setItem('vipCards', JSON.stringify(filteredCards));
    
    // Ø­Ø°Ù Ø³Ø¬Ù„ Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù…Ø±ØªØ¨Ø·
    const usage = JSON.parse(localStorage.getItem('vipCardUsage') || '[]');
    const filteredUsage = usage.filter(u => u.cardId !== cardId);
    localStorage.setItem('vipCardUsage', JSON.stringify(filteredUsage));
    
    loadVipCardsPage();
    
    showToast('ØªÙ… Ø­Ø°Ù ÙƒØ§Ø±Øª VIP Ø¨Ù†Ø¬Ø§Ø­', 'success');
  }
  
  // ØªØµÙÙŠØ© ÙƒØ±ÙˆØª VIP
  function filterVipCards() {
    const searchTerm = document.getElementById('vipCardSearchInput').value.toLowerCase();
    const typeFilter = document.getElementById('vipCardTypeFilter').value;
    const statusFilter = document.getElementById('vipCardStatusFilter').value;
    
    const cards = JSON.parse(localStorage.getItem('vipCards') || '[]');
    const now = new Date();
    
    const filtered = cards.filter(card => {
      const matchesSearch = card.number.includes(searchTerm) || 
                           card.owner.toLowerCase().includes(searchTerm);
      
      const matchesType = !typeFilter || card.type === typeFilter;
      
      const remainingUses = card.usageLimit - card.usageCount;
      const isExpired = new Date(card.expiryDate) < now;
      const isExhausted = remainingUses <= 0;
      
      let status = 'Ù†Ø´Ø·';
      if (isExpired) status = 'Ù…Ù†ØªÙ‡ÙŠ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ©';
      else if (isExhausted) status = 'Ù…Ø³ØªÙ†ÙØ°';
      
      const matchesStatus = !statusFilter || status === statusFilter;
      
      return matchesSearch && matchesType && matchesStatus;
    });
    
    renderVipCardsTable(filtered);
  }
  
  // ØªØµØ¯ÙŠØ± ÙƒØ±ÙˆØª VIP Ø¥Ù„Ù‰ Excel
  function exportVipCardsExcel() {
    const cards = JSON.parse(localStorage.getItem('vipCards') || '[]');
    const usage = JSON.parse(localStorage.getItem('vipCardUsage') || '[]');
    
    if (cards.length === 0) {
      alert('Ù„Ø§ ØªÙˆØ¬Ø¯ ÙƒØ±ÙˆØª VIP Ù„Ù„ØªØµØ¯ÙŠØ±');
      return;
    }
    
    const wsData = [
      ['Ø±Ù‚Ù… Ø§Ù„ÙƒØ§Ø±Øª', 'Ø§Ù„Ù…Ø§Ù„Ùƒ', 'Ø§Ù„Ù†ÙˆØ¹', 'Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…', 'Ø§Ù„Ù…Ø±Ø§Øª Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ©', 'ØªØ§Ø±ÙŠØ® Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ©', 'Ø§Ù„Ø­Ø§Ù„Ø©', 'Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª', 'ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡']
    ];
    
    cards.forEach(card => {
      const remainingUses = card.usageLimit - card.usageCount;
      const isExpired = new Date(card.expiryDate) < new Date();
      const isExhausted = remainingUses <= 0;
      
      let status = 'Ù†Ø´Ø·';
      if (isExpired) status = 'Ù…Ù†ØªÙ‡ÙŠ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ©';
      else if (isExhausted) status = 'Ù…Ø³ØªÙ†ÙØ°';
      
      wsData.push([
        card.number,
        card.owner,
        card.type,
        `${card.usageCount} / ${card.usageLimit}`,
        remainingUses,
        formatDate(card.expiryDate),
        status,
        card.notes || '',
        formatDate(card.createdAt)
      ]);
    });
    
    const wb = XLSX.utils.book_new();
    const ws = XLSX.utils.aoa_to_sheet(wsData);
    XLSX.utils.book_append_sheet(wb, ws, 'ÙƒØ±ÙˆØª VIP');
    
    const filename = `ÙƒØ±ÙˆØª_VIP_${new Date().toISOString().replace(/[:.]/g, '-')}.xlsx`;
    XLSX.writeFile(wb, filename);
    
    showToast('ØªÙ… ØªØµØ¯ÙŠØ± ÙƒØ±ÙˆØª VIP Ø¨Ù†Ø¬Ø§Ø­', 'success');
  }
  
  // ØªØ­Ø¯ÙŠØ« Ø¯Ø§Ù„Ø© showPage Ù„ØªØ´Ù…Ù„ ØµÙØ­Ø© ÙƒØ±ÙˆØª VIP
  function showPage(page) {
    // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„ÙƒÙ„Ø§Ø³ active Ù…Ù† Ø¬Ù…ÙŠØ¹ Ø±ÙˆØ§Ø¨Ø· Ø§Ù„ØªÙ†Ù‚Ù„
    document.querySelectorAll('.sidebar .nav-link').forEach(link => {
      link.classList.remove('active');
    });
    
    // Ø¥Ø¶Ø§ÙØ© Ø§Ù„ÙƒÙ„Ø§Ø³ active Ù„Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ù…Ø­Ø¯Ø¯
    document.getElementById(page + 'Nav').classList.add('active');
    
    // Ø¥Ø®ÙØ§Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„ØµÙØ­Ø§Øª
    document.querySelectorAll('.page-content').forEach(pageContent => {
      pageContent.classList.remove('active');
    });
    
    // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ù…Ø­Ø¯Ø¯Ø©
    document.getElementById(page + 'Page').classList.add('active');
    
    // ØªØ­Ø¯ÙŠØ« Ø¹Ù†ÙˆØ§Ù† Ø§Ù„ØµÙØ­Ø©
    let pageTitle = '';
    switch(page) {
      case 'dashboard': pageTitle = 'Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…'; break;
      case 'orders': pageTitle = 'Ø§Ù„Ø·Ù„Ø¨Ø§Øª'; break;
      case 'allOrders': pageTitle = 'ÙƒÙ„ Ø§Ù„Ø·Ù„Ø¨Ø§Øª'; loadAllOrdersPage(); break;
      case 'technicians': pageTitle = 'Ø§Ù„ÙÙ†ÙŠÙŠÙ†'; break;
      case 'deliverymen': pageTitle = 'Ø§Ù„Ù…Ù†Ø§Ø¯ÙŠØ¨'; break;
      case 'customers': pageTitle = 'Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡'; break;
      case 'complaints': pageTitle = 'Ø§Ù„Ø´ÙƒØ§ÙˆÙ‰'; break;
      case 'vipCards': pageTitle = 'ÙƒØ±ÙˆØª VIP'; loadVipCardsPage(); break;
      case 'backup': pageTitle = 'Ø§Ù„Ù†Ø³Ø® Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠ'; loadBackupPageData(); break;
    }
    
    document.getElementById('pageTitle').textContent = pageTitle;
    
    // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ø³Ø§ÙŠØ¯Ø¨Ø§Ø± ÙÙŠ Ø§Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„ØµØºÙŠØ±Ø©
    if (window.innerWidth < 768) {
      document.getElementById('sidebar').classList.remove('show');
    }
  }
  </script>
  <!-- ... existing code ...
</body>
</html>
